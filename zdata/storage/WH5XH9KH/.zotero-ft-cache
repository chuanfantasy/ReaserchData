硕士学位论文

基于数字孪生的车间作业仿真与监控系统的设计与实现

作者姓名: 指导教师: 学位类别: 学科专业: 培养单位:

宗学妍 王鸿亮 研究员 中国科学院沈阳计算技术研究所
工学硕士 计算机应用技术 中国科学院沈阳计算技术研究所

2021 年 6 月

Design and Implementation of Workshop Job Simulation and Monitoring Based on Digital Twin
A thesis submitted to University of Chinese Academy of Sciences
in partial fulfillment of the requirement for the degree of
Master of Science in Engineering in computer technology By Zong Xueyan
Supervisor: Researcher Wang Hongliang
Shenyang Institute of Computing Technology Chinese Academy of Sciences June 2021

中国科学院大学 研究生学位论文原创性声明
本人郑重声明：所呈交的学位论文是本人在导师的指导下独立进行研究工作 所取得的成果。尽我所知，除文中已经注明引用的内容外，本论文不包含任何其 他个人或集体已经发表或撰写过的研究成果。对论文所涉及的研究工作做出贡献 的其他个人和集体，均已在文中以明确方式标明或致谢。

作者签名： 日 期： 2021.3.30
中国科学院大学 学位论文授权使用声明
本人完全了解并同意遵守中国科学院有关保存和使用学位论文的规定，即中 国科学院有权保留送交学位论文的副本，允许该论文被查阅，可以按照学术研究 公开原则和保护知识产权的原则公布该论文的全部或部分内容，可以采用影印、 缩印或其他复制手段保存、汇编本学位论文。
涉密及延迟公开的学位论文在解密或延迟期后适用本声明。

作者签名： 日 期：2021.3.30

导师签名： 日 期：2021.3.30

摘 要
摘 要
当今社会制造业的发展方向是朝着全球化、智能化和虚拟化的趋势。数 字孪生技术作为物理信息世界融合的有效手段，在实现制造业虚拟化方面有 着举足轻重的作用。通过数字孪生技术在虚拟世界中对企业生产流程进行模 拟、仿真和优化，有助于降低设计开发过程中的试错成本，提高效率。在本 文中，将数字孪生技术应用到车间作业仿真和监控上面，为车间生产提供数 据分析和评测功能，在一定程度上实现了对车间生产状态和参数的全视角监 控，为未来的车间生产管理模式提供了一些新的思考。本文的研究工作主要 体现在以下几个方面：
（1）基于数字孪生的车间作业与仿真系统的整体设计：分析当前车间 在生产计划、生产状态监控、设备预警等方面存在的问题，提出系统设计目 标是实现车间全视角的监控、对车间可能存在的故障提前预警、对生产数据 进行分析和管理。其次，提出系统的设计原则、整体框架，为实现基于数字 孪生的车间作业仿真和监控系统的开发提供参考规范和技术支撑。最后，根 据数字孪生模型结构，划分系统模块，将系统划分成数据采集模块、虚拟系 统模块以及系统服务模块。
（2）基于数字孪生的车间作业与仿真系统的整体实现：对于数据采集 模块，分析车间数据来源并划分数据类型，采用基于 OPC UA 协议的方式实 现对车间动态数据的实时传输。在虚拟系统模块，通过 3dMax、Unity3D 等 软件共同完成对车间系统的建模工作。在虚拟场景的搭建过程中，对三维场 景中数控设备中的切削刀具的碰撞检测采用基于隐函数的碰撞检测法。并且 在建模工作最后，在不影响系统功能的前提下，通过减少模型的面片数和顶 点数的方式对模型进行轻量化处理。在系统服务模块，通过 C#脚本驱动虚 拟模型的运动来实现对车间生产作业的仿真，并以车间中机械臂的运动为例 进行介绍。使用 Unity3D 的 GUI 可视化组件完成系统 UI 的界面搭建，实现 对车间数据的可视化分析和管理的功能。通过采集设备上温度传感器的数据
I

基于数字孪生的车间作业仿真与监控系统的设计与实现
对温度异常的情况进行预警。 （3）基于数字孪生的车间作业与仿真系统的测试：介绍了本文系统的
测试环境以及测试设备的类型以及型号。在系统测试前进行参数的配置，对 车间作业仿真和监控系统进行性能方面的测试和功能完整性的测试。性能测 试结果显示系统对硬件资源的依赖性达到设计要求，界面显示体验达到预期 目标。功能测试展示了系统功能的完整性。本文设计的系统可用于功能演示 等场景中。 关键词：数字孪生，系统服务，生产作业仿真，系统监控
II

Abstract
Abstract
The development direction of the manufacturing industry in today's society is toward the trend of globalization, intelligence and virtualization. As an effective means of fusion of the physical world and the information world, digital twin technology plays a pivotal role in realizing the virtualization of the manufacturing industry. Simulating and optimizing the production process of an enterprise in the virtual world through digital twin technology helps to reduce trial and error costs in the design and development process and improve development efficiency. In this article, the digital twin technology is applied to workshop operation simulation and monitoring. It provides data analysis and evaluation capabilities for workshop production and to a certain extent solves the full-view monitoring of workshop production status and parameters. This application provides some new ideas for the future workshop production management mode. The research work of this article is mainly reflected in the following aspects:
(1) The overall design of workshop operations and simulation system based on digital twins: Analyze the current workshop problems in production planning, production status monitoring, equipment early warning, etc., and put forward that the system design goal is to achieve full-view monitoring of the workshop, early warning of possible failures in the workshop, and analysis and management of production data. Secondly, the design principles and overall framework of the system are proposed, which provide requirements and technical support for realizing the workshop operation simulation and monitoring system based on digital twins. Finally, according to the structure of the digital twin model, the system modules are divided. The system is divided into data acquisition module, virtual system module and system service module.
(2) The overall realization of the workshop operation and simulation system based on digital twins: For the data acquisition module, analyze the data source of
III

基于数字孪生的车间作业仿真与监控系统的设计与实现
the workshop and divide the data types, and realize the real-time transmission of the dynamic data of the workshop based on the OPC UA protocol. In the virtual system module, the modeling work of the workshop entity is jointly completed through 3dMax, Unity3D and other software. In the construction of the virtual scene, the collision detection method based on implicit function is adopted for the collision detection of the cutting tools in the CNC machine tool equipment in the three-dimensional scene. And at the end of the modeling work, under the premise of not affecting the system function, the model is lightweighted by reducing the number of meshes and vertices of the model. In the system service module, the movement of the virtual model is driven by the C# script to realize the simulation of the workshop production operation, and the movement of the robot arm in the workshop is introduced as an example. Use Unity3D's GUI visual component to complete the system UI interface construction, and realize the function of visual analysis and management of workshop data. Early warning of abnormal temperature by collecting data from the temperature sensor on the device.
(3) The test of the workshop operation and simulation system based on digital twins: Introduced the test environment of the system and the type and model of test equipment. Perform parameter configuration before system testing, and then perform performance testing and functional integrity testing on the shop floor simulation and monitoring system. The performance test results show that the system's dependence on hardware resources meets the design requirements, the functional tests show the completeness of the system functions, and the interface display experience reaches the expected goal. The system designed in this paper can be used in scenarios such as function demonstrations.
Keywords: Digital twin, System service, Production simulation, System monitoring
IV

目 录
目 录
第 1 章 绪论 ..............................................................................................1
1.1 研究背景与意义...............................................................................................1 1.2 国内外研究现状...............................................................................................3
1.2.1 数字孪生技术的发展现状........................................................................3 1.2.2 车间作业仿真与监控的研究现状............................................................4 1.3 本文研究内容...................................................................................................5 1.4 论文组织结构...................................................................................................6
第 2 章 相关技术的研究 ..........................................................................9
2.1 数字孪生技术的理论研究...............................................................................9 2.1.1 数字孪生技术的基本概念........................................................................9 2.1.2 数字孪生技术的基础构成........................................................................9 2.1.3 数字孪生技术的应用场景...................................................................... 11
2.2 OPC UA 技术 .................................................................................................12 2.2.1 OPC UA 技术的优势 ..............................................................................12 2.2.2 OPC UA 与 OPC DA 的区别 .................................................................14
2.3 本章小结.........................................................................................................14
第 3 章 基于数字孪生的车间作业仿真与监控系统的设计 ................17
3.1 基于数字孪生的车间作业仿真与监控系统的设计目标.............................17 3.1.1 当前存在的问题......................................................................................17 3.1.2 系统设计原则..........................................................................................18 3.1.3 系统需求分析..........................................................................................19
3.2 基于数字孪生的车间作业仿真与监控系统的系统架构.............................20 3.2.1 系统的整体流程设计..............................................................................20 3.2.2 基于数字孪生的系统框架......................................................................21
3.3 基于数字孪生的车间作业仿真与监控系统的系统模块设计.....................23 3.3.1 数据采集模块..........................................................................................23
V

基于数字孪生的车间作业仿真与监控系统的设计与实现
3.3.2 虚拟系统模块..........................................................................................24 3.3.3 系统服务模块..........................................................................................26 3.4 本章小结.........................................................................................................28
第 4 章 基于数字孪生的车间作业仿真与监控系统的实现 ................29
4.1 实现流程.........................................................................................................29 4.2 虚拟模型的搭建.............................................................................................30
4.2.1 模型的搭建流程......................................................................................30 4.2.2 碰撞检测..................................................................................................33 4.3 数据的采集和传输.........................................................................................35 4.3.1 OPC UA 数据架构 .................................................................................35 4.3.2 OPC UA 数据采集 ..................................................................................36 4.3.3 OPC UA 数据传输 ..................................................................................40 4.4 系统服务的实现.............................................................................................42 4.4.1 车间作业仿真..........................................................................................42 4.4.2 机械臂的运动仿真..................................................................................43 4.5 本章小结.........................................................................................................44
第 5 章 实验与测试 ................................................................................45
5.1 实验环境的搭建.............................................................................................45 5.1.1 实验环境要求..........................................................................................45 5.1.2 实验设备要求..........................................................................................45
5.2 系统功能测试.................................................................................................45 5.3 生产过程仿真测试.........................................................................................49 5.4 系统性能测试.................................................................................................51 5.5 本章小结.........................................................................................................52
第 6 章 总结与展望 ................................................................................53
6.1 工作总结.........................................................................................................53 6.2 展望.................................................................................................................53
参考文献 ..................................................................................................55
VI

目 录
作者简历及攻读学位期间发表的学术论文与研究成果 ......................61
图目录
图 2.1 数字孪生五维结构........................................................................................10 图 3.1 系统功能性需求............................................................................................20 图 3.2 系统整体流程................................................................................................21 图 3.3 系统设计流程................................................................................................21 图 3.4 基于数字孪生的系统整体框架....................................................................22 图 3.5 系统数据来源................................................................................................24 图 3.6 建模层次........................................................................................................26 图 3.7 系统服务功能模块........................................................................................27 图 4.1 系统开发流程................................................................................................29 图 4.2 虚拟建模流程................................................................................................30 图 4.3 定向光源........................................................................................................31 图 4.4 点光源............................................................................................................31 图 4.5 聚光灯............................................................................................................32 图 4.6 漫反射效果图................................................................................................32 图 4.7 Transform 属性..............................................................................................33 图 4.8 基于隐函数的碰撞检测算法........................................................................34 图 4.9 OPC UA 客服端/服务端模式 .......................................................................35 图 4.10 OPC UA 体系架构 ......................................................................................36 图 4.11 OPC UA 客户端的订阅过程 ......................................................................36 图 4.12 查找服务器..................................................................................................37 图 4.13 OPC UA 客户端/服务端建立连接 .............................................................37 图 4.14 基本节点的类别和通用属性......................................................................38 图 4.15 某数控设备在 OPC UA 地址空间中的数据 .............................................39 图 4.16 创建监控项..................................................................................................40
VII

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 4.17 Socket 通信原理..........................................................................................41 图 4.18 数控系统某时刻采集的数据......................................................................41 图 4.19 数控系统数据字段名称..............................................................................42 图 4.20 车间作业仿真系统......................................................................................42 图 4.21 六自由度机械臂结构图..............................................................................44 图 4.22 虚拟场景中运动的机械臂..........................................................................44 图 5.1 系统主页面....................................................................................................46 图 5.2 设备管理功能页面........................................................................................47 图 5.3 虚拟场景中的数控车床................................................................................47 图 5.4 视图功能页面................................................................................................48 图 5.5 拓扑展示界面................................................................................................48 图 5.6 环境感知界面................................................................................................49 图 5.7 温度传感器....................................................................................................49 图 5.8 数控系统的切削仿真....................................................................................49 图 5.9 生产数据........................................................................................................50 图 5.10 性能测试......................................................................................................51
表目录
表 4.1 发布订阅服务相关函数................................................................................39 表 4.2 机械臂的部分参数........................................................................................43 表 5.1 系统运行前的参数配置................................................................................46 表 5.2 各个工序的加工时长（minutes） ...............................................................50 表 5.3 设备加工率和空闲率....................................................................................51
VIII

第 1 章 绪论
第1章 绪论
1.1 研究背景与意义 随着人工智能、大数据、物联网（IoT）、云计算和数字孪生等新一代信息技
术（new IT）的蓬勃发展，世界上主要的制造业强国纷纷提出了一系列有关国家 层面的先进制造业发展战略，如美国的工业互联网（工业互联网，2015）（Industrial Internet）和基于 CPS（Cyper-Phsysical System）制造、德国工业 4.0（河东，2015）， 英国工业 2050 战略（张蓓，2016）、俄罗斯的“2035 年前制造业发展战略”、中国 的中国制造 2025（郭朝先，2015）和互联网+制造（应怀樵，2016）等。发展智 能制造已经成为世界各国争先抢占世界级先进制造大国的重大发展战略。而数字 孪生技术作为工业智能化未来发展的有力抓手，对智能制造领域具有里程碑式的 重大意义。高德纳（Gartner）作为世界上最具权威的 IT 调研与咨询公司，曾在 2017 年至 2019 年将数字孪生技术列为当年全世界十大战略科技发展趋势之一 （PANETTA K，2019；PANETTA K，2018；PANETTA K，2017）；2018 年洛克 希德·马丁公司也将数字孪生列为未来国防工业和航天工业的 6 大顶尖科学技术 之一；中国科学技术协会智能制造学术联合体在世界智能制造大会上将数字孪生 列为世界智能制造十大科技重大进展之一（中国科学技术协会，2017）。在 2020 年，美、德分别成立了数字孪生联盟（Digital Twin Consortium，DTC）和工业数 字孪生协会（Industrial Digital Twin Association，IDTA）。Global Market Insights 预 测数字孪生技术的整体市场规模在 2020—2026 年将保有高达 30%多的稳定且持 续增长，预计整体市场规模会将从目前的 40 多亿美元增长到 350 多亿美元。数 字孪生技术不仅仅在国外被如此重视，与此同时在国内，中华人民共和国国家发 展和改革委员会国家互联网信息办公室在 2020 年 4 月印发《关于推进“上云用数 赋智”行动培育新经济发展实施方案》（中华人民共和国国家发展和改革委员会， 2020）提出要深入实施数字经济战略，构建设备数字化-生产线数字化-车间数字 化-工厂数字化-企业数字化-产业链数字化-数字化生态的典型范式。综上所述， 足以可见数字孪生技术在当前世界高新技术发展浪潮中占有不可忽视的地位。这
1

基于数字孪生的车间作业仿真与监控系统的设计与实现
项技术作为实现物理信息融合的有效手段，它实现了现实物理世界向赛博空间 （Cyberspace）的数字化反馈。
车间是生产制造的主要场所，车间作业是车间工作人员根据制定的生产计划 以及产品工艺制作流程等组织的日常生产活动，工业生产制造车间中的主要操作 对象是车间中的工业设备比如车床、铣床、数控机床等及各类移动便携工具、传 输设备、仓储设备、起重设备和车间设备等。在车间生产过程中当数控机床设备 及工业机器人出现问题时，会对生产过程产生巨大影响。同时，车间中还存在数 据的流动性比较慢、信息交互不及时、可视化程度低的问题，这也会导致车间管 理人员对车间的底层设备执行状态的监督管控力度不够。因此在车间作业中对于 车间工作人员来说，实时掌握车间现场的数控机床和工业设备的作业情况尤为重 要。这可以使车间操作管理人员及时发现生产中存在的异常情况进而调整和优化 生产计划以及对车间资源进行重新分配，帮助人们提高生产的效率和产品质量的 稳定性。随着物联网技术的发展，各种硬件设备也在相应的升级中。相关数字化 系统在硬件设备上的应用，为人们收集车间生产相关的实时数据提供了便利条件。 在车间数据的采集与集成、信息系统的构建、虚拟模型的搭建及系统仿真等方面 已经与之前有了巨大的变化。在此基础上，实现车间数字化和智能化、搭建车间 信息与物理世界的互联互通是车间未来势不可挡的方向，也是实现车间智能化生 产与管控的必由之路。如何管理和应用车间在生产制造中产生的实时数据，并通 过管理分析利用这些数据实现生产车间直接、清晰、及时的可视化监控是当前情 况下必须要解决的问题。
数字孪生技术的发展为上面问题的解决带来契机，数字孪生技术可以帮助人 们实现物理信息世界的交融。通过将物理空间中的实体映射到虚拟的环境，实现 对物理世界的仿真和模拟。数字孪生技术刻画的虚拟模型可以展现物理实体全生 命周期范围的变化，进可能保证保证数字世界与物理世界的一致或同步。
本文借助数字孪生的理念，通过设计车间实体的虚拟模型、采集数控设备以 及传感器中的数据，从而对车间作业情况进行仿真并实现车间作业情况的监控， 使得生产过程更加直观化、数字化，通过一个全局的角度进行协助生产，有助于 提高车间的生产效率，有助于系统的监控管理，有助于提高企业的生产效率。
2

第 1 章 绪论
1.2 国内外研究现状 1.2.1 数字孪生技术的发展现状
数字孪生理论的雏形最初是在 2002 年由 Grieves（2005）教授在美国密歇根 大学（The University of Michigan，UM），为建立一个产品生命周期管理（PLM） 中心的一次演讲中提出的“PLM 的概念理想”。模型中出现了现实空间和虚拟空 间的概念、数据从现实空间流向虚拟空间的链接、信息从虚拟空间到现实空间的 流动以及虚拟子空间的表述。这些表述具备了数字孪生技术的所有构成要点。这 个概念模型于 2003 年初在密歇根大学的第一批 PLM 课程中被使用，在那里它 被称为镜像空间模型（Glaessgen E 和 Stargel D，2012）。在 PLM 的开创性著述 《产品生命周期管理:推动下一代精益思维》（Product Lifecycle Management: Driving the Next Generation of Lean Thinking）中，概念模型称为信息镜像模型 （Information Mirroring Model）。
在早期，数字孪生技术主要被应用在航空航天以及军事工程领域，被用作飞 机的故障预测。美国国家航空航天局（NASA）将物理系统与其同等效果的虚拟 系统结合起来，研究了基于数字孪生的复杂系统故障预测与消除方法（张新生， 2018）。故障预测和安全方面的运行维护对船舶和飞机等大型设备和基础设施至 关重要，通过高保真、及时更新的虚拟模型进行产品的全生命周期管理（TAO F 等，2018）。基于数字孪生理念，西门子公司构建了可以将整个生产制造流程聚 合在一起的生产系统模型并在其公司的 Nanobox PC 工业设备的生产流程上验证 了应用的可实施性（陶飞 等，2018）。人们还探索了数字孪生在物质文化遗产数 字化建设方面的应用（秦晓珠和张兴旺，2018），研究了数字孪生技术和物质文 化遗产数字化融合的共性，基于两者的共性提出相应的解决方案。在电路故障检 测方面，夏玲等人提出一种基于数字孪生的 Buck 电路故障诊断方法。通过迭代 与孪生模型相关的目标函数获得参数估值，实现 Buck 电路的故障诊断（2021）。 在网络通信方面，将数字孪生技术与 B5G、6G 通信信道模拟的关键的场景、对 象和环节紧密结合在一起，初次提出数字孪生信道的技术内涵（王健，2021）。 在智慧城市建设方面，西班牙智慧城市的先驱桑坦德在城市中广泛安装传感器等 采集设备，感知城市环境、交通和水利等运行状态，并将采集到的数据收集到智
3

基于数字孪生的车间作业仿真与监控系统的设计与实现
慧城市平台中，初步形成了数字孪生城市的模型（张冰 等，2019）。雄安新区也 提出了“数字孪生城市”的理念，提出要“坚持数字城市与现实城市同步规划和建 设”的规划（周瑜和刘春成，2018）。针对物理世界与信息世界的互相交融，北航 的陶飞等提出了数字孪生车间（陶飞 等，2017）的概念。因为传统的数字孪生 三维模型已经无法实现更多场景的需要，他在数字孪生车间的基础上提出了数字 孪生五维模型（2019，a）。为了数字孪生技术更好的落地，陶飞等还提出了数字 孪生标准体系（2019，b）。在复杂产品的设计与制造方面，李浩等提出了基于数 字孪生的复杂产品设计制造一体化开发框架（2019）。在孪生数据映射方面，王 峻峰等人在前人框架和方法的基础上提出了面向生产性能数字孪生仿真的数据 映射方法（王峻峰，2021）。该方法从多个方面分析了仿真数据与生产逻辑模型 的融合过程，除去物理场景中数据冗余部分，根据数据的实时更新过程，驱动数 字孪生的仿真运行、生产性能分析和优化。此方法可以实现离散生产系统的快速 建模，对系统的生产性能具有一定的可靠性。
1.2.2 车间作业仿真与监控的研究现状 在国外，首尔大学与三星重工船厂共同开发了一个基于 DELMIA QUEST 的
数字化造船仿真系统（Young 等，2009），建立中型船厂的虚拟三维模型，通过仿 真系统对整个生产过程进行仿真实验。德国弗莱斯堡-希夫堡-赛尔沙夫特造船厂 基于 Em-Plant 软件开发了面向对象的造船专用模型构件库，针对钢材堆场、分 段运输、分装装焊等制造场景设计了仿真模板。清华大学的张林鍹提出了一种基 于 HoloLens 的智能装配生产线仿真方法（2019），通过对装配线的排产调度过程 进行数学建模，将多目标作业车间调度的问题转换问题角度。将其转换成一个混 合整数规划模型问题，通过改进的遗传算法对转换后的问题进行计算，得到调整 生产的方案。最后通过 HoloLens 头显显示设备状态给用户，方便用户观察。该 方法降低了生产装配的成本，缩短了产品装配周期，增强了用户的交互体验。郑 成军等提出了车间作业计划执行过程动态与静态并行的软件模块表示方法 （2012）。通过研究调度系统的数据模型以及如何在仿真软件中实现车间作业计 划可视化，最终决定使用直接、清晰的甘特图表示整个执行过程。车间人员通过 甘特图的形式了解实时的车间工作计划和状态，掌握车间生产的整体运行步骤。
4

第 1 章 绪论
邓啸尘等人提出基于 Plant Simulation 的船厂平直车间作业仿真与优化方法 （2020），通过使用 Plant Simulation 对生产制造流程进行模拟仿真。
综上所述，国内外的研究人员在在车间作业仿真和监控领域做出了许多的研 究和贡献，提出了不同的方法用于解决不同领域的仿真优化问题，且都具有一定 的借鉴意义和价值。数字孪生作为可以实现生产过程全周期分析的方法，可以实 现整个生产过程更直观的监控和实时的仿真，在仿真和监控方面具有不可替代的 作用。如何使用车间传感器以及数控设备采集的孪生数据驱动虚拟模型完成车间 作业的仿真和监控成为本文的研究重点。
1.3 本文研究内容 本文在研究课题背景与意义后，结合国内外研究成果，对基于数字孪生技术
在车间作业仿真和监控方面的应用进行了思考。根据数字孪生五维模型（陶飞 等， 2019）的结构基础对系统整体进行设计与实现，本文的研究内容主要体现在以下 几个方面：
（1）基于数字孪生的车间作业仿真与监控系统的相关技术的研究 本文依次从数字孪生的基本概念、基础构成以及应用场景三个方面介绍了数 字孪生技术的相关理论。从 OPC UA 技术的优势以及 OPC UA 与 OPC DA 的区 别方面介绍了 OPC UA 技术。通过对相关技术的理论部分进行分析，为本文系统 的设计与实现提供理论支撑。 （2）基于数字孪生的车间作业仿真与监控系统的设计 首先论述了目前车间在工作和监控中依旧存在的问题，列举了当前车间发展 存在的不足。其次，为了保证系统功能的实现以及保证系统具有扩展性、健壮性 和低耦合，基于此提出了本文系统的设计原则，在设计原则下确定了系统的设计 目标。并且基于数字孪生技术构建了系统的整体架构和系统的整体开发流程。对 车间作业仿真与监控系统的系统模块进行研究和划分。基于数字孪生的车间作业 仿真与监控系统的实现关键是数据模块的处理、虚拟系统的搭建以及系统服务。 对应数字孪生五维模型中的孪生数据、虚拟模型、系统服务和连接部分。 （3）基于数字孪生的车间作业仿真与监控系统的实现
5

基于数字孪生的车间作业仿真与监控系统的设计与实现
本文搭建并优化了车间的虚拟模型，对车间运行、车间工艺、设备布局等方 面进行仿真。在虚拟模型中对生产车间中会存在碰撞的物体进行碰撞检测，防止 虚拟环境中模型穿透问题的发生。其次，通过 OPC UA 协议采集车间设备和传感 器中产生的实时数据，将采集的数据通过 C#脚本驱动虚拟系统的运动。最后， 对采集的数据进行分析和管理，完成系统服务模块功能的开发。本文将车间作业 产生的实时状态和数据反映在虚拟的三维场景中，构建车间作业的远程监控，同 时再配合车间的生产的实时数据，实现了车间管理人员对车间作业情况的全视角 的立体监控。
1.4 论文组织结构 本文一共分为六个章节，各个章节的内容安排如下： 第 1 章主要介绍了基于数字孪生的车间作业仿真与监控的研究背景及其意
义，其次概括了数字孪生技术以及车间仿真与监控的国内外研究发展现状，最后 引出了论文的研究内容以及论文的组织结构。
第 2 章主要从理论层面对数字孪生技术进行学习，分别从基本概念、基础 构成、应用场景三个方面对数字孪生技术进行了解，并介绍了数字孪生五维模型 的各要素的含义。本章最后还介绍了智能制造方面一般数据采集常用的并具有重 要意义的 OPC UA 架构，分别论述了 OPC UA 的技术优势和 OPC DA 的区别。 最后，引出本章小结，总结本章内容。
第 3 章提出基于数字孪生的车间作业仿真与监控系统的设计方案。根据当 前车间存在的问题，确定系统的设计目标。构思系统的整体实现流程并提出了基 于数字孪生的车间作业仿真与监控系统的系统架构。其次，将本文系统划分为数 据采集模块、虚拟系统设计模块、系统服务模块三大模块。研究基于数字孪生技 术的各模块间的合作机制，为模型的动态展示做好准备。最后，引出本章小结， 总结本章内容。
第 4 章主要基于数字孪生的车间作业仿真与监控系统实现方面叙述系统的 具体实现步骤及关键方法。本章具体从虚拟建模、数据采集、数据的传输、系统 服务等角度对系统进行实现。说明了本文系统虚拟模型的建模流程以及在虚拟场
6

第 1 章 绪论
景中如何判断物体是否发生碰撞，数据采集过程的实现，以及系统服务中对机械 臂运动的仿真实现。最后，引出本章小结，总结本章内容。
第 5 章实验与测试部分阐述了实验环境的搭建，对车间仿真与监控进行了 实验验证。测试系统是否可以通过孪生数据驱动模型的运行，测试系统能否完成 仿真与监控的功能。然后，对车间系统功能进行展示以及对系统性能进行测试， 验证本文数字孪生模型中的系统服务功能的可靠性。最后，引出本章小结，总结 本章内容。
第 6 章总结与展望主要对整篇文章开展的工作进行总结并反思系统设计实 现过程中的不足之处，并对今后工作中需要加以完善和改进的部分加以说明，并 对未来系统建设做出展望。
7

基于数字孪生的车间作业仿真与监控系统的设计与实现 8

第 2 章 相关技术的研究
第2章 相关技术的研究
2.1 数字孪生技术的理论研究 本节将从数字孪生的基本概念、基础构成、应用场景等方面详细叙述数字孪
生技术。从理论技术方面考虑实现基于数字孪生的车间作业仿真与监控系统的可 能性。 2.1.1 数字孪生技术的基本概念
数字孪生（Digital Twin，DT）是一种超现实的概念，其又被人命名为数字镜 像或者数字化映射。最初，数字孪生思想由 Michael Grieves 教授称之为“信息镜 像模型”（Information Mirroring Model），在此之后转变成“数字孪生”这个专有概 念名词。数字孪生简言之就是根据某个设备或系统的“物理实体”，在虚拟世界 中创造出一个与之完全相同的数字版的“虚拟模型”，如同在与物理世界平行的数 字世界中创造某个物体的“双胞胎兄弟”一样。创造出的“双胞胎兄弟”会做出与真 实的物体一致的动作和反应，甚至可以在真实的物体运动的基础上尝试多种可能。 NASA 关于数字孪生的概念描述为：数字孪生是一个结合多个学科、在多个维度 进行仿真的过程，在这个仿真过程中充分发挥诸如物理模型、传感器、运行历史 等数据的作用。数字孪生体是物理实体产品在虚拟空间内的镜像，并且反映出对 应的物理实体产品的整个生命周期过程（于勇，2017）。 2.1.2 数字孪生技术的基础构成
最初使用比较频繁的数字孪生模型是 Michael Grieves 教授定义的三维模型 （2017），其包括真实空间中的物理模型、虚拟空间的虚拟模型以及将虚拟和物 理模型联系在一起的数据和信息之间的连接。
随着理论技术的发展，为了使数字孪生技术满足在更多场景的需求和更多领 域方面的应用，国内北航的数字孪生团队在 Michael Grieves 教授原来三维模型 的基础之上增加了服务和孪生数据两个模块，提出了数字孪生五维模型（陶飞 等， 2019），其结构图如下图 2.1 所示。
9

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 2.1 数字孪生五维结构 Figure 2.1 Digital twin five-dimensional structure
数字孪生五维模型各维度的具体含义如下所示： （1）物理实体是数字孪生模型的基础，是物理世界中一个客观存在的对象。 物理实体主要包括一些具有不同功能的系统模块，这些模块共同支持设备和传感 器的操作以收集设备产生的数据、传感器产生的数据以及环境数据。在搭建虚拟 实体前需要对物理实体进行分析，对物理实体的准确分析和有效拆解是快速准确 搭建数字孪生模型的必要前提。 （2）虚拟实体是对物理世界中的实体的数字化映射。虚拟实体由几何模型、 物理模型、行为和规则组合而成。几何模型在形状、尺寸、位置和装配关系等方 面对虚拟实体进行刻画，使虚拟实体在视觉感官方面与物理实体具有较好的空间 一致性。物理模型的概念是在几何模型层次的基础上添加的物理属性和约束等。 行为要素是指在物理实体中存在的环境影响因素以及正常的操作等。规则要素是 物理实体中存在的规律规则，需要人为总结或者通过某些方法总结得出。 （3）连接是实现孪生数据、服务、物理实体和虚拟实体部分彼此互联互通 的关键所在，可靠的连接可以保证物理实体和虚拟模型之间的一致性。数据是建 立连接的桥梁，通过数据的传递，可以实现真实模型与虚拟模型之间的连接、孪 生数据与物理实体的连接、孪生数据与虚拟实体的连接、服务与虚拟实体的连接。 通过 OPC UA 之类的通信协议完成数据的实时传递，可以实现物理实体与虚拟 实体之间的连接和通讯。 （4）孪生数据是数字孪生模型的驱动因子。孪生数据的来源包括能够反应 物理实体运行状况和实时性能的数据，虚拟实体中几何模型、物理模型、行为和
10

第 2 章 相关技术的研究
规则要素相关数据，用于提供系统服务的相关数据，专家知识、行业标准、规则 约束等规则类型的数据以及物理实体、虚拟实体、服务和连接融合衍生出来的数 据。
（5）服务是对数字孪生应用过程中各类数据和信息的封装，服务分为功能 性服务和业务性服务。功能性服务包括虚拟建模服务、数据连接服务等抽象的服 务。业务性服务主要就是和系统功能相关的服务，比如，数据分析和监控功能， 模型展示等功能。
2.1.3 数字孪生技术的应用场景 在当今发展的世界中，全世界各个领域的企业工程人员、院校以及科研院所
的科研人员都开始将数字孪生技术在自身的研究领域以及市场主体进行了研究 探索与应用实践。数字孪生技术的应用与研究主要集中在设备故障诊断、智慧医 疗、产品研发、智慧城市等应用场景中。
（1）最初数字孪生诞生时是美国国家航天局（NASA）用来对空间飞行器做 故障预测。之后也被应用在船舶、风力涡轮发电机等严峻环境下的大型复杂设备 的故障检测方面。基于数字孪生技术的故障预测，能够通过物理实体产生的动态 信息定位故障发生的位置以及判断故障发生的原因，分析设备的运行状态和损耗 情况，对其进行预先的检测和维修。
（2）基于智慧医疗的数字孪生，医护人员可通过一定的途径或者方式获取 人体反应健康状况的数据。通过得到的数据来判断人获得某个疾病的可能性。根 据数字孪生提供的健康服务，针对当前出现的健康问题使人们引起一定的重视， 并帮助人们适当调整生活作息、改善饮食平衡、增加运动等。在当身体出现某些 病症时，各地专家可通过远程的方式根据各类孪生数据和模型进行远程会诊，确 定病因并制定治疗方案。在遇到一些难度较高的手术时，医生们可使用头显设备 在虚拟人体上预实施不同的手术方案验证手术的可行性和安全性，直到确定对人 体最安全和有效的手术方案。除此之外，还可以依靠数字孪生模型对医护人员进 行操作训练和考核，提高医生专业操作技术的熟练性和稳定性。在虚拟的数字孪 生模型上进行药物的开发以及临床实验，很大程度上可以降低每一款药品在上市 前的研发周期。
11

基于数字孪生的车间作业仿真与监控系统的设计与实现
（3）产品研发是一个产品从策划到上线过程中最费事耗力的一个环节。通 过计算机辅助的手段协助产品研发已经不能满足现在开发的需求。通过数字孪生 技术可以在三维虚拟场景中复现产品开发的全生命周期。通过分析产生的孪生数 据可以深入了解一部分繁琐的物理模型并建立其对应的产品设计知识库，辅助产 品设计和研发。通过对虚拟实体和物理实体进行比较和分析，能够帮助迅速发现 设计中存在的问题，改善系统原型。
（4）在智慧城市方面，新加坡政府与 Dassault 飞机制造公司同盟，致力于 共同创建数字孪生城市。通过在虚拟场景中完成对城市的可视化监控、制定决策 等功能功能。美国 Cityzenith 软件公司为实现数字化的管理城市，构建了一个“5D 智能城市平台”。这个平台被用于实现城市基础建设过程中科技化的全生命周期 管理。借助数字孪生技术辅助人们进行城市管理，可以提高城市规划质量和城市 的有序性，让城市的发展与人类的相处更和谐与美好。
除上述应用场景外，数字孪生技术还在天然气能源、建筑行业以及农业监测 等行业均有应用前景，如远程监测石油探勘，追踪和监测粮食和动物的状态和健 康，评估房屋质量等方面。
2.2 OPC UA 技术 OPC UA (Object Linking and Embedding for Process Control Unified
Architecture）是 OPC 的下一代标准，它也是由 OPC 基金会主导的，多家厂商参 加技术方面的设计、开发和产品化的 OPC 标准。它通过提供一个完整的、安全 的、可靠的跨平台架构以获取实时的数据、时间或者历史数据。OPC UA 统一架 构帮助工业领域内的各种软硬件厂商提供技术路线，使开发的设备可以无缝衔接 的融入到工业 4.0 中的各个体系当中。因为其强大的功能，德国机械设备制造业 联合会（German Mechanical Engineering Industry Association，VDMA）指定 OPC UA 架构为工业 4.0 通信的推荐规范（Adolphs 等，2017），用于实现工业互联网 的互联互通。
2.2.1 OPC UA 技术的优势 OPC UA 实现了从现场设备到企业管理各个层级的实时数据互通互联，具有
12

第 2 章 相关技术的研究
跨网络、跨平台、安全性高和强大的建模能力的特点，成为面向智能制造互联互 通和信息集成方面重要的解决方案之一。（刘星，2017）。在本文系统中，数据采 集部分采用 OPC UA 统一架构来进行设计与开发。选择 OPC UA 的主要原因是 OPC UA 架构具有以下特点：
（1）访问统一性 OPC UA 将现有的 OPC 规范继承下来，并提供一致、完整的地址空间和服 务模型。客户端只需要进行一次访问就可获得所有信息，解决之前很长一段时间 信息不能通过同一种方式被访问的问题。 （2）面向服务架构 应用程序通过服务进行通信，服务不受限于操作系统、编程语言和平台。OPC UA 可以在 Windows、Linux、Unix 等平台上使用 C++、C#、java 等各种语言进 行开发。 （3）高性能通信 OPC UA 可以使用任意类型的端口（管理员开放权限的端口）进行数据通信， 跨过防火墙和通过互联网进行传输，提高了通信速度。传输的数据不限制数据编 码格式和数据传输协议，使用 XML 格式或者二进制的数据编码格式，搭配 TCP/IP 协议或者 HTTP 协议都可以进行数据通信。 （4）安全性 OPC UA 通过应用标准安全模型来达到安全通信的目的，并且要求所有 OPC UA 应用都必须贯彻遵循。OPC UA 底层使用非对称加密和 X.509 证书提供安全 保障。OPC UA 支持多项安全技术，每个 OPC UA 的客户端和服务器的身份都要 通过 SSL 证书标识和验证，来实现安全连接。 （5）设计的可靠性 错误检测和恢复特性使得 OPC UA 产品具备对错误的自动检查与纠正能力。 去重功能的支持使得 OPC UA 模块可以兼容不同品牌厂家产品的应用。 （6）客户端/服务端与发布者/订阅者实现机制 OPC UA 提供了两种不同的实现机制：基于 TCP 的客户端/服务器模型和基 于 UDP 的发布者/订阅者模型。
13

基于数字孪生的车间作业仿真与监控系统的设计与实现
对于制造过程中的多来源数据，使用具有以上优势的 OPC UA 技术进行传 输和解析，可以融合多元异构数据实现设备和系统的互联互通。对于致力于实现 工厂智能化来讲，支持 OPC UA 的设备是非常适合的选择。
2.2.2 OPC UA 与 OPC DA 的区别 OPC UA 和 OPC DA 都是工业制造业方面进行数据采集常用的两种通信协
议。OPC 是来源于 COM/DCOM 的数据访问格式的标准。传统的 OPC 技术只能 应用在 Windows 操作系统上。OPC UA 不再是基于 COM/DCOM 的技术，它可 以实现跨平台跨系统访问。它扩展了 OPC 的应用平台，可以在更多的的硬件平 台和软件平台上应用。以 PC 机、ARM、PLC、基于云的服务器等微处理器为代 表的硬件平台以及以 Windows 操作系统、、Linux 操作系统、OSX 操作系统、 Android 系统等操作系统。OPC DA 是基于 OPC 标准的数据访问。因为是基于 COM/DCOM 技术的，所以 OPC DA 只能在 Windows 操作系统上使用。由于 OPC UA 可以通过对传递的数据进行安全加密处理控制数据连接和信息本身的保密性， 所以 OPC UA 比 OPC DA 具有更高的安全性。新的安全模型确保了数据从设备 采集到数据传输过程中的可靠性。OPC UA 的地址空间也进行了优化。所有的数 据都可以被分成不同的数据结构类型，对于 OPC UA 的客户端来说读写数据就 不受限与数据的类型和结构。
2.3 本章小结 本章首先介绍了数据孪生技术的基本概念，即数字孪生是在一个虚拟数字环
境中建立一个与真实环境无差别的数字镜像。数字孪生五维模型的基础构成主要 包括物理实体、虚拟实体、孪生数据、连接和服务，应用场景主要在故障诊断、 智慧医疗、智能车间、智慧城市等方面并且取得一定的成就。然后介绍了本文的 另外一个关键技术 OPC UA，OPC UA 在本文数据采集方面进行了应用。本文分 别从它的定义、优势以及 OPC UA 和 OPC DA 的区别进行介绍。OPC 规范包括 OPC 服务器和 OPC 客户端两个部分。其实质是在硬件设备和软件系统之间通过 一座桥梁进行连接，并制定连接规则。OPA UA 是在 OPC 协议的基础上的扩展。 OPC UA 具有访问统一性、高性能、可靠、安全、面向服务架构、使用订阅机制
14

第 2 章 相关技术的研究
等优势。这些优势都为 OPC UA 在工业 4.0 智能制造的实现提供了通讯基础，并 使其占据智能制造开发中的一席之地。
15

基于数字孪生的车间作业仿真与监控系统的设计与实现 16

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
第3章 基于数字孪生的车间作业仿真与监控系统的设计
3.1 基于数字孪生的车间作业仿真与监控系统的设计目标 3.1.1 当前存在的问题
目前的车间生产的管理方式已经大大地将过去的那种完全凭借先验知识，一 切依靠人工实践完成的生产活动进行了根本性的改善，不仅仅降低了对先验知识 的依赖性，而且提高了相关工作的最终准确性，但是该管理方式仍然存在一定的 缺陷和不足。比如在整个生产计划方面仍然会存在相关工作计划制定的不合理， 从而导致发生了车间生产工作未完成的延期交货或者超期交货的相关情况，同时 在车间工作设备相关故障检测方面依然很难实现设备的故障提前预测和提前预 警，并且还会存在车间设备维护人员对车间生产工作实时监控困难等问题。
在车间生产计划的方面，车间的管理人员通常对每日、每周、每月等相应各 个周期的车间生产计划和安排不太明确。车间各层级管理人员对车间生产工艺要 求、车间生产的进度都是基于口头表述，通常对已经制定的计划生产的产品数量 只能给出一个大约或者近似估计的不准确数字，缺乏一定整体层面的统筹、组织 策划能力。管理人员由于这些能力的缺失，导致相应层级的管理人员在各自部门 之间的工作不协调，因此可能会发生人员对流量的控制出现不可预知的问题，导 致车间仓储系统积压了大量半成品。相应的市场部人员由于各部门不协调、人员 及部门之间的信息交流不够充分等原因，从而对车间所需求的采购数量不够明确， 导致车间生产急需的相关材料的提供跟不上车间设备生产运行的需要。这就会导 致相应的项目在交付时间即将要截止的时候，车间还未完成生产目标时进行连续 长时间的、高强度的加班作业。以上介绍的种种情况会降低各个部门员工的工作 积极性，从而对自身的工作产生极大的厌烦感。没有确定性、不明确的生产计划 也会影响员工的具体操作与执行，导致生产人员与管理人员的目标方向不一致， 从而降低了整个部门联合体的生产工作效率。
在车间设备故障检测方面，如果不能对生产车间内正在处于运行中的设备发 生的故障提前作出准确的预测和实施相应的预警手段，有很大的可能会导致车间
17

基于数字孪生的车间作业仿真与监控系统的设计与实现
设备发生与原计划相偏离，甚至是背离的情况。这种预期之外发生的故障将极大 的恶化生产设备的使用情况并且影响整体的生产效率，从而为车间项目组带来相 当巨大的经济损失和无法估量的计划拖延的后果。当发生预期之外的情况时，若 无操作人员及时发现，还会造成对生产原料的浪费使用和不符合相关质量检测的 产品的增加。此外生产设备的维修人员对设备的故障排查和故障维修还需要一定 的时间花费，若生产设备故障发生在生产计划压力比较大的时间段内，则会影响 到生产项目后期的交付，对整个生产制造产生难以估量的巨大的影响。
在对生产车间的实时监控方面，当前可使用的监控手段较为单一。生产车间 维护人员缺乏对生产车间工作运行过程中的总体的、全面的、详细的感知。生产 车间维护人员只能通过高频次的不间断的巡逻或者利用红外摄像头二维图像的 形式进行监控，并且由于基于红外摄像头的监控天然存在监控死角，这导致不能 对车间实现全面的监控，因此缺少更精细化的监控管理。
因此，本文提出基于数字孪生的车间作业仿真与监控来解决这些问题，希望 能改进车间在生产过程中的的一些问题，优化车间整体的管理效率，缩小企业生 产成本的支出以及管理成本的支出，实现车间发展的数字化、虚拟化和智能化。
3.1.2 系统设计原则 系统设计的总体原则是保证系统功能齐全的前提下，系统的研发尽量达到科
学化、经济化和低耦合的总体要求，满足系统资源的分配和技术应用能够平衡的 状态，系统设计中应遵守以下原则：
（1）完备性原则 完备性主要是指研发的系统功能是完整的、健全的，能够满足用户的对系统 功能的需求，系统具备数据采集、传输、管理、分析及反馈等功能。系统的完备 性首先要求系统的设计必须是完备的，在进行系统设计时必须符合设计的规范和 要求。 （2）可复用性原则 可复用性是开发人员在开发过程中实现的。可复用性可以实现系统在多种场 景中的移植操作。要使系统具备可复用的特性，开发人员应当充分分析此类型系 统搭建中共同存在的问题和常用方法，然后设计出一套解决问题的通用系方法，
18

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
方便系统的移植。 （3）经济性原则 经济性原则是指在保证系统功能完备的情况下，尽可能的节约经费的支出。
不能只根据预算的多少决定硬件配置的高低而是应该结合需求，以满足系统性能 要求为前提进行选择。其次应该避免反复更换设备，选择设备前应做好提前分析， 既要考虑眼前问题，又要考虑长期打算。在系统设计中应避免系统功能模块的代 码的冗余和聚合，使各模块间的耦合度尽可能的低。
（4）可靠性原则 可靠性是软件质量测试的重要指标，可以衡量系统是否能够正常运行。可靠 性也是系统设计中需要重视的地方。系统的可靠性是实现系统可扩展的基础。在 初期的设计中就考虑到系统的稳定性，可以节约后期很多的维护成本。因此，只 有设计出的系统满足可靠性，才能保证系统能够长期安全稳定的运行。 （5）可扩展性 可扩展性决定了系统二次开发的成本和难易程度。可扩展性越好，在给原来 的系统添加新功能或者修改现有功能时，开发成本就会越低。反之开发成本就会 增加。系统功能的可扩展性要视软件的规模和复杂性而定，系统的开发应采用增 量的形式进行螺旋式开发或者分层开发。 3.1.3 系统需求分析 通过对当前车间存在的问题进行分析，提出当前车间管理系统存在的问题。 根据当前问题，确定以下系统需要实现的功能性的需求如图 3.1 所示。在系统性 能方面，对计算机的配置要求不能太高并且需要满足日常条件下的使用。计算机 CPU、GPU 的占用率不能长时间高于 90%。
19

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 3.1 系统功能性需求 Figure 3.1 System functional requirements
在相关车间生产计划方面，通过采集的生产设备相关的实时数据以及生产物 料的相关数据对生产状态进行实时跟踪并动态的调整生产计划，增强信息物理世 界的融合，提高生产计划的抗干扰性和智能性。
在生产车间设备故障检测方面，基于物理设备比如数控系统、传感器等与虚 拟模型实时交互，通过孪生数据驱动设备状态评估、设备故障诊断。通过温度监 控，对设备老化或者功耗出现问题的设备提前预警。
在车间实时监控方面，通过建立现场制造设备的三维模型，在虚拟空间完成 实体映射，实现制造设备的运行状态监控与作业参数监控。改善存在监控死角的 问题，提供自由视角、第一人称视角、自动浏览视角多种监控视角，实现全方位 监控车间的运行状况。通过可视化界面展示当前的生产细节。比如：当前工作工 时、生产产品数量等。车间工作人员可以借助可视化的数据进行生产分析等其他 工作。
3.2 基于数字孪生的车间作业仿真与监控系统的系统架构 3.2.1 系统的整体流程设计
在确定车间作业仿真与监控系统的设计目标与设计原则后，搜集、阅读、研 究相关资料确定系统的开发流程。按照正确的研发流程，可以提高系统的开发速 度和达到系统的完备性、可复用性、经济性、可靠性和可扩展性的要求。经研究 后，确定系统的开发流程如下图 3.2 所示。
20

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
图 3.2 系统整体流程 Figure 3.2 Overall flow of the system
确定系统整体流程后，进行系统架构设计，将系统划分为数据获取和虚拟建 模模块分别进行开发之后将模型进行融合，进一步完善系统功能。最后进行系统 测试。在本文整个系统开发中，主要对车间以及车间中的设备、传感器等为对象 进行建模工作。
首先在 3dMax 软件中构建车间系统的三维模型并导出.fbx 格式的模型。在 模型导出前进行优化，控制片面数量控制防止模型加载不出来。将.fbx 格式模型 导入 Unity3D，完成场景搭建和模型渲染的工作，利用 C#编程语言在 Visual Studio 编辑脚本驱动模型，系统设计流程如下图 3.3 所示。
图 3.3 系统设计流程 Figure 3.3 System design process
3.2.2 基于数字孪生的系统框架 本文通过在数字孪生五维模型（陶飞 等，2019）的基础上确定系统整体框
架框如下图 3.4 所示：
21

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 3.4 基于数字孪生的系统整体框架 Figure 3.4 Overall framework of the system based on digital twinning
下面是对模型各部分的介绍： （1）物理模型 物理模型是现实场景中完成生产制造的整个车间系统以及其子系统。物理模 型是虚拟实体刻画的对象，是数字孪生模型的基础。在本文中的物理模型指的是 生产车间、车间的数控设备、传感器等以及车间的生产过程。从物理模型中采集 的数据主要包括设备所处的环境数据、自身运动产生的动态数据以及约束规则， 环境数据主要包括设备外观数据、车间的外观数据、设备状态、网络状态，动态 数据主要包括高性能的传感器数据、控制器数据、数控设备数据，并且跟随物理 模型中实时数据的产生而被不断地更新变化。 （2）虚拟模型 虚拟模型是对物理生产车间的数字化映射，它包括车间系统的各种物理信息、 几何、规则和行为等要素。通常会使用 SolidWorks、3dMax、Unity3D 等软件在 虚拟的三维场景中对物理实体进行仿真建模、分析和优化，模拟物理模型中的生 产活动，创造出与真实环境中的所有实体具有空间一致性的三维场景。通过物理 车间模型实时采集的数据传输到虚拟车间模型中实现对整个系统的驱动，可以实 现虚拟模型与真实模型的一致运动。 （3）连接 本文系统中连接的目的是实现其他各部分的互通，实现数据的有效传输。只 有其他各个模块有效连接起来，数据才能实现循环。物理模型与虚拟模型连接可 以实现物理模型的数字化映射，物理模型与孪生数据的连接以及虚拟模型与孪生
22

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
数据的连接可以实现基于数据驱动的实时仿真。孪生数据与系统服务的连接可以 提供实现系统服务中的数据分析和管理的功能。因此，实现彼此之间的连接对于 系统的实现具有重要意义。
（4）孪生数据 孪生数据是驱动本文系统运行的核心组成要素，同时也是物理模型、虚拟模 型、系统服务彼此之间互联互通的必要组成要素。孪生数据模块为相关物理模型、 虚拟模型以及系统服务模块的平稳运行提供了必要数据支撑，并且集成了孪生数 据的采集、孪生数据处理以及数字孪生数据融合等针对数据处理操作功能。 （5）系统服务 系统服务是系统提供的模型展示、数据管理、生产监控功能的集合。通过孪 生数据驱动虚拟模型变化，完成在虚拟场景中的生产制造过程并在虚拟的三维场 景中监控生产过程的物料变化、设备问题等，以数字化、直观化的方式提供用户 系统运行过程中数据统计功能和数据分析功能，帮助车间操作人员更方便的作出 及时的判断。
3.3 基于数字孪生的车间作业仿真与监控系统的系统模块设计 本节将整个系统划分成虚拟系统模块、数据采集模块和系统服务模块三大系
统模块，接下来将分别从以上几个方面进行详细介绍。 3.3.1 数据采集模块
关于本文的车间作业仿真与监控系统，需要实时监控车间的运行状态，以保 证系统设计目的的实现。对于车间作业的仿真与监控系统，系统运行的关键所在 便是通过数据的驱动。系统采集的数据应该满足数字孪生车间的数据处理的相关 需求，保证系统功能的完整性和及时性。所以为了保证系统功能的及时性和完整 性，本节总结了系统所需的所有数据的来源并进行分类。其中，数据主要来源包 括数控设备、生产物料、辅助设备以及其他数据，如图 3.5 所示。
23

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 3.5 系统数据来源 Figure 3.5 Sources of system data
（1）数控设备数据包括数控机床的基本信息、报警信息和运行状态信息等。 数控机床的基本信息包括车间数控机床的厂家名称、型号、设备参数等。运行状 态信息包括设备运行中的主轴倍率和进给倍率、主轴转速、进给速度、机床运行 模式、NC 模式、数控机床开机时间、待机时间、设备和工序要求、加工零件个 数等。报警信息包括故障的机床编号、故障种类、发生次数、发生率信息等。
（2）生产物料数据和仓库库存数据。生产物料数据包含产品的属性、原料 种类、数量等。仓储库存主要包含产品入库、出库的数量、存储的数量等。
（3）辅助设备数据主要包含机械臂、AGV 小车、无线温度采集器、物联集 中器、三轴振动传感器等系统相关的辅助设备产生的数据，包括辅助设备的基本 信息、技术参数等。
（4）其他数据主要包括环境数据和位置信息。环境数据包含车间的温度、 湿度以及日期，位置信息是设备在车间中的坐标。
分析所有数据的来源和类型，根据系统的开发中对数据实时性的要求将所有 数据分成两种类型：实时数据和非实时数据。非实时数据是在系统运行过程中变 化较少的数据，数据更新速度比较慢，不需要实时获取的数据。非实时数据包括 车间环境、设备相关的一些基础信息和通用信息。实时数据是随着车间生产的进 行而产生，并不断更新变化的数据，在系统运行过程中需要进行实时的获取。实 时数据包括生产设备运行产生的数据、传感器采集到的数据等。 3.3.2 虚拟系统模块
24

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
3.3.2.1 建模要求及原则 通过相关建模技术实现虚拟系统逼真的复刻，给用户提供良好视觉体验并且
能够为虚拟模型系统在规则模型层次的实现提供良好的基础。因此，关于虚拟系 统的建模，本节提出以下四点要求：
（1）层次性 虚拟模型中包含较多的三维模型并且彼此之间存在一定的依赖关系。由于模 型的数量比较多，依赖关系更容易产生混乱。因此，建立有较好的层次关系的模 型，有助于在增强整个建模过程的逻辑性和条理性。还有助于在开发和维护过程 中对模型进行调整，方便日后对模型进行二次开发。 （2）交互性 虚拟模型是数字孪生系统中用户可以直接浏览并进行操作的模块，也是交互 最频繁的模块。用户通过虚拟模型了解到车间作业的进行情况，通过多视角的监 控全面了解车间生产状况。并且在使用过程中提供数据分析和挖掘的功能。所以 要求系统应该具有一定的交互性，在满足系统管理人员的日常操作的基础上，提 供更高的便捷性和灵活性。 （3）平衡性 由于虚拟模型文件体积较大且系统中存在很多实时交互的操作，对计算机的 内存空间和数据处理性能都提出了较高的要求。在建模过程中，应考虑在尽量满 足系统建设目标的情况下优化模型，尽量减小内存空间的占用量，减小对 CPU、 GPU 性能的依赖。在功能需求与性能要求之间达到平衡，实现性价比的最大化。 也方便系统的移植与扩展。 （4）美观性 虚拟系统实现的是对真实物理模型的映射，与真实的物理模型在功能、布局 等方面具有一致性，应选择使用功能完善的建模软件实现对真实物理模型的建模 工作，使用逼真的贴纸实现对真实物理模型外观的模拟，以达到数字孪生的要求。
3.3.2.2 建模层次划分 车间虚拟系统的搭建是一个逐渐深入的过程。先完成几何模型层次的搭建，
再考虑动作模型层次，最后是规则模型层次。各层次的层级如下图 3.6 所示。
25

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 3.6 建模层次 Figure 3.6 Modeling hierarchy
（1）几何模型层次 完成车间整体几何模型的搭建，就是完成车间虚拟模型中环境、灯光、控制 器、传感器、数控设备等的静态要素的建模工作。这是虚拟系统搭建的第一步， 也是整个虚拟系统搭建的基础工作。 （2）动作模型层次 真实车间是不断进行生产操作的，车间的运行是一个各种设备齐力完成工作 的动态的过程。所以只有静态的几何模型是不够的，还需要让虚拟模型中的各种 设备模型动起来。在这一层次需要完成的是各种设备的各种不同的操作。比如车 间运输车辆的移动、拐弯，机械臂的抓取、放下，传送带的移动等操作。 （3）规则模型层次 在生产过程中会存在不同的指令。比如，开机、关机、暂停、添加物料等操 作都对应这设备不同的状态，在这一层次整理真实车间生产过程中各生产要素的 运行规则，完成在虚拟环境中规则的使用，实现在更深层次的物理车间的建模工 作。 3.3.3 系统服务模块 系统服务模块是本文系统提供的一种直接面向用户的模块，该模块具有较强 的交互性和展示性，可以根据系统需要实现的目标，提供相应的功能。结合对相 关技术的了解，本文的系统服务模块提供了车间监控、数据管理和分析、生产仿 真以及设备预警的功能。具体功能如下图 3.7 所示。
26

第 3 章 基于数字孪生的车间作业仿真与监控系统的设计
图 3.7 系统服务功能模块 Figure 3.7 System service function module
车间监控功能可以实现车间生产过程的全方位、多角度的监控，此功能提供 了三种监控视角，分别是：第一人称、自由视角和自动浏览。第一人称视角可以 提供最直观的监控视角。该功能是实现第一人称视图模式下的车间漫游，使用者 以第一人称视角的方式，使用键盘按键操作方向，实现在车间中可以自由漫游。 自由视角可以实现任意选取设备通过第一人称视角进行观察。自动浏览功能是系 统安装车间的部件，在核心的区域自动的漫游，不需要用户操作就可以循环的对 车间进行巡视。最后重置视角的功能是当场景沙盘移动的位置已经不可在窗口中 观察到，点击“重置视角”用将场景恢复移动到初始位置处。
生产仿真功能是本文系统模拟真实物理车间生产的功能。需要通过实时数据 驱动完成。在虚拟的环境中，同步展示真实的生产作业过程。
数据管理和分析功能提供的是系统数据的统计和分析功能，包括设备的运行 状态数据统计、生产状态数据统计、生产环境数据统计。根据一定规则，分析车 间最优效率、分析效率瓶颈，统计车间内数控机床等设备在运行时间内的运行效 率和故障等。通过这些数据用户可以更方便的了解整体车间的运行状态，调整生 产计划或者生产进度，提高了生产管理人员的管理效率。
系统预警功能主要是根据数据管理和分析功能衍生出来的功能。通过分析生 产环境数据，当生产环境数据出现一定问题时，预示系统可能会发生某些问题。 比如温度传感器收集到的温度数据一直处在较高位的水平，那么温度传感器监控 的设备可能会存在功率过大、金属类的设备机械强度下降等问题。通过这种监测，
27

基于数字孪生的车间作业仿真与监控系统的设计与实现
可以尽早发现设备的问题。 系统服务模块是在本文系统的基础上根据系统采集的数据对车间设备、生产
物料等方面进行监控。本层通过搭建虚拟系统模块，采集系统产生的实时数据， 分析系统车间设备的运行状态并使车间管理人员更方便的对车间生产进行生产 监控，实现了生产车间监控的全面无死角和车间管理的可视透明化，节约了车间 生产的用人成本、物料成本、维护成本。 3.4 本章小结
本章对基于数字孪生的车间作业仿真与监控系统进行了设计，根据功能划分 为数据采集模块、虚拟系统模块、系统服务模块三大模块，并分别进行设计。第 一节在数据采集模块对系统涉及到的数据进行整理、并根据系统的开发要求进行 分类，分成静态数据和动态数据；第二节在虚拟系统模块对系统的建模提出了要 求，并根据建模要求对虚拟模型层次进行划分；第三节在系统服务模块对系统服 务功能进行整理和总结，将系统功能分成车间监控功能、数据管理和分析功能、 生产仿真功能以及设备预警的功能，为接下来的系统实现做准备。
28

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
第4章 基于数字孪生的车间作业仿真与监控系统的实现
4.1 实现流程 在本文中以生产车间作为物理对象，首先搭建虚拟场景中的车间虚拟模型并
对搭建好的模型进行优化、处理虚拟模型中存在的碰撞检测问题，其次通过 OPC UA 协议连接车间的数控设备、传感器和控制器采集车间的实时数据，将从车间 数控设备、传感器、控制器中采集的数据传输到虚拟系统中，借助 C#脚本驱动 虚拟系统中的模型进行运动，从而完成整个动态仿真的工作，实现系统实时监控 的功能。本文系统的整体开发流程如图 4.1 所示。基于此开发流程，首先要完成 的是虚拟系统的搭建工作，确定建模对象、建模、优化及碰撞检测的方法；其次 是分析系统的数据来源和类型，确定数据结构和哪些是需要采集的实时数据，通 过 OPC UA 客户端/服务端的模式采集车间生产过程中产生的实时数据，然后存 入到数据库中以及使用 C#脚本通过 Socket 通信的方式将实时数据写入虚拟模型 中，同时通过对数据库中存储的孪生数据进行加工和处理提供数据管理和统计的 相关系统服务功能。最终，在 Unity3D 中建立车间生产的动态仿真模型，从而实 现基于数字孪生的车间作业仿真与监控系统。
图 4.1 系统开发流程 Figure 4.1 System development process
29

基于数字孪生的车间作业仿真与监控系统的设计与实现
4.2 虚拟模型的搭建 4.2.1 模型的搭建流程
以车间为对象的虚拟模型的建模过程如下图 4.2 所示：
图 4.2 虚拟建模流程 Figure 4.2 Modeling flow of the virtual model
（1）分析并确定建模方案 分析系统设计需求，决定使用 3dMax、Unity3D 来实现建模工作。3dMax 是 一款 PC 端的三维立体动画设计渲染和制作软件。它由 Discreet 公司开发，后被 Autodesk 公司合并收购。由于 3dMax 的学习成本较低、功能齐全、学习资料比 较丰富，在广告设计、影视创作、工业制造以及工程可视化等领域被广泛应用。 在 Unity3D 平台上可以进行任何创意的发挥与想法变现，包括但不仅限于游戏、 艺术和设计等领域，支持在移动端、PC 端以及虚拟设备端发布 2D 内容和 3D 内 容。 （2）建立与真实车间一致的虚拟车间的几何模型 首先根据设备说明书中的资料确定模型结构和尺寸。其次在建模过程中，由 于考虑到后续模型要与数据对接进行运动，所以要对整体模型进行拆解。具体到 某个设备零部件进行建模，对子模块建模完成后再进行拼接。在导出模型前，还 需要对模型进行优化处理。因为未做优化处理的模型顶点和片面数较多，加载速 度慢，用户体验较差，对计算机性能要求也比较高。所以，为了减少计算机加载 几何模型的时间，降低计算机的 CPU、GPU 的占用率，还需要对几何模型进行 优化处理。在 3dMax 中选择需要优化的模型，点击修改→配置修改器集→优化， 根据模型的实际情况对模型的优化参数进行设置，优化模型。找到工作栏中的“上 次优化状态”观察模型顶点以及面数的优化情况，可以看到随着面阈值的增大，
30

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
模型的面数会有明显的下降从而达到模型优化效果。最后，优化结束后以.fbx 的 格式将各个模型导出。
将建好的白模生成出.fpx 文件再导入到 Unity 中进行材质添加的其他后续处 理。在 Unity3D 中直接读入模型，通过添加真实设备的纹理图片和贴图的方式制 作材质球，完成后给读入的模型添加相应的材质，可以提高模型的虚拟仿真效果。 纹理图片是手工调整材质球参数仿照真实设备效果进行制作的，而贴图则是将从 真实设备采集到的图片在 PS 中重新分割，然后在 Unity3D 中通过调用脚本的方 式将贴图的不同部分附着到模型上，实现虚拟仿真的效果。最后再将这些模型制 作成预设体，方便之后场景搭建等工作的进行，这就完成了虚拟环境中的各种几 何模型的建模操作。
（3）搭建虚拟车间的环境要素 将优化好的车间生产设备的几何模型的预设体用在新创建的场景中，搭建虚 拟车间的整体场景。在整体场景搭建中，为了达到模型的真实性和场景的真实性， 虚拟场景中灯光的设置是必不可少的一步。通过在虚拟模型中添加定向光源、点 光源或者聚光灯的方式给虚拟模型添加光线，模拟真实物理环境下的光源环境。 选择 Unity3D 自身提供的的 Light 组件，点击 Component 选项下面的 Rendering 再选择 Light 选项添加光线。Light 光照属性中包含了渲染模式、光照范围、颜 色、强度、阴影类型等多种参数。在虚拟场景搭建中尽量多的选择使用定向光源， 通过调节光源属性达到与真实环境中光线一致的目的。因为，点光源和聚光灯内 存资源的消耗比较大，对计算机性能要求会略高一点，相比之下定向光源更适合 本系统。

图 4.3 定向光源 Figure 4.3 Directional light source

图 4.4 点光源 Figure 4.4 Point light source
31

基于数字孪生的车间作业仿真与监控系统的设计与实现

图 4.5 聚光灯

图 4.6 漫反射效果图

Figure 4.5 Spotlight

Figure 4.6 Diffuse reflection effect

定向光源被认为是从无穷远处投射过来的平行光线。用于创建场景的太阳光

线。点光源向各个方向发光，用于创建像灯泡的效果。聚光灯以当作路灯、壁灯

或手电筒。同时还在模型上添加了漫反射着色器，用以模拟真实车间设备并不是

完全光滑的表面。漫反射着色器可以模拟光线投射到粗糙物体的表面上，光朝各

个方向反射的效果，效果如图 4.6 所示。虽然入射光线是彼此平行的，但由于粗

糙物体表面各个点的法线方向不一致，使得反射光线看起来好像朝着不同的方向

无规律地反射。（彭人杰和段华琼，2020）。漫反射公式如下 4.1。

𝐶!"##$%& = （𝐶'"()* ∙ 𝑀!"##$%&）𝑚𝑎𝑥(0, 𝑛, ∙ 𝑙.)

…（4.1）

除了设置环境光线，最主要的是设置被导入的模型在系统中的层次依赖关系，

从而避免在系统运行时发生不符合实际情况的运动。在虚拟场景中的每一个零部

件都是一个子组件，将所有的子组件按照从属关系进行连接，才能制作出一个运

动与实际情况相一致的虚拟模型。在 Unity3D 的 Hierarchy 视图中，可以通过一

种简单的方式可以将模型中相似的 Object 组织到一块，通过组合关系的连接使

得对某个模块的操作变得更加简单。

（4）通过 C#脚本实现基于真实物理模型的数据的虚拟模型的驱动。场景中

的每一个模型都是一个对象，每一个对象身上可以挂载很多组件。通过 C#脚本

将组件挂载在需要操作的对象物体上，可以完成虚拟模型的某些运动和变化。

Transform（变换）属性作为场景中的每个对象都有且仅有一个的属性，是整个

Unity3D 中最核心的属性，也是模型在场景完成一系列操作的基础。Transform 属

性的基础属性分别是：position（位置）、rotation（旋转）和 scale（缩放），如下

图 4.7 所示。

32

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
图 4.7 Transform 属性 Figure 4.7 Transform attributes
通过在脚本中动态的修改 transform.position 或者使用 transform.Translate( )等 方法可以实现物体的移动；同样通过 transform.Rotate( )等方法可以完成物体的旋 转；最后通过 transform.Scale( )可以实现模型的缩放，其中需要注意的是：在 Unity3D 中，对于导入的模型以及 Unity3D 中自带的 Object 来说，直接改变自己 属性坐标的大小是无法实现物体的缩放的，只能通过缩放变换坐标系来实现。其 次是不能直接通过操作 rotation 属性来旋转物体，因为在 Unity 中 rotation 属性是 四元数，用来避免万象节锁现象，因此需要通过改变欧拉角或利用四元数的插值 的方式进行旋转操作。模型在场景中的运动可以由上面的移动、旋转、缩放三种 基础操作组合完成。通过 Camera 组件、Canvas 组件、Visual 组件等其他的组件， 可以完善虚拟场景中场景漫游、场景切换、控制面板、信息展示等功能。应用多 类型粒子效果实现报警信息提示，采用 Shader 编程技术优化三维渲染质量。
在 VS 2019 中对 Unity3D 中的场景进行 C#脚本开发，Unity3D 还提供了 Awake( )、Start( )、Update( )、FixUpdate( )等函数，其中 Update( )函数在每帧之 间被调用，在 Update( )中调用 transform.Translate( )等方法可以实现物体的连续运 动。设备运行产生的实时数据经过采集传输处理后传递到虚拟系统中，通过作为 transform.Translate( )等函数的参数来改变虚拟系统中模型的运动状态。根据各设 备的运动特性和变化规则，完成相应的驱动脚本的开发。在脚本中通过 Gameobject.getcomponent 的方法进行对象绑定或者直接将 C#脚本绑到对应的对 象上，从而实现脚本驱动三维模型的运动。 4.2.2 碰撞检测
33

基于数字孪生的车间作业仿真与监控系统的设计与实现
在三维虚拟场景中的碰撞检测是模拟真实条件下物体在遇到碰撞情况后的 动作暂停或者后退等状态。在虚拟场景中如果不存在碰撞检测，当物体发生碰撞 时物体之间会发生穿透或者重叠的现象。Unity3D 引擎提供了一些用于碰撞检测 的碰撞器，比如：Box Collider、capsule Collider、Sphere Collider 等。对于虚拟场 景中一些简单的碰撞操作，通过给模型添加碰撞器即可完成。但对于复杂度和精 度要求较高的场景，Unity3D 中碰撞器还存在效率低、不准确的问题。因此本文 中在三维虚拟场景中的碰撞检测采用了两种方法。一是 Unity3D 提供的碰撞器检 测法，二是基于隐函数的碰撞检测法（王帅 等，2017）。通过基于复杂曲面的隐 函数碰撞检测法对虚拟场景中的运动中的数控机床进行碰撞检测，算法流程如图 4.8 所示。
图 4.8 基于隐函数的碰撞检测算法 Figure 4.8 Collision Detection Algorithm Based on Implicit Function
通过给机床切削刀具以及工件表面构建隐函数曲面方程从而创建物体的包 围盒，通过包围盒检测法排除一部分的规则实体。如果检测出包围盒没有重叠现 象，则判断物体没有发生碰撞。如果检测出有包围盒重叠的现象，就先去除掉物 体之间不可能发生碰撞的无关点，通过逆运动映射使物体处在相同的坐标系中。 最后通过求解隐函数方程的根，判断根之间的关系进而来判断是否发生物体之间 是否有碰撞的产生。
机床中不规则形状的刀具及工件的形状是通过各种规则的几何形状组合的 形式表达出来。每个物体都有一个与世界坐标系平行的固定坐标系O+x+y+z+， 还有实时位姿的坐标系O,x,y,z,，在物体实时位姿O,x,y,z,变化过程中通过逆运 动映射运算来计算当前位姿态在世界坐标系下的坐标下O+x+y+z+，重新获取物 体的隐函数曲面方程。在判定是否发生碰撞前，要对各个物体限定边界范围，然 后判断物体各个部分隐式曲线函数和边界确定点是否在曲面上，若点在曲面外，
34

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
则未发生碰撞；如果在曲面上，则发生碰撞；如果点在曲面内，则至少存在两个 碰撞点。
4.3 数据的采集和传输 4.3.1 OPC UA 数据架构
OPC UA 架构是由 OPC UA 的客户端和服务端组成。OPC UA 的服务端负责 底层设备的数据采集工作和响应客户端的请求。OPC UA 的客户端负责对服务端 提出请求，服务端响应后，将接收到的信息给用户（刘丹 等，2017）。
图 4.9 OPC UA 客服端/服务端模式 Figure 4.9 OPC UA customer service/server mode
OPC UA 客户端与服务端交互的具体步骤（王民，2018）如下： （1）OPC UA 客户端发送服务请求 （2）请求经由 OPC UA 通信栈后发送给服务器 （3）OPC UA 服务端接受请求后调用相应的服务集，在地址空间内的节点 上或者是监视订阅等模块中执行任务 （4）服务器向客户端返回相应的请求响应 （5）响应经由 OPC UA 通信栈发送到客户端 （6）OPC UA 客户端会对服务器返回的信息进行处理 （7）OPC UA 客户端将从 OPC UA 服务端的地址空间获取到的节点信息等 返回给用户
35

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 4.10 OPC UA 体系架构 Figure 4.10 OPC UA architecture
OPC UA 客户端发送给服务端的请求主要有读、写、订阅三种形式。请求类 型主要包括读数据、写数据、订阅数据或者事件、访问历史数据和事件。读和写 操作是客户端从服务器地址空间的从一个或多个节点，读取或者写入一个或多个 属性的过程。通常情况下只有变量的 Value 属性可以写入。发布订阅的过程（翁 自觉和谢斌红，2014）是 OPC UA 客户端向服务器端发送订阅请求并等时间间隔 的刷新等待消息的返回，OPC UA 服务器端在收到客户端发来的订阅请求后向 OPC UA 客户端发送请求响应，创建监测项并返回相应的数据的过程。通过对话 （Session）的形式来创建一个订阅，创建订阅过程如下图 4.11 所示。
图 4.11 OPC UA 客户端的订阅过程 Figure 4.11 The subscription process for the OPC UA client
4.3.2 OPC UA 数据采集 将 OPC UA 协议运用于车间中的原理是将 OPC UA 服务器嵌入到车间的各
类底层生产设备中，将各类数控系统所采集的数据对应映射到 OPC UA 服务器
36

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
地址空间中，在 OPC UA 的客户端与服务器端连接后，开始数据的通信。 采用 OPC UA 架构进行数据采集，具体步骤如下所示： 步骤一：查找服务器 OPC UA 客户端首先需要与发现服务器建立连接，然后通过发现服务器获取
已注册的 OPC UA 服务器列表，进而实现数据通信（宁懿，2018）。具体过程如 图 4.12 所示。
图 4.12 查找服务器 Figure 4.12 Find the server
OPC UA 服务器通过调用 RegisterServer( )方法进行注册，当客户端与发现服 务器建立连接之后，客户端通过调用发现服务器提供的 FindServers( )方法查找所 有已注册的 OPC UA 服务器，从而获取所需的 OPC UA 服务器的相关描述信息， 包括连接过程中的所有信息等。最后，通过调用 GetEndpoints( )方法来获取服务 器的终端信息。这个终端信息包含了在 OPC UA 客户端和 OPC UA 服务器之间 建立连接所需要的 IP 地址和安全设置等信息，下图 4.13 是建立连接后的截图。
图 4.13 OPC UA 客户端/服务端建立连接 Figure 4.13 OPC UA Client/Server establish connection
37

基于数字孪生的车间作业仿真与监控系统的设计与实现
步骤二：浏览地址空间 地址空间是 OPC UA 服务端中具有多种含义的信息的集合。相比较传统 OPC 服务，OPC UA 对地址空间、服务和安全模型进行了统一，通过提供统一化的数 据接口来实现信息的统一化访问，提升了数据的通信速率。 OPC UA 的地址空间是由服务器内部的一些节点组成，这些节点也被称为地 址空间的基本单元（于旭冉，2019），地址空间内的数据通过这些节点来进行表 示，且 OPC UA 的节点有多种类型，不同类型的节点除了拥有一些通用属性外， 还具有一些有类型决定的属性。比较重要的节点类型有三种，分别是：对象节点、 变量节点和方法节点。
图 4.14 基本节点的类别和通用属性 Figure 4.14 Categories and common attributes for base nodes
地址空间中的对象类型的节点管理对象本身以及其包含的变量、方法及绑定 的事件。OPC UA 客户端可以通过读取和订阅的方式来获得 OPC UA 服务器端地 址空间中的对象节点的变量值。变量类型的节点用来存储 OPC UA 服务端获取 到的车间设备的底层信息。地址空间中变量节点的 Value 值可以被 OPC UA 客户 端进行读取或者修改，也可以订阅变量节点的数据变化进行监控。方法节点由 OPC UA 服务器端进行配置，包括客户端输入参数的设置及返回的输出结果的形 式，一般为简单的数据处理。
车间设备或者传感器产生的数据以节点的形式绑定在服务端的地址空间中， 每个节点对象代表一个数据项，如下图 4.15 所示。OPC UA 客户端通过浏览和读 取、订阅的方式来访问车间设备、传感器等的地址空间获取数据。OPC UA 客户 端然后将所得数据存入数据库中，为虚拟模型的实时映射提供条件。
38

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现

图 4.15 某数控设备在 OPC UA 地址空间中的数据

Figure 4.15 Data of a numerical control device in the OPC UA address space

OPC UA 客户端使用 Browse 服务向 OPC UA 服务端提交初始节点的 NodeId 和过滤条件，在服务端的地址空间中查找所有节点列表。

客户端在获取到节点列表之后，以 nodesToRead 作为输入参数，使用 Read

服务从地址空间中读取要访问的节点的属性值。通过 updateAttributeList( )函数显

示读取结果。

步骤三：订阅数据

数据实时获取的实现依靠的是 OPC UA 通过发布/订阅的模式来周期性的获

取数据。首先 OPC UA 客户端初始化一个订阅服务，创建监控项。然后 OPC UA

服务端对监控项进行等间隔采样并将数据返回给 OPC UA 客户端（S. Hensel 等， 2016）。
订 阅 实 现 主 要 依 靠 CreateSubscription 、 Publish 、 DeleteSubscription 、 CreateMonitoredItems、DeleteMonitoredItems、ModifyMonitoredItems 方法，如表

4.1 所示。

表 4.1 发布订阅服务相关函数

Table 4.1 Functions related to publishing and subscribing services

函数

函数意义

CreateSubscription( )

新建订阅项

Publish( )

发布订阅项

39

基于数字孪生的车间作业仿真与监控系统的设计与实现

续表 4.1

函数

函数意义

DeleteSubscription( )

删除订阅项

CreateMonitoredItems( )

新建监控项

ModifyMonitoredItems( )

修改监控项

DeleteMonitoredItems( )

删除监控项

使用 CreateSubscription( )新建订阅项时，可以设置发布订阅间隔、修改发布

间隔、请求使用期限数、修改使用期限数等。使用 CreateMonitoredItems( )新建监

控项时，需要指定返回的结果列表。创建订阅项后的打印信息如下图 4.16 所示。

图 4.16 创建监控项 Figure 4.16 Create a monitor item
4.3.3 OPC UA 数据传输 要想实现模型的同步映射，实现数据的实时传输是解决问题的关键所在。因
为车间数据量比较多，本文允许存在一定延迟的情况下，尽量实现车间设备的运 动状态与虚拟场景中设备的运动是一致的。在 OPC UA 客户端获得数据后，通过 C#脚本进行基于 TCP 协议的 Socket 通信（赵晓松，2017），将 OPC UA 获取到 的数据发布到 Unity 中。Socket 原理图如图 4.17 所示。另外还将 OPC UA 客户 端获取到的数据存储到数据库中，方便对数据进行分析和管理以及系统仿真相关 的其他操作。
40

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
图 4.17 Socket 通信原理 Figure 4.17 Socket communication principle
首先在服务器端创建 Socket 套接字，绑定 IP 地址和端口号，设置套接字为 监听模式。同时客户端也创建 Socket 套接字并与服务端建立连接。服务端启动 监听后等待客户端请求连接。当客户端发送数据后，服务端进行接收。服务端将 处理好的数据发送给客户端，客户端接受服务端返回的数据。当不再需要监听客 户端时，服务端关闭监听，客户端断开与服务端的连接，释放 Socket 资源（汤海 群，2020）。在 Unity3D 中有对 Socket 直接封装好的接口，可以直接使用该接口 来实现网络编程，操作简单，降低了开发者进行网络编程的难度。系统运行中采 集的某数控系统上的部分数据如下图 4.18 所示。
图 4.18 数控系统某时刻采集的数据 Figure 4.18 Data collected at a time
41

基于数字孪生的车间作业仿真与监控系统的设计与实现
图 4.19 数控系统数据字段名称 Figure 4.19 Data field names of CNC system
4.4 系统服务的实现 4.4.1 车间作业仿真
数字化、虚拟化的车间是对实体车间中的要素、行为和规则三元素建模，得 到映射的几何模型、行为模型和规则模型，从而能够对实体车间高度真实的仿真 和模拟。采用仿真技术，完成孪生数据驱动下车间全维度仿真。本文中，对车间 作业的仿真主要体现在以下三个方面：对生产过程的仿真、对生产工艺的仿真以 及对设备布局的仿真。
图 4.20 车间作业仿真系统 Figure 4.20 Workshop Job Simulation System
对生产过程的仿真体现在车间中核心装配设备的运动仿真，车间中的核心装
42

第 4 章 基于数字孪生的车间作业仿真与监控系统的实现
配设备主要有 AGV 小车、机器人、数控设备等。对于运动轨迹可预先设置的装 备提前设置运动路线，对于运动轨迹实时变化的设备通过数据库或者 Socket 通 信获取数据。
对生产工艺的仿真体现在对工艺数据库资源的支持方面。通过连接工艺数据 库获取资源信息，形成车间数字孪生数据模型和工艺信息全维度数据库。工艺数 据库信息包括车间设备类、工件类、人员类、环境类、车间布局类、设备健康模 型类、工件质检模型类、生产模型类等。仿真系统和工艺数据库连接起来，将数 据库中的设备数据和模型信息加载到仿真系统中。数据库中的资源按照制造方法 被分为树形结构，从各级子节点中可以选择所属的生产设备资源。
对设备布局的仿真体现在采用有向图拓扑结构描述车间各设备和设施的位 置，采用实体几何模型的动态加载技术，实现标准三维模型文件的动态加载，实 现自定义车间布局和仿真优化。
4.4.2 机械臂的运动仿真 系统服务中仿真功能是通过孪生数据驱动实现的。本节主要介绍车间中机械
臂的运动仿真。本文车间中的机械臂是六自由度的机械臂，在仿真过程中通过 OPC UA 协议采集真实设备中各轴的参数，驱动虚拟场景中机械臂的运动并做出 与真实场景中相同的动作（王磊，2021）。
表 4.2 机械臂的部分参数 Table 4.2 Partial parameters of the manipulator { "deviceToken" : "1100", "request" : { "metadata" : { "Axis1" : "71.88175", "Axis2" : "-0.009213737", ...... } } }
本节以六自由度的机械臂仿真对象为例，其结构图如下图 4.21 所示。
43

基于数字孪生的车间作业仿真与监控系统的设计与实现

图 4.21 六自由度机械臂结构图 Figure 4.21 Structure diagram of 6-
DOF manipulato

图 4.22 虚拟场景中运动的机械臂 Figure 4.22 Moving robotic arm in
virtual scene

4.5 本章小结 本章首先对系统的实现流程进行介绍，实现系统的搭建首先要完成虚拟模型
的建立，实现数据的采集，通过数据驱动模型的运转并完成其他的系统功能。然 后对系统实现的关键部分进行介绍，分别从虚拟模型的搭建、数据的采集和传输 方面分别介绍具体的实现方法。虚拟模型的搭建包括分析并确定建模方案、建立 与真实车间一致的虚拟车间的几何模型、搭建虚拟车间的环境要素、通过 C#脚 本实现基于真实物理模型的数据的虚拟模型的驱动。数据的采集和传输方面介绍 了 OPC UA 的数据架构，数据的采集步骤和传输方法。采用基于 TCP 协议的 Socket 通信达到协同的目的。

44

第 5 章 实验与测试
第5章 实验与测试
5.1 实验环境的搭建 5.1.1 实验环境要求
本系统的运行设备配置建议 CPU i3 以上、内存 4GB 以上、硬盘 500G、百 兆网口 1 个、COM 串口 1 个、USB 串口 1 个、GTX1060 以上的显卡、window10 的操作系统、MySql 数据库。 5.1.2 实验设备要求
本系统中的设备主要包括各类数控设备和数据采集设备。数控系统包括：需 要西门子 840Dsl、发那科 0i-Mate-TD、蓝天 GJ430、华中 818D 和广数 988TD 数 控系统。数据采集设备包括：无线温度采集器、物联集中器、NI-9232 采集卡、 3 轴振动传感器和 cDAQ-9185 机箱。 5.2 系统功能测试
前面章节对系统的功能进行了设计与实现。在本节完成对系统功能的测试。 在功能测试前，先在测试用的 PC 机上安装本系统的可执行文件。并进行系统参 数配置，参数配置如下表 5.1 所示。
45

基于数字孪生的车间作业仿真与监控系统的设计与实现
表 5.1 系统运行前的参数配置 Table 5.1 Parameter configuration before system operation 参数配置 { "historydata":"http://192.168.93.43:8080/gdtms/dcmt/th/bytrid?trid=TR47506EAAD0AD4 B81", "configdataload":"http://192.168.93.133:8080/dcmt/ci/by?datacode=", "configdatasave":"http://192.168.93.133:8080/dcmt/ci/edit", "SorC":"C", "IP":"192.168.93.155", // 数控系统采集与测试系统提供的 Socket 服务地址 "Port":"8007" // 数控系统采集与测试系统提供的 Socket 服务端口 }
双击系统的可执行文件图标，便可打开车间作业仿真与监控系统。主页面如 下图 5.1 所示。系统的主页面主要分为三个区域，分别是功能菜单栏、功能操作 栏和主场景页面。主场景显示整个车间场景和数据，功能操作栏实现的是配合功 能菜单栏选择管理的功能，功能菜单栏可以选择各功能模块，包括：系统模块、 设备管理模块、视图模块、分析模块、可视化模块、设置模块和工具模块。
图 5.1 系统主页面 Figure 5.1 Main page of the system
其中设备管理模块可以查看设备的运行状态，包括开机、关机、运行、暂停、 故障等状态。点击“设备”，显示窗口如下图 5.2 所示。单击车床、AGV、机器臂、
46

第 5 章 实验与测试
控制器和加工中心五类设备按键，分别显示不同类型的设备列表并且用不同颜色 区分设备的运行状态。
图 5.2 设备管理功能页面 Figure 5.2 Device Management Function Page
设备管理模块可以快速查看设备的主要运行和工艺参数。将鼠标悬浮放在设 备列表中任何一个设备名字上面，功能操作区域下方便会显示该设备的运行和工 艺参数信息。设备的运行和工艺参数主要包括主轴转速、倍率、运行模式和加工 程序。此功能可以实现车间管理人员对车间设备运行状况的监控。
设备管理模块还可以对系统单个设备查看，实现设备在车间中的快速定位。 系统界面左侧功能操作区域显示五类设备，分别是：车床、AGV、机器臂、控制 器和加工中心，单击任一个按键，下方显示车间中存在的设备列表。单击其中一 个设备名，即可在场景中定位到此设备处，如图 5.3 所示。
图 5.3 虚拟场景中的数控车床 Figure 5.3 CNC machine tool in virtual scene
视图模块提供多种监控视角，包括第一人称、自由视角和自动浏览视角。单
47

基于数字孪生的车间作业仿真与监控系统的设计与实现
击“视图”按键，进入视图模式，如下图 5.4 所示。
图 5.4 视图功能页面 Figure 5.4 page of view function
第一人称视角是第一人称视图模式下的车间漫游，使用者以第一人称视角， 使用键盘按键操作方向，在车间中可以自由漫游，可以使用 W、A、D、S 按键 操作漫游。自由视角功能是实现鼠标操作下，自由位置和角度的浏览车间场景。 选择自由视角模式，可以使用鼠标操作场景的自由变化。自动浏览功能是系统安 装车间的部件，在核心的区域自动的漫游，不需要用户操作就可以循环的对车间 进行巡视。重置视角的功能是当场景沙盘移动的位置已经不可在窗口中观察到， 点击重置视角用将场景恢复移动到初始位置处。
上云可视化模块实现了车间设备上云互联拓扑结构的可视化展示的功能，使 用特殊的效果展示了各设备间的连接情况。单击可视化模块，进入拓扑展示界面, 如下图 5.5 所示。
图 5.5 拓扑展示界面 Figure 5.5 Topology display interface
环境感知实现了车间内部署的振动和温度传感器的数据采集和展示。单击环
48

第 5 章 实验与测试
境感知，在左侧功能操作区域内，列出了所有传感器的信息。用不同颜色标注目 前传感器的数值情况，蓝色到红色表示由高到低。当传感器的值实时在变化时， 列表中对应传感器名字的颜色也随之变化。直接在场景中定位所选中的传感器所 在的位置，即找到传感器所在的设备。单击传感器名称即可定位到该设备处。进 入环境感知查看界面，如下图 5.6 所示。

图 5.6 环境感知界面 Figure 5.6 Environment perception interface
点击温度传感器 1，如下图 5.7 所示。

图 5.7 温度传感器

图 5.8 数控系统的切削仿真

Figure 5.7 Temperature sensor

Figure 5.8 Cutting simulation of

CNC system

当系统的配置文件参数设置正确，场景中的数控系统会实时完成切削仿真。

车间作业仿真如上图 5.8 所示。

5.3 生产过程仿真测试 生产过程仿真测试是在虚拟模型中对真实生产过程的模拟或者给定条件下
生产过程的模拟。在虚拟模型中再现实际生产流程中设备以及生产逻辑顺序。生
49

基于数字孪生的车间作业仿真与监控系统的设计与实现

产过程仿真可以在实际生产开始前预先判断生产的可执行性，降低后续的修改生

产计划的成本，或为后续的生产计划的调整提供依据。

在本次仿真测试中，假设该车间的生产线生产 A 产品和 B 产品，每个产品

都需要经过 5 道工序，不同产品各个工序的加工时长如下表 5.2 所示。

表 5.2 各个工序的加工时长（minutes）

Table 5.2 Processing time of each process (minutes)

工序 1 工序 2 工序 3 工序 4 工序 5

A 产品

4

3

4

5

3

B 产品

3

5

3

2

4

若打算用同一条生产线生产 1500 件 A 产品，1000 件 B 产品，在车间每日

工时 8 小时的情况下，能否在 22 天内完成加工并交付两种产品。在仿真测试时

需要在设备程序中设置产品的加工时间和生产节拍，传输加工数据到虚拟系统中，

驱动虚拟系统的运行。在虚拟系统中可以观察看到设备的工作时长、当前完成数

量、生产效率、剩余产品数量以及产品加工工序的步骤以及半成品的流向。在虚

拟系统中可以观察的设备相关的数据如下图 5.9 所示。

图 5.9 生产数据 Figure 5.9 Production data
通过虚拟系统仿真计算，完成上述目标大约需要 24 天才能完成加工任务， 此时各个设备的加工率和空闲率如下表 5.3 所示。考虑到无法在规定时间内完成 任务，于是决定考虑修改生产计划。在不改变当前设备数量的情况下，考虑改变 工时，经过再次的系统仿真运算，可以计算出若要完成当前生产计划，则需要一 天工作 8.8 个小时。
50

第 5 章 实验与测试

表 5.3 设备加工率和空闲率

Table 5.3 Equipment processing rate and idle rate

设备加工率 设备空闲率

工序 1

78.17%

21.83%

工序 2

82.51%

17.49%

工序 3

78.17%

21.83%

工序 4

82.51%

17.49%

工序 5

73.82%

26.18%

5.4 系统性能测试 虚拟监控系统在运行中必须有良好的性能表现，以防止在有持续大量的数据
读取操作时系统出现延迟、卡顿甚至崩掉等恶劣事故的发生。通过验证虚拟监控 系统的性能在正常或者特定环境和系统条件下使用是否还能满足性能指标来进 行系统的性能测试。本文在车间作业仿真与监控系统客户端运行过程中对 CPU、 GPU 的性能以及电脑内存占用率进行了测试。对于 CPU 占用率，一般通过标准 为小于 90%；对于内存占用率，一般通过标准为小于 80%。在本文中，使用电脑 自带的资源管理器进行车间作业仿真与监控系统客户端的性能测试并分别在不 同运行场景下进行测试，性能测试结果如图 5.10 所示。

120.00% 100.00% 80.00% 60.00% 40.00% 20.00%
0.00%

系统性能测试

开机后

正常运行 系统报警时 演示模式 实时模式

CPU

GPU

内存

图 5.10 性能测试 Figure 5.9 Performance test
对虚拟监控系统客户端进行了整体性能测试，测试用的计算机的配置如下： 系统类型为 64 位基于 x64 的处理器，内存大小为 12GB，CPU 为 Intel Core i5-

51

基于数字孪生的车间作业仿真与监控系统的设计与实现
4200M@2.5GHz，显卡为 Inter(R) HD Graphics 4600 和 GeForce 820M，执行文件 大小为 640K。由图 5.10 可以看出，在不同的测试场景下内存和 CPU 的占用率 的变化不是很大，但是 GPU 的占用率差距较大，因为在某些场景下会需要进行 更多的渲染操作，涉及到大量的运算，比如报警或是实时处理模式下的动画渲染， 所以 GPU 的占用率差距比较大。按均值计算，虚拟监控系统的 CPU 利用率平均 值为 20%，低于设定的 90%的最高值。系统的内存占用情况是 36%，处于可接 受的程度。由于车间作业仿真与监控系统较为复杂，虽然测试期间 GPU 占用率 的峰值有时会达到 90%多，但平均值大约为 73%，小于 85%的测试要求。综上 所述，虚拟监控系统的运行过程中对计算机资源的使用情况整体不高，因此运行 本系统的计算机不需要非常高的硬件水平，普通配置的电脑即可。 5.5 本章小结
本章完成对系统的测试。首先分别从实验环境和设备环境方面介绍了实现环 境的要求，包括进行测试的电脑配置、实验设备型号、以及参数配置等。然后分 别从功能测试和性能测试两方面对系统进行测试。通过功能测试完成对系统服务 的测试，体现了系统功能的完整性和可视化。通过性能测试完成对系统性能的测 试，各项测试数据均合格，表明了本系统对测试机的性能要求不是很严格。
52

第 6 章 总结与展望
第6章 总结与展望
6.1 工作总结 数字孪生技术是实现物理信息融合的有效手段。根据国家战略计划的制定也
可看出数字孪生技术的重要性。本文是对数字孪生技术在车间作业仿真和监控方 面的探索，一定程度上为车间生产管理的发展提供一些思考。
本文的主要研究工作如下： （1）本文基于数字孪生对车间作业仿真与监控系统进行设计与实现，对系 统的相关技术进行理论研究。在理论研究后分析当前车间作业仿真与监控存在的 问题，并根据此提出了系统的设计原则和实现目标。根据功能将本文系统划分为 的数据采集模块、虚拟系统模块、系统服务模块，并分别进行设计。 （2）针对系统的实现，首先要搭建虚拟模型，通过 3dMax、Unity3D 完成虚 拟模型的搭建工作。在建模过程中，首先对各个子模块进行分层次的建模，然后 将模型组合起来进行优化，减少顶点和片面的数量，在不影响效果的基础下降低 模型的质量。其次是实现数据的实时采集。先对数据进行分类，确定需要进行实 时采集的数据，通过 OPC UA 架构实现数据的实时获取。然后，构建数据库，通 过 C#脚本实现实时数据驱动完成模型的运转和其他的系统功能。 （3）针对系统的测试，首先分别从实验环境和设备环境方面介绍了实现环 境的要求，包括测试机的的配置、实验设备型号、以及参数配置等。针对传统的 监控系统，可视化性能差存在监控死角的问题，通过 Unity3D 建立可视化的车间 模型，提供多视角视巡的方式进行监控。通过功能测试完成对系统服务的测试， 体现了系统功能的完整性和可视化。通过性能测试完成对系统性能的检验，验证 了车间作业仿真与监控系统满足设计需求。
6.2 展望 本文虽然已经完成了基于数字孪生的车间作业仿真与监控系统的设计与实
现的工作，但是在本课题中仍然存在可以进一步优化和改进的地方实现数字孪生
53

基于数字孪生的车间作业仿真与监控系统的设计与实现
在车间作业仿真与监控方面的应用，经研究后本课题还可以在下面几个方面多加 重视：
（1）当前系统只是对车间生产作业的仿真，真实车间工作还包括设备检修 等其他环节，后续可以完善更多的系统功能。系统中的数据采集部分还可以添加 更多类型的传感器，从更全面的角度了解生产中的设备状态。在虚拟系统搭建方 面，可以考虑其他的优化方法对模型进行质量更好的优化处理。
（2）本文中对数据的处理采用的都是比较简单的方法，具有一定的局限性。 比如通过单一指标来判断系统故障的可能性，会与实际情况误差比较大的情况。 如果采用多特征融合的预测方法结果会更加准确。因此，需要去了解更多的物理 信息融合的其他方法，采用深度学习或者机器学习的方法进行系统预警功能的开 发。
（3）在数据处理方面，可以采用逻辑回归等其他方法进行数据的优化处理， 除去冗余数据，减少垃圾数据对系统功能的影响。当前车间设备数量较少，随着 车间设备数量的增加，系统可能面临有海量数据需要存储和处理的问题，实时性 会存在较大问题。可以采用 5G 网络技术，在高速的网络传输下，数据的传输性 能应该会有很大的提高。
54

参考文献
参考文献
工业互联网:打破智慧与机器的边界[J].中国经济报告,2015(08):70-73. 河东.工业 4.0 时代的展望及我国的应对举措——读《工业 4.0:即将来袭的第四次工业革命》
[J].中国高新区,2015(06):164-166. 张蓓.英国工业 2050 战略重点[N]. 学习时报,2016-02-15(002). 郭朝先,王宏霞.中国制造业发展与“中国制造 2025”规划[J]. 经济研究参考, 2015(31):3-13. 应怀樵,沈松,李旭杰,等.“云智慧仪器”结合“互联网+”和“工业 4.0”、CPS 的发展趋势,是面向
“中国制造 2025”的典型代表[J].国外电子测量技术,2016,35(01):1-6. 中国科学技术协会.中国科协智能制造学会联合体发布 “世界智能制造十大科技进展”、“中国
智能制造十大科技进展”[EB/OL].(2017-12-11).https://www.cast.org.cn/art/2017/12/11/art_ 582_39810.html. 中华人民共和国国家发展和改革委员会.中央网信办印发《关于推进“上云用数赋智”行动培 育新经济发展实施方案》的通知:发改高技[2020]552 号[EB/OL].(2020-04-10).https://ww w.ndrc.gov.cn/xwdt/ztzl/fkyqfgwzxdzt/fkgjdt/fgfc/202004/t20200410_1225542_ext.html. 陶飞,刘蔚然,刘检华,等.数字孪生及其应用探索[J].计算机集成制造系统,2018,24(01):1-18. 陶飞,张萌,程江峰,等.数字孪生车间——一种未来车间运行新模式[J].计算机集成制造系 统,2017,23(01):1-9. 陶 飞 , 刘 蔚 然 , 张 萌 , 等 . 数 字 孪 生 五 维 模 型 及 十 大 领 域 应 用 [J]. 计 算 机 集 成 制 造 系 统,2019,25(01):1-18. 陶飞,马昕,胡天亮,等.数字孪生标准体系[J].计算机集成制造系统,2019,25(10):2405-2418. 秦 晓 珠 , 张 兴 旺 . 数 字 孪 生 技 术 在 物 质 文 化 遗 产 数 字 化 建 设 中 的 应 用 [J]. 情 报 资 料 工 作,2018(02):103-111. 夏玲,姜媛媛,张杰,等.基于数字孪生的 Buck 电路故障诊断方法[J/OL].工矿自动化:1-6[202103-18].https://doi.org/10.13272/j.issn.1671-251x.2020070063. 王健,杨闯,闫宁宁.面向 B5G 和 6G 通信的数字孪生信道研究[J/OL].电波科学学报:1-8[202103-18].http://kns.cnki.net/kcms/detail/41.1185.tn.20210309.1602.003.html.
55

基于数字孪生的车间作业仿真与监控系统的设计与实现
张 冰 , 李 欣 , 万 欣 欣 . 从 数 字 孪 生 到 数 字 工 程 建 模 仿 真 迈 入 新 时 代 [J]. 系 统 仿 真 学 报,2019,31(03):369-376.
周瑜,刘春成.雄安新区建设数字孪生城市的逻辑与创新[J].城市发展研究,2018,25(10):60-67. 李浩,陶飞,王昊琪,等.基于数字孪生的复杂产品设计制造一体化开发框架与关键技术[J].计算
机集成制造系统,2019,25(06):1320-1336. 王峻峰,张玉帆,邵瑶琪,等.面向生产性能数字孪生的仿真数据映射研究[J/OL].系统仿真学
报:1-7[2021-03-18].http://kns.cnki.net/kcms/detail/11.3092.V.20210104.1716.014.html. 张林鍹,陈佳宁,刘文正. 一种基于 HoloLens 的智能装配生产线仿真方法[P]. 北京市：
CN110221583A,2019-09-10. 郑 成 军 , 姜 莉 莉 . 离 散 型 制 造 车 间 作 业 计 划 的 虚 拟 可 视 化 仿 真 研 究 [J]. 机 械 管 理 开
发,2012(03):28-30. 邓啸尘,周宏,杨振,等.基于 Plant Simulation 的船厂平直车间作业仿真与优化[J].船舶工
程,2020,42(03):147-151. 于 勇 , 范 胜 廷 , 彭 关 伟 , 等 . 数 字 孪 生 模 型 在 产 品 构 型 管 理 中 应 用 探 讨 [J]. 航 空 制 造 技
术,2017(07):41-45. 刘星.跨平台交互 OPC UA,助推智能制造发展进程[J].电气技术,2017(09):4. 彭人杰,段华琼.基于 unity 实现的半兰伯特光照模型[J].电脑知识与技术,2020,16(14):112-
113+116. 王磊,钱英军,黄浩.基于 Unity3D 的机器人物料搬运 VR 仿真系统开发[J].长江信息通
信,2021,34(01):18-20. 王帅,郭锐锋,王鸿亮,等.五轴加工复杂曲面的隐函数碰撞检测方法[J].小型微型计算机系
统,2017,38(09):2171-2176. 孙亮,马江,阮晓钢.六自由度机械臂轨迹规划与仿真研究[J].控制工程,2010,17(03):388-392. 刘丹,赵艳领,谢素芬.基于 OPC UA 的数字化车间互联网络架构及 OPC UA 开发实现[J].中国
仪器仪表,2017(10):39-44. 王民,曹鹏军,宋铠钰,等.基于 OPC UA 的数控机床制造数字化车间信息交互模型[J].北京工业
大学学报,2018,44(07):1040-1046. 于旭冉.基于 OPC UA 的工控信息化数据网关关键技术的研究与实现[D].北京邮电大学,2019.
56

参考文献
翁 自 觉 , 谢 斌 红 . 基 于 MODBUS 协 议 的 OPC UA 服 务 器 的 设 计 [J]. 计 算 机 应 用 与 软 件,2014,31(02):89-92+131.
赵晓松.基于 Untiy3D 的可视化虚拟仿真实验平台的设计与开发[D].西安电子科技大学,2017. 汤海群.基于 Unity3D 的电动汽车虚拟协同与增强现实培训系统设计与实现[D].华东交通大
学,2020. 张新生.基于数字孪生的车间管控系统的设计与实现[D].郑州大学,2018. 宁懿.支持 OPC UA 功能的工业无线传感器网络设计与实现[D].北京交通大学,2018. PANETTA K. Top 10 strategic technology trends for 2017:digital twins[EB/OL].(2016-10-18).
http://www. gartner. com/smarterwithgartner/gartners-top-10-technology-trends-2017/． PANETTA K. Top 10 strategic technology trends for 2018:digital twins[EB/OL].(2017-10-03).
https://www. gartner. com/smarterwithgartner/gartner-top-10-strategic-technology-trends-for2018/． PANETTA K. Top 10 strategic technology trends for 2019:digital twins[EB/OL].(2018-10-15). https://www. gartner. com/smarterwithgartner/gartner-top-10-strategic-technology-trends-for2019/. GRIEVES M W. Product lifecycle management: the new paradigm for enterprises[J]. International Journal of Product Development,2005,2(1-2):71-84. Glaessgen E, Stargel D. The Digital Twin Paradigm for Future NASA and U.S. Air Force Vehicles[C]// Aiaa/asme/asce/ahs/asc Structures, Structural Dynamics & Materials Conference Aiaa/asme/ahs Adaptive Structures Conference Aiaa. 2012. TAO F, CHENG J, QI Q, et al. Digital twin-driven product design, manufacturing and service with big data[J].The International Journal of Advanced Manufacturing Technology, 2018, 94 (9/10/11/12) :3563-3576. Young Joo Song, Jong Gye Shin, Jong Hun Woo. Research on a simulation-based ship production support system for middle-sized shipbuilding companies[J]. International Journal of Naval Architecture and Ocean Engineering, 2009, 1(2) : 70-77. GRIEVES M, VICKERS J. Digital twin: mitigating unpredictable, undesirable emergent behavior in complex system[M]//Trans-disciplinary Perspectives on Complex Systems. Berlin,
57

基于数字孪生的车间作业仿真与监控系统的设计与实现
Germany: Springer-Verlag, 2017. Adolphs P, Bedenbender H, Dirzus D,et al. Status report-reference architecture model industrie
4.0(RAMI4.0)[C]//VDI-Verein Deutscher Ingenieure e V and ZVEI-German Electrical Manufacturers Association.Wuhan,2017. S. Hensel, M. Graube, L. Urbas, T. Heinzerling and M. Oppelt, Co-simulation with OPC UA,2016 IEEE 14th International Conference on Industrial Informatics (INDIN), Poitiers, France, 2016, pp. 20-25
58

致 谢
致 谢
时光如梭，为期三年的研究生生活弹指一挥间就要结束了。在毕业来临之际， 感谢我的导师王鸿亮一直以来的耐心指导和细心栽培。在科研道路上为我解答困 惑、指点迷津，帮助我找到学习的方向，使我对自己的未来有一个更明确的规划 和目标。除此之外，在疫情居家期间王老师也关心我们的学业，帮助我分析确定 了课题的研究方向，指导专业性的技术问题等等，在此表示真诚的感谢！王老师 认真的工作态度、渊博的学识和踏实的工作作风都给我留下了深刻的印象，王老 师将会是我一直学习的榜样！今后无论身在何处，师恩永难忘。
在过去的三年中，我们经历了不平凡的二零二一年。感谢自己在疫情居家期 间也有坚持学习，研究课题来源与相关技术等方面。感谢我的爸爸妈妈这么多年 来对我学业的支持。是他们的关心和疼爱，可以让我在求学路上没有后顾之忧， 专心学习并体会求学的快乐。
感谢我亲爱的室友们和同窗好友！感谢你们在我学习和生活方面给予我的帮 助，让我的生活变得更加丰富多彩，在平和的气氛中快乐的学习！感谢我的师兄 师弟在我科研路上的帮助，帮我分析问题，理清思路。凡是过往，皆为序章，凡 是未来，皆有可期。作为一名即将离开沈计所的学生，我将继续不忘初心，继续 保持前进！
2021 年 6 月
59

作者简历及攻读学位期间发表的学术论文与研究成果
作者简历及攻读学位期间发表的学术论文与研究成果
作者简历： 2014 年 9 月——2018 年 6 月，在大连工业大学信息科学与工程学院获得学
士学位。 2018 年 9 月——2021 年 6 月，在中国科学院沈阳计算技术研究所攻读硕士
学位。 已发表（或正式接受）的学术论文：
A multi-robot monitoring system based on digital twin [J]. The 10th International Conference of Information and Communication Technology (ICICT), 2020. 第一作者，已录用。
61

