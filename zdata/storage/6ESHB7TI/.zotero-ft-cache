密

级


：

保

密

期

限

：  

颂 士 学 位 论 文  

题

目

基于
：

区块链技术

的商

品 溯 源  

系 统 研 究 与 原 型 实 现  

学 号  ：

２ ０ １ ７ １ １ ０ ８ ９ ５  

姓名


：

张

皓

明

  

专业 ： 软 件 工 程  

导师 ： 漆 涛   

学

院


：

软

件

学

院

年 ２ ０ ２ ０

４ 月 １ 日  

中 国 ■ 北 京  

密

级

保
：

密

期

限

：

仰 耄 大 聲
硕 士 学 位 论文  

题 目 ： 基 于 区 块链技 术 的 商 品 溯 源 系 统 研 究 与   原 型 实 现  

学 号  ：

２ ０ １ ７ １ １ ０ ８ ９ ５  

姓名

张
：

皓

明  

专



业


：

软

件

工

程  

导师 ：漆 涛   
学院 ：软 件 学 院  

年 ２ ０ ２ ０

４ 月 １ 日

独 创 性 （ 或 创 新 性 ） 声 明

本 人 声 明 所 呈 交 的 论 文 是 本 人 在 导 师 指 导 下 进 行 的 研 究 工 作 及 取 得 的 研 宄   成 果 。 尽 我 所 知 ， 除 了 文 中 特 别 加 以 标 注 和 致 谢 中 所 罗 列 的 内 容 以 外 ， 论 文 中 不   包 含 其 他 人 己 经 发 表 或 撰 写 过 的 研 究 成 果 ， 也 不 包 含 为 获 得 北 京 邮 电 大 学 或 其 他 教 育 机 构 的 学 位 或 证 书 而 使 用 过 的 材 料 。 与 我 一 同 工 作 的 同 志 对 本 研 究 所 做 的 任   何 贡 献 均 己 在 论 文 中 作 了 明 确 的 说 明 并 表 示 了 谢 意 。  
申 请 学 位 论 文 与 资 料 若 有 不 实 之 处 ， 本 人 承 担 一 切 相 关 责 任 。  

本人签名 ：

Ａ 期 曰

：

２ － ？夕 、

十＇ ｊ

关 于 论 文 使 用 授 权 的 说 明  

本人完全 了 解北京邮 电大学有关 保 留 和使用 学位论文的规定 ，

即？ ．

研 宄 生 在

校 攻 读 学 位 期 间 论 文 工 作 的 知 识 产 权 单 位 属 北 京 邮 电 大 学 。 学 校 有 权 保 留 并 向 国  

家有关部 门 或机构送交论文 的 复 印件 和 磁盘 ，

允许学位论文被査阅 和借阅 ；

学 校  

可 以 公 布 学 位 论 文 的 全 部 或 部 分 内 容 ， 可 以 允 许 采 用 影 印 、 缩 印 或 其 它 复 制 手 段  

保 存 、 汇 编 学 位 论 文 。  

本 学 位 论 文 不 厲 于 保 密 范 ＿ ， 适 川 本 授 权 书 。  

＾ ＾  本 人 签 名 ： ５＾ 

期 卜〗

：

＾
１

导 师签 名 ：
，

 期 日

：

十  

基于 区块链技术 的 商 品 溯 源系统研究 与 原 型实 现  

摘 要  

频 发 的 食 品 安 全 、 商 品 假 冒 伪 劣 问 题 使 消 费 者 对 商 品 流 转 信 息  

的 关 注 度 日 益 提 升 ， 商 品 溯 源 系 统 作 为 商 品 质 量 的 保 障 之 一 ， 得 到

了 广 泛 的 关 注 和 应 用 。 商 品 溯 源 系 统 面 临 着 数 据 易 被 捏 造 篡 改 、 可  

信 度 低 的 问 题 。 使 用 区 块 链 技 术 能 够 保 障 商 品 溯 源 系 统 中 的 数 据 难

以 被 篡 改 。 如 何 将 区 块 链 技 术 与 商 品 溯 源 系 统 结 合 ， 在 保 障 数 据 安

全的 同 时尽量提高数据 查询速度 ，

减少冗余数据存储 ，

是 本 文 的 研  

究 点 。  

针 对 商 品 溯 源 系 统 中 存 在 的 数 据 易 被 篡 改 、 捏 造 的 问 题 ， 本 文  

使 用 等 技 术 和 框 Ｖ Ａ ＱＲ Ｍ Ｄ Ｂ  ｕ ｅ 、 Ｓ ｐ ｒ ｉ ｎ ｇ

ｏｏｔ 、 ＪＰ

、

ｃｏｄｅ 、

ｏｎｇｏ

Ｂ、

ｏ －

ｔｉ



架 ， 设 计 并 实 现 了 一 个 基 于 区 块 链 技 术 的 商 品 溯 源 原 型 系 统 。  

本 文 首 先 对 区 块 链 技 术 和 商 品 溯 源 系 统 等 研 究 背 景 和 相 关 技 术

进 行 了 简 单 介 绍 ， 随 后 针 对 商 品 溯 源 系 统 和 区 块 链 技 术 在 其 中 的 应

用 进 行 了 研 宄 。 文 中 对 传 统 商 品 溯 源 系 统 存 在 的 数 据 易 被 篡 改 的 问

题 及 如 何 通 过 引 入 区 块 链 技 术 解 决 这 一 问 题 进 行 了 分 析 ， 并 根 据 商

品 溯 源 场 景 的 需 要 ， 对 存 储 商 品 信 息 使 用 的 区 块 链 进 行 了 改 进 ， 设  

计 了 一 种 以 用 户 和 商 品 为 线 索 的 网 状 区 块 链 结 构 ， 相 比 典 型 的 链 式  

结 构 提 高 了 商 品 信 息 查 询 速 度 。 在 此 基 础 上 本 文 设 计 并 实 现 了 一 个

商 品 溯 源 原 型 系 统 。 文 中 对 原 型 系 统 进 行 了 需 求 分 析 ， 随 后 针 对 原  

型 系 统 的 用 户 管 理 、 商 品 信 息 管 理 、 商 品 属 性 管 理 、 区 块 链 等 模 块

进 行 了 概 要 设 计 和 详 细 设 计 ， 阐 述 了 各 模 块 的 逻 辑 流 程 和 实 现 方  

法 ，

并基于 需求分析和 设计对 原型 系统进 行 了 实现 。

最后 ，

本 文 介

绍 了 原 型 系 统 的 测 试 过 程 ， 展 示 了 针 对 主 要 功 能 的 测 试 用 例 和 测 试

结果 ，

并对工作 内 容和成果进行 了 总结 ，

分析 了 不足之处 ，

对 改 进

方 向 进 行 了 展 望 。

关 键 词 ： 溯 源 系 统 区 块 链 商 品 数 据 供 应 链 数 据 存 储

ＲＥ Ｓ Ｅ ＡＲＣ ＨＡＮＤＰＲＯ Ｔ Ｏ ＴＹＰ ＥＩＭ ＰＬＥ Ｍ Ｅ Ｎ ＴＡ ＴＩＯ Ｎ   Ｏ ＦＴＲＡ Ｃ ＥＡＢＩＬ ＩＴＹＳ Ｙ Ｓ Ｔ Ｅ ＭＦ ＯＲ  
Ｃ Ｏ Ｍ Ｍ Ｏ Ｄ ＩＴ ＹＢ Ａ Ｓ Ｅ ＤＯ ＮＢ Ｌ ＯＣ ＫＣ ＨＡＩＮ  

ＡＢ Ｓ ＴＲＡ Ｃ Ｔ  

Ｆ ｏ ｏ ｄ ｓ ａ ｆｅｔｙ ｉ ｓ ｓ ｕ ｅ ｓａ ｎ ｄ ｃ ｏ ｕ ｎ ｔ ｅ ｒｆｅ ｉ ｔ  ｇ ｏ ｏ ｄ ｓ ｈ ａｖ ｅ ｍ ａ ｄ ｅ  ｃ ｏ ｎ ｓ ｕ ｍ ｅ ｒ ｓ ｐ ａ ｙ

Ａ ｍ ｏ ｒ ｅ ａｎ ｄ ｍ ｏ ｒ ｅ  ａｔｔ ｅｎｔ ｉ ｏ ｎ ｔ ｏ  ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ ｄ ａｔ ａ ． 

ｓ  ｏ ｎ ｅ  ｏ ｆ  ｔｈ ｅ  ｇ ｕ ａｒ ａｎ ｔ ｅ ｅ ｓ  ｏ ｆ  

ｔ ｐ

ｒｏ

ｄｕ

ｃｔ 

ｑｕ

ａｌ

ｉ

ｙ ｔ ，

ｔｒａｃ

ｅ

ａｂ

ｉ

ｌ

ｉ

ｔｙｓｙ

ｓｔ

ｅ

ｍｈ

ａ

ｓｒｅ

ｃｅ

ｉ

ｖ

ｅ

ｄｗ

ｉ

ｄ

ｅ

ｓ

ｐ

ｒｅ

ａｄａ

ｅｎ ｔ ｉ ｏ ｎ ａｎ ｄ

Ｔ ａｐ ｐ ｌ ｉ ｃ ａｔ ｉ ｏ ｎ  ． ｒ ａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔｙ  ｓ ｙ ｓ ｔ ｅ ｍ ｓ  ｆｏ ｒ  ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ ｆａ ｃ ｅ  ｔｈ ｅ  ｐ ｒ ｏ ｂ ｌ ｅ ｍ  ｏ ｆ  ｄ ａｔ ａ

Ｕ ｆａ ｌ ｓ ｉ ｆｉ ｃ ａｔ ｉ ｏ ｎ ，  ａｎ ｄ  ｔｈ ｅ  ｃ ｒｅ ｄ ｉ ｂ ｉ ｌ ｉ ｔｙ  ｉ ｓ  ｌ ｏ ｗ． 

ｓ ｉ ｎ ｇ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  ｔ ｅ ｃ ｈｎ ｏ ｌ ｏ ｇｙ ｃ ａｎ

Ｔ ｅ ｎ ｓ ｕ ｒｅ  ｔ ｈ ａｔ  ｔｈ ｅ  ｄ ａｔ ａ ｉ ｎ  ｔｈ ｅ  ｓ ｙ ｓ ｔ ｅ ｍ  ｓ ａ ｆｅ ．  ｈ ｅ  ｆｏ ｃ ｕ ｓ  ｏ ｆ ｔ ｈ ｉ ｓ  ｐ ａｐ ｅ ｒ  ｉ ｓ  ｈ ｏ ｗ  ｔ ｏ

ｙ ｃ ｏ ｍ ｂ ｉ ｎ ｅ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  ｗ ｉ ｔｈ  ｔ ｒａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔ  ｓ ｙ ｓ ｔ ｅ ｍ  ｆｏ ｒ  ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ  ｔ ｏ  ｍ ｉ ｎ ｉ ｍ ｉ ｚ ｅ  

ｙ ｄ ａ ｔ ａ  ｓ ｔ ｏ ｒ ａ ｇ ｅ  ｗｈ ｉ ｌ ｅ  ｅ ｎ ｓ ｕ ｒｉ ｎ ｇ  ｄ ａｔ ａ  ｓ ｅ ｃ ｕ ｒｉ ｔ ．  

Ｖ Ａ Ｑ Ｒ Ｍ Ｄ Ｂ Ｔ ｈ ｉ ｓ ｐ ａｐ ｅ ｒ ｕ ｓ ｅ ｓ

Ｂ ｕ ｅ ，  Ｓ ｐ ｒ ｉ ｎ ｇ 

ｏ ｏｔ ，Ｊ Ｐ

，

ｃｏｄｅ ，

ｏｎｇｏ

，  ｔ － ｉ ｏ  ａｎ ｄ  

ｆ ｒ ｏ ｔ ｈ ｅ ｒ  ｔ ｅ ｃｈｎ ｏ ｌ ｏ ｇ ｉ ｅ ｓ  ａｎ ｄ ａｍ ｅｗ ｏ ｒｋ ｓ  ｔ ｏ ｄ ｅ ｓ ｉ ｇ ｎ  ａｎ ｄ ｉ ｍ ｐ ｌ ｅ ｍ ｅ ｎ ｔ  ａ ｐ ｒ ｏｔ ｏ ｔｙ ｐ ｅ  ｏ ｆ  

ｙ ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ  ｔ ｒａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔ

ｓ 

ｙ

ｓ

ｔ ｅ ｍ  ｆｏ

ｒｃ

ｏ

ｍ

ｍ

ｏ

ｄ

ｉ

ｔｙ

ｂ


ａｓ

ｅ

ｄｏ

ｎｂ

ｌ

ｏ

ｃｋ

ｃ

ｈ

ａｉ

ｎ

．  

Ａ ｔ ｆｉ ｒｓ ｔ ， ｔｈ ｅ ｐ ａｐ ｅ ｒ  ｂ ｒ ｉ ｅ ｆｌ ｙ ｉ ｎ ｔｒ ｏ ｄ ｕ ｃ ｅ ｓ  ｔｈ ｅ  ｒｅ ｓ ｅ ａｒ ｃ ｈ ｂ ａ ｃｋ ｇ ｒｏ ｕ ｎ ｄａｎ ｄ  

ｒｅ ｌ ａｔ ｅ ｄ ｔ ｅ ｃ ｈｎ ｏ ｌ ｏ ｇ ｉ ｅ ｓ  ｏ ｆ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  ｔ ｅ ｃ ｈｎ ｏ ｌ ｏ ｇ ｙ  ａ ｎ ｄ ｔ ｒ ａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔｙ  ｓ ｙ ｓ ｔ ｅ ｍ  ｆｏ ｒ

ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ，  ａｎ ｄ  ｔｈ ｅ ｎ  ａｎ ａ ｌ ｙ ｚ ｅ ｓ  ｔｈ ｅ  ａｐｐ ｌ ｉ ｃ ａｔ ｉ ｏｎ  ｏ ｆ ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ  ｔ ｒ ａｃ ｅ ａ ｂ ｉ ｌ ｉ ｔｙ

Ａ ｓ ｙ

ｓ

ｔｅ

ｍａｎ

ｄ

ｂ

ｌ

ｏ

ｃ

ｋ

ｃ

ｈ

ａｉ

ｎ

ｔｅ

ｃｈｎ

ｏ

ｌ

ｏ

ｇ

ｉ

ｅ

ｓｉｎ

 ｔｒａ ｃ

ｅ

ａｂ

ｉ

ｌ

ｉ

ｔｙ

ｓ 

ｙ

ｓ

ｔｅｍ

ｓ

．

ｉ ｍ ｉ ｎ ｇ  ａｔ  ｔｈ ｅ  

ｙ ｐ ｒ ｏ ｂ ｌ ｅ ｍ ｏ ｆ  ｄ ａｔ ａ  ｆｉ ｄ ｅ ｌ ｉ ｔｙ ｉ ｎ  ｔｈ ｅ ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ ｔｒ ａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔ  ｓ ｙ ｓ ｔ ｅ ｍ ｈ ，  ｔ ｉ ｓ  ｐ ａｐ ｅ ｒ

Ａ ｕ

ｓ

ｅ

ｓｂ

ｌ

ｏ

ｃ

ｋ

ｃｈ

ａｉ

ｎ

ｔｏｅｎ

ｓ

ｕｒｅｄ

ａｔ ａ ｓ ｔ

ｏｒａｇｅｓ

ｅ

ｃｕ

ｒｉ

ｙ ｔ

．



ｃ ｃ ｏ ｒｄ ｉ ｎ ｇ  ｔ ｏ ｔｈ ｅ  ｎ ｅ ｅ ｄ ｓ  ｏ ｆ  

Ｄ Ａ Ｇ ｔｈ

ｅｓ

ｃ

ｅ

ｎ

ａｒｉ

ｏ

ａ ， 



 ｂ ｌ ｏ ｃ ｋ  ｃ ｈ ａ ｉ ｎ  ｓ ｔｒｕ ｃ ｔ ｕｒ ｅ  ｗ ｉ ｔｈ  ｕ ｓ ｅ ｒ ｓ  ａｎ ｄ  ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔ ｉ ｅ ｓ  ａ ｓ

ｙ ｃ

ｌ

ｕ

ｅ

ｓ

ｉ

ｓ

ｄ

ｅ

ｓ

ｉ

ｇｎ

ｅ

ｄ

ｗｈ
，

ｉ

ｃ

ｈ

ｉ

ｍ

ｐ

ｒｏ

ｖ

ｅ

ｈ ｓ  ｔ

ｅｃ

ｏ

ｍｍ

ｏ

ｄ

ｉ

ｔｙ

ｉ 

ｎ

ｆｏ

ｒｍ

ａｔ

ｉ

ｏ

ｎ



ｑ

ｕ

ｅ

ｒ

 ｓ ｐ ｅ ｅ ｄ  

Ｏ ｃ ｏ ｍ ｐ ａｒｅ ｄ ｔ ｏ ｔｙ ｐ ｉ ｃ ａ ｌ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａｉ ｎ  ｓｔｒｕ ｃｔｕｒｅ ｓ ． 

ｎ  ｔｈ ｉ ｓ  ｂ ａ ｓ ｉ ｓ ，  ｔｈ ｉ ｓ  ａｒｔ ｉ ｃ ｌ ｅ  

ｄ

ｅ

ｓ

ｉ

ｇｎ

ｓａｎ

ｄｉ

ｍ

ｐ

ｌ

ｅ

ｍ

ｅｎｔ

ｓａｐ

ｒｏ

ｔｏ

ｔｙ

ｐ

ｅｓ

ｙ

ｓ

ｔｅ

ｍ ｆｏ

ｒｃ

ｏ

ｍ

ｍ

ｏ

ｄ

ｉ

ｔｙ

ｔｒａｃ

ｅ

ａｂ

ｉ

ｌ

ｉ

ｙ ｔ

．  

Ｔｈ

ｅ  ａｒｔ

ｉ

ｃ

ｌ

ｅ  ａｎ ａ ｌ

ｙ

ｚ

ｅ

ｈ ｓ  ｔ

ｅｒ

ｅ

ｑ

ｕ

ｉ

ｒｅｍ

ｅｎ ｔ ｓ  ｏ

ｆ ｔｈ 

ｅｐ

ｒｏ

ｔ

ｏ

ｔｙ

ｐ

ｅｓｙ

ｓｔｅ

ｍ

ｔｈ
，

ｅ

ｎ

ｏ

ｕｔ

ｌ

ｉ

ｎ

ｅ

ｓ

，  

ａｎ ｄ ｄ ｅ ｓ ｉ ｇｎ ｓ  ｔｈ ｅ  ｕ ｓ ｅ ｒ ｍ ａｎ ａ ｇ ｅ ｍ ｅｎ ｔ ，  ｐ ｒ ｏ ｄ ｕ ｃｔ  ｉ ｎ ｆｏ ｒｍ ａｔ ｉ ｏ ｎ  ｍ ａｎ ａｇ ｅ ｍ ｅ ｎ ｔ ，  

ｐ ｒ ｏ ｄ ｕ ｃ ｔ ｔ  ａ ｒ ｉ ｂ ｕ ｔ ｅ ｍ ａｎ ａｇ ｅ ｍ ｅｎ ｔ ， ａｎ ｄ ｂ ｌ ｏ ｃ ｋ ｃｈ ａｉ ｎ  ｍ ｏ ｄ ｕ ｌ ｅ ｓ  ｏ ｆ  ｔｈ ｅ ｐ ｒｏ ｔ ｏ ｔｙ ｐ ｅ   Ｔ ｓ ｙ ｓ ｔ ｅ ｍ  ． ｈ ｅｎ  ｔｈ ｅ ａｒｔ ｉ ｃ ｌ ｅｄ ｅ ｓ ｃ ｒ ｉ ｂ ｅ ｓ  ｔ ｈ ｅ ｌ ｏ ｇ ｉ ｃ ａ  ｌ ｆｌ ｏ ｗ  ａｎ ｄ  ｉ ｍ ｐ ｌ ｅ ｍ ｅ ｎ ｔａｔ ｉ ｏ ｎ

ｍ

ｅｔｈ

ｏ

ｄｏ

ｆｅ

ａｃｈｍｏ

ｄｕｌ

ｅ

Ｆ  ．

ｉｎ

ａｌ

ｙ ｈ ｌ

，ｔ

ｉ

ｓ  ａｒｔ ｉ ｃ

ｌ ｅｉｎｔｒｏ

ｄｕｃ

ｅ

ｓｔｈ

ｅｔ ｅ

ｓｔｐ

ｒｏ

ｃ

ｅ

ｓ

ｓｏ

ｆ  

ｔｈ

ｅ


ｐ

ｒ

ｏ

ｔ

ｏｔｙ

ｐ

ｅ

ｓｙ

ｓ

ｔ

ｅｍ

，



ｓ

ｈ

ｏ

ｗ

ｓ

ｔｈ

ｅｔ

ｅ

ｓｔ

ｃ

ａｓ

ｅ

ｓ

ａｎ

ｄ

ｔ

ｅ

ｓ

ｔ



ｒｅ

ｓ

ｕ

ｌ

ｔ

ｓ

 ｆｏ

ｒ

ｔｈ

ｅ

ｍ

ａ

ｉ

ｎ

    ｆｕ ｎ ｃ ｔ ｉ ｏｎ ｓ ，

ｓ ｕ ｍ ｍ ａｒ ｉ ｚ ｅ ｓｔｈ ｅｗ ｏ ｒｋ

ｃｏｎｔｅｎｔａｎ ｄ

ｒｅ ｓｕ ｌｔｓ ，

 ａｎ ａ ｌ ｙ ｚ ｅ ｓ ｔｈ ｅ  

ｆｉ ｄ ｅ

ｃ ｉ ｅ ｎ ｃ ｉ ｅ ｓ ，  ａｎ ｄ  ｌ ｏ ｏ ｋ ｓ  ｆｏ ｒｗ ａ ｒ ｄ  ｔ ｏ  ｔｈ ｅ  ｉ ｍ ｐ ｒ ｏ ｖ ｅ ｍ ｅ ｎ ｔ  ｄ ｉ ｒ ｅ ｃｔ ｉ ｏ ｎ ．  

ＫＥＹ Ｗ Ｏ ＲＤ 

Ｓ  ： ｔｒ ａｃ ｅ ａｂ ｉ ｌ ｉ ｔｙ  ｂ ｌ ｏ ｃｋ ｃ ｈ ａ ｉ ｎ  ｃ ｏ ｍ ｍ ｏ ｄ ｉ ｔｙ － ｄ ａｔａ  ｓ ｕ ｐ ｐ ｌ ｙ ｃ ｈ ａ ｉ ｎ ｓ

ｄ ａｔ ａ－ ｓ ｔ ｏ ｒ ａ ｇ ｅ  

目 录  

第 章 绪 论 一



１

课 题 背 景 研 意 义 １ ． １

与究



１

研 宄 现 状 ２ １ ．

 ２  

论 文 要 任 务 ３ １ ．

主

 ２  

课 题 内 容 ３ １ ．

１ ．

 ２  

本 人 承 担 的 作 ３ ２ １ ．

．

工

 ３  

论 文 结 构 ４ １ ．

组织

 ４  

第 二 章 相 关 技 术 介 绍  ５  

块 链 技 术 ２ １ ．

区

 ５

２Ｕ ．

区 块 链 技 术 概 述  ５  

块 链 关 键 技 术 ２ ２ １ ．

．

区

 ６  

商 品 标 签 ２ ２ ．

 ７  

关 开 发 技 术 相 ２ ． ３

 ８

本 章 小 结 ２ ４ ．

 ８

第 三 章 基 于 区 块 链 技 术 的 商 品 溯 源 系 统 分 析 与 研 究  ９  

３ ． １ 商 品 溯 源 系 统 结 构 分 析  ９  

传 统 商 溯 源 系 统 ３ ． １ ． １

品

 ９  

３ ２ １ ．

．

基于 区块链技术 的商 品溯源系 统

１ ０  

３ ３ １ ．

．

使 用 区 块 链 进 行 商 品 溯 源 面 临 的 问 题  １ ０  

３ ． ２ 针 对 商 品 溯 源 场 景 的 区 块 链 改 进 与 设 计  １ １

块 链 结 构 设 计 商 品 信 息 ３ ２ ．

．１

区

的 改进与



１ １  

２ ３ ２ ．

．

数据存储规则 的改进与设计

１ ４  

正 确 性 分 析 ２ ３ ．

３ ．



１ ５  

本 章 小 结 ３ ． ３



１ ５  

第 四 章 商 品 溯 源 原 型 系 统 需 求 分 析 与 概 要 设 计  １ ７  

４ ． １ 商 品 溯 源 系 统 业 务 场 景 分 析  １ ７  

统 求 分 析 ４ ２ 原 型 系 需 ．

 １ ８

型 统 功 能 性 求 ４ ２ ．

．１

原

系

需

 １ ９  

统 非 性 求 ４ ２ ２ 原 型 系

．

．

功能

需

 ２ ３  

４３ ．

原 型 系 统 整 体 结 构  ２ ４  

４４ ．

原型 系统功 能模块划 分

２ ６  

用 户 管 理 模 块 ４ ４ ．

．１

 ２ ７  

节 点 管 模 块 ４ ４ ２

．

．

理

 ２ ７  

商 信 息 管 模 块 ４ ４ ３

．

．

品

理

 ２ ７  

商 属 性 管 模 块 ４ ． ４ ． ４

品

理

 ２ ７  

块 链 辅 助 模 块 ４ ４ ５ 区

．

．

 ２ ８  

接 设 计 ４ ５

口

．

 ２ ８

控 制 层 接 ４ ５ ．

．１

口  ２ ８

业 务 逻 辑 层 接 ４ ２ ５ ．

＿

口  ３ ０  

数 据 持 久 化 层 接 ４ ５ ３ ．

．

口

３ １  

区 块 链 接 ４ ４ ５ ．

．

口  ３ ２  

数 据 库 设 计 ４ ６ ．

 ３ ３  

本 章 小 结 ４ ７ ．

 ３ ４  

第 五 章 商 品 溯 源 原 型 系 统 详 细 设 计 与 实 现  ３ ５

用 管 理 模 块 ５ １ ．

户

 ３ ５

用 户 注 册 ５ ． １ ． １

 ３ ５  

用 户 登 录 ５ ２ １ ．

．

 ３ ６  

用 户 权 限 控 制 ５ ３ １ ．

．

 ３ ７  

用 户 信 息 修 改 ５ ４ １ ．

．

 ３ ８  

节 管 模 块 ５ ． ２

点理

 ３ ８  

本 地 节 点 信 息 ５ ２ ．

．１

 ３ ８

节 点 信 息 管 理 ２ ２ ５ ．

．

 ３ ９  

模 块 ５ ． ３ 商 品 属 性 管 理

 ４ ０  

商 品 属 性 管 理 ５ ３ ．

１ ．

 ４ ０  

商 品 类 型 管 理 ２ ５ ３ ．

．

 ４ ２  

模 块 ５ ４ ．

商 品信息管理

 ４ ３  

商 品 信 息 查 询 ４ ５ ．

．１

 ４ ３

商 信 息 录 入 ４ ５ ．

２
．

品

 ４ ５

块 链 辅 模 块 区 ５ ． ５

助

 ４ ７  

数 据 查 询 ５ ５ ．

．１

 ４ ７  

数 据 录 入 ２ ５ ５ ．

．

 ４ ８  

加 密 工 具 ５ ５ ．

３ ．

 ５ ２  

通 信 工 具 ４ ５ ５ ．

．

 ５ ４  

数 据 库 设 计 ５ ６ ．

 ５ ６  

用 户 信 息 表 ６ ５ ．

．１

   ５ ６  

节 点 信 息 表 ６ ２ ５ ．

．

 ５ ６  

商 属 性 信 息 表 ５ ６ ３

．

．

品

 ５ ６  

商 类 型 信 息 表 ４ ５ ６ ．

．

品

 ５ ７  

商 类 型 属 性 联 系 表 ５ ６ ５

品

－

．

．

 ５ ７  

商 散 值 状 态 表 ６ ５ ６ ．

．

品列

 ５ ７  

商 品 息 块 记 录 表 ６ ５ ．

７ ．

ｆ目

 ５ ８

本 地 节 点 信 息 表 ６ ５ ．

８ ．

 ５ ８  

本 章 小 结 ５ ． ７

 ５ ８  

第 六 章 商 品 溯 源 原 型 系 统 的 测 试  ５ ９  

软 硬 件 环 境 ６ ． １

 ５ ９  

测 试 例 设 计 ６ ． ２

用

 ５ ９  

用 户 管 理 功 能 ６ ２ ．

．１

 ５ ９  

节 点 管 理 功 能 ６ ． ２ ． ２

 ６ ０  

商 品 信 息 管 理 功 能 ６ ２ ３

．

．



６ １

商 性 管 功 能 ６ ２ ４

．

．

品属

理

 ６ ３  

测 试 结 果 ６ ． ３

 ６ ５  

本 章 小 结 ６ ． ４

 ６ ８

第 七 章 结 语  ６ ９  

论 文 作 总 结 ７ ． １

工

 ６ ９  

题 与 展 望 问 ７ ２ ．

 ６ ９  

参考文献

７ １  

 ７ ４  
攻 读 学 位 期 间 发 表 的 学 术 论 文 目 录  ７ ５  

第一章 绪论



  

第 一 章 绪 论  

本 章 主 要 介 绍 论 文 的 研 究 背 景 和 研 究 内 容 ， 说 明 了 本 人 承 担 的 工 作 和 论 文 的 结 构 。  

１ ． １ 课 题 背 景 与 研 究 意 义

随 着 社 会 经 济 的 发 展 ， 人 们 的 收 入 和 生 活 水 平 不 断 提 高 ， 而 频 发 的 食 品 安 全  

问 题 、 商 品 假 冒 伪 劣 问 题 使 得 消 费 者 对 商 品 流 转 信 息 的 关 注 度 日 益 提 升 ， 消 费 者  

渴 望 获 得 及 时 、 可 信 、 充 足 的 商 品 信 息 来 保 障 他 们 的 利 益 ［ １ ］ 。 与 此 同 时 ， 供 应 商  

们 也 有 着 与 消 费 者 类 似 的 诉 求 。 经 济 的 发 展 、 经 营 规 模 的 扩 大 使 得 商 品 供 应 链 被  

逐渐拉长 ，

供应链的参与者 由少到多 ，

商

品

流

通

环

节

繁

多

２

［

］

，

供 应 链 上 信 息 的 流  

动 也 就 愈 发 难 以 控 制 。 消 费 者 与 供 应 商 的 需 求 殊 途 同 归 ， 他 们 都 希 望 能 够 有 效 地  

追 踪 商 品 流 转 状 况 、 及 时 获 取 商 品 信 息 ， 以 便 及 时 发 现 商 品 可 能 存 在 的 问 题 并 追  

宄相应的责任 。

建立可靠的商 品 溯源系统能够满足消 费者和供应商 的 需求 ，

溯 源  

系统能够帮助他们准确地记录 、

追

踪

和

共

享

商

品

供

应

链

上

的

商

品

信

息

数

据

［

２ ］

，

打  

通 商 品 生 产 、 加 工 、 仓 储 、 运 输 、 分 销 、 零 售 过 程 中 的 信 息 通 道 。 溯 源 系 统 不 仅

能 够 实 现 对 商 品 从 生 产 到 消 费 的 全 生 命 流 程 信 息 的 双 向 追 踪 ， 提 高 消 费 者 对 供 应  

商 和 商 品 的 信 任 程 度 ， 更 有 助 于 在 商 品 供 应 链 中 产 生 问 题 时 及 时 定 位 具 体 环 节 ，  

快 速 实 现 问 题 追 责 ， 为 问 题 解 决 方 案 的 制 定 提 供 帮 助 ， 还 能 够 整 合 商 品 供 应 链 上  

各环节的 资源和信息 ，

提

升

商

品

供

应

链

管

理

效

率

３
［

］

。  

溯 源 需 要 通 过 产 业 链 上 下 游 的 各 方 广 泛 参 与 来 实 现 ， 传 统 的 溯 源 系 统 往 往 使

用 中 心 化 的 方 式 存 储 商 品 流 转 数 据 。 这 种 机 制 在 供 应 链 环 境 下 存 在 着 许 多 隐 患 。  

首 先 ， 单 一 机 构 对 所 有 数 据 拥 有 绝 对 的 控 制 权 ， 而 供 应 链 中 的 其 他 成 员 无 法 充 分  

了 解数据状况 ，

从而降低 了 供应链成员 对溯源系统的信任 。

其次 ，

供 应 链 成 员 存

在 定 的 利 性 一

自

４

［

］

，

出 于对 自 身利益的考虑 ，

供 应 链 成 员 很 有 可 能 对 商 品 数 据 进  

行篡改和 伪造 。

此外 ，

供应链上各成员 间信 息流通速度慢 、

可靠性差 、

共 享 程 度

低，

形 成 信 息 孤 “
了

岛”

５

［

］

，

更 使 得 中 心 化 数 据 存 储 模 式 下 数 据 被 篡 改 的 可 能 性  

大 提 大

闻 。

在 溯 源 系 统 中 引 入 区 块 链 技 术 能 够 有 效 提 升 溯 源 系 统 的 安 全 程 度 和 可 信 任  

度１

［

］

。

区块链具备透明 度高、

可追溯 、

难

以

被

篡

改

等

特

性

６

［

］

，

使 用 区 块 链 组 件 代  

替 传 统 的 中 心 化 数 据 库 存 储 商 品 流 转 数 据 ， 能 够 降 低 对 供 应 链 中 个 体 成 员 的 依 赖 ，

使商 品 信息对供应链成员 而言变得透明 度高、

可共享 、

易追溯 ７

［

］

。  

１  

北京 邮 电大学工 学硕士学位论文



  

２ １ ． 研 究 现 状

在 区块链与溯源系 统的结合应用方面 ，

研宄多 针对商 品 供应链领域 ，

品 类 涵  

盖水产 品 、

农产 品 、

建材 、

奢侈品等 ，

使用 物联 网 设备采集商 品信息 ，

选 取 以 太

坊 等 区 块 链 平 台 为 商 品 数 据 的 存 储 提 供 支 持 。 如 Ｆ ｅｎｇＴｉ ａｎ 将 ＲＦＩ Ｄ 技 术 与 区 块

链技术相结合 ，

使用

ＲＦ ＩＤ

设

备

采

集

商

品

在

供

应

链

上

各

环

节

产

生

的

数

据

信

息

［

８ 】

，

并 将 其 存 储 到 区 块 链 中 ， 从 而 提 升 供 应 链 信 息 的 可 追 溯 性 和 可 见 性 【９ ］ 。 Ｔｏｙ ｏｄａ 等  

人使用 以太坊存储商 品 信息数据 ，

结合物联 网 设备和 防伪 标签对商 品 的 生产 、

流  

通 乃 至 进 入 二 手 市 场 再 次 交 易 的 过 程 中 的 所 有 权 信 息 进 行 追 踪 ， 提 升 了 商 品 交 易  

信息 的透明度 ，

降

低

了

用

户

购

买

到

仿

冒

产

品

的

可

能

性

［

１

Ｇ ］

。

将 技 Ｈ ｇｏ ｒｉ ｌ ｌ ｉ

ＲＦＩ Ｄ 术

与 区 块 链 技 术 相 结 合 ， 将 木 材 从 常 青 树 生 长 、 砍 伐 、 堆 叠 、 授 权 、 加 工 、 质 检 、  

物流运输到销售 的 全流程供应链信 息通过

ＲＦ Ｉ Ｄ

标签进行采集 ，

并 将 木 材 的 砍 伐  

授 权 等 关 键 信 息 写 入 区 块 链 中 ， 提 升 了 木 材 产 品 供 应 链 的 可 靠 性 、 透 明 度 和 安 全  

性丨 ［

１ ］

。  

随 着 研 究 的 增 加 ， 区 块 链 与 溯 源 系 统 的 整 合 应 用 中 存 在 的 难 点 和 问 题 也 逐 渐

暴露 。

现有 的 区块链平 台

如 比 特 币 ２ ｜

［

］

（

、

以 太 坊 ３ １ ［

］

）

多 使 用 工 作 量 证 明 方 法 作 为

共识机制 ，

存在算力浪费 的 问 题 。

而 数 据 的 多 节 点 同 步 存 储 一 方 面 使 系 统 中 存 在

大量冗余数据 、

数据存储成本升 高 ，

另

一

方

面

也

涉

及

到

隐

私

信

息

的

暴

露

问

题

［

１

４ 】

。  

此 外 供 应 链 上 产 生 的 元 数 据 如 何 组 织 、 针 对 商 品 信 息 的 查 询 与 代 币 场 景 下 的 差 异  

等

问

题

也

使

区

块

链

与

商

品

溯

源

系

统

的

整

合

存

在

一

定

的

难

度

［

１

５ ］

。

这 些 问 题 的 存 在  

使 研 究 者 对 区 块 链 在 商 品 溯 源 场 景 的 应 用 产 生 了 新 的 思 考 。 Ｎａｎｏ 将 块 链 结 构 修

改 为 以 用 户 为 线 索 ， 以 收 发 动 作 为 联 系 的 “ 区 块 点 阵 ” 网 状 结 构 ， 降 低 了 数 据 的

存储压力 ，

提 高 询 速 度 了 查

６ １

［

］

。

刘家稷等设计 了 一种 双链结构 ，

将 以 太 坊 与 Ｉ Ｐ Ｆ Ｓ  

相结合 ，

在

确

保

溯

源

信

息

安

全

性

的

同

时

降

低

了

存

储

成

本

［

１

７ 】

。

Ｈ Ｘ ｅ

ｉ ａｑｊ ｉ ａｎ

等 提 出  

了 以 商 品 为 线 索 的 商 品 链 数 据 结 构 ， 在 保 障 数 据 难 以 篡 改 的 同 时 提 高 了 查 询 效 率  

１８

［

］

。

通 过 结 合 业 务 场 景 对 区 块 链 结 构 进 行 相 应 改 造 以 解 决 问 题 是 研 究 的 一 种 方  

向 。  

３ １ ． 论 文 主 要 任 务

课 题 容 ３ １ ．

．１

内

本 课 题 的 目 的 在 于 对 区 块 链 技 术 和 商 品 溯 源 系 统 的 结 合 进 行 研 宄 ， 对 商 品 溯

源场景下 的 区块链进行改进 ，

设计适用 于该场景 的 区块链组件 ，

并 基 于 该 组 件 实  

现一个数据信 息可追溯 、

难以篡改的商品溯源原型系统 。

体 具

容 如 下 内

：

２  

第一章 绪论



  

１ 研 宄 区 块 链 技 术 在 商 品 溯 源 系 统 中 的 应 用 ， 使 用 区 块 链 技 术 保 障 商 品 溯   ） 源 系 统 中 存 储 的 商 品 流 转 信 息 数 据 难 以 被 篡 改 。 使 用 中 心 化 存 储 的 商 品

溯 源 系 统 面 临 商 品 数 据 信 息 容 易 被 篡 改 和 捏 造 的 问 题 ， 而 直 接 使 用 现 有  

的 区 块 链平 台 代 替 中 心 化 存 储 则 存 在 数 据 写 入 速 度 慢 、 算 力 浪 费 、 通 信  

开 销 较 大 、 冗 余 数据 存 储 较 多 等 问 题 。 本 文 通 过 结 合 商 品 全 生 命 周 期 流  

程 对 商 品 数 据 信 息 进 行 组 织 和 存 储 ， 改 进 了 传 统 的 区 块 链 结 构 ， 设 计 了  

适 当 的 区 块 链 解 决 方 案 对 商 品 信 息 数 据 的 存 储 进 行 支 撑 。  

２ 基 于 改 进 的 商 品 信 息 区 块 链 ， 实 现 一 个 商 品 溯 源 原 型 系 统 。 该 商 品 溯 源   ）

原 型 系统需要进行商 品流转信息的存储并保障其难 以被篡改 、

查 询 便 于

。  

原 型 系 统 应 具 备 友 好 的 交 互 界 面 ， 便 于 商 品 信 息 的 査 询 和 录 入 。 原 型 系

统 应 与 现 实 场 景 相 结 合 ， 针 对 商 品 的 生 产 、 运 输 、 销 售 、 检 验 等 场 景 进  

行适应 ，

方便用 户 在商 品流转的全过程中 对商 品信息进行追踪 。

此 外 ，  

原 型 系 统 还 应 考 虑 实 体 商 品 与 系 统 中 存 储 的 信 息 的 对 应 问 题 。  

３
）

本 文 的 主 要 创 新 点 是 对 商 品 溯 源 场 景 中 使 用 的 区 块 链 进 行 了 改 进 ， 设 计  

了 一 种 适 用 于 商 品 溯 源 的 网 状 商 品 信 息 区 块 链 ， 并 对 基 于 此 区 块 链 的 商  

品 溯 源 原 型 系 统 进 行 了 实 现 。  

３ ２ １ ．

．

本 人 承 担 的 工作

课 题 中 本 人 对 商 品 溯 源 、 区 块 链 技 术 以 及 两 者 的 结 合 应 用 情 况 进 行 了 调 研 ，

经 过 需 求 分 析 、 概 要 设 计 、 详 细 设 计 、 编 码 实 现 和 测 试 等 流 程 ， 实 现 了 一 个 基 于  

区 块 链 技 术 的 商 品 溯 源 原 型 系 统 。 该 原 型 系 统 能 够 对 商 品 从 生 产 、 包 装 到 运 输 、  

分 销 、 零 售 的 全 生 命 流 程 中 产 生 的 商 品 流 转 信 息 进 行 采 集 和 存 储 ， 同 时 保 障 信 息  

被 有 效 存 储 、 不 被 篡 改 ， 协 助 用 户 进 行 商 品 溯 源 。 具 体 情 况 如 下 ：

１ ） 本 文 首 先 明 确 了 商 品 溯 源 系 统 的 使 用 场 景 ， 对 现 有 的 商 品 溯 源 系 统 模 式 进 行 了 分 析 ， 列 举 了 在 商 品 溯 源 系 统 中 使 用 区 块 链 技 术 面 临 的 问 题 ， 针  

对 问 题 对 典 型 的 区 块 链 进 行 了 改 进 ， 设 计 了 适 用 于 商 品 溯 源 场 景 的 网 状  

块 链 区

。  

２ 针 对 基 于 网 状 商 品 信 息 区 块 链 的 商 品 溯 源 原 型 系 统 进 行 需 求 分 析 、 概 要 ） 设 计 和 详 细 设 计 。 该 原 型 系 统 使 用 上 文 所 述 的 网 状 区 块 链 存 储 商 品 信 息 。  

针 对 区 块 链 部 分 需 要 分 析 和 设 计 数 据 存 储 规 则 和 流 程 ， 针 对 原 型 系 统 的

其 他 部 分 则 需 要 进 行 用 户 管 理 、 信 息 录 入 、 信 息 查 询 等 功 能 模 块 的 划 分 ，  

并 对 其 工 作 流 程 、 关 联 关 系 等 进 行 分 析 和 设 计 。  

３
）

在 概 要 设 计 和 详 细 设 计 的 基 础 上 ， 完 成 对 原 型 系 统 的 编 码 实 现 ， 并 设 计  

测 试 用 例 对 原 型 系 统 进 行 测 试 。  

３

北京邮 电大学工学硕士学位论文



  

４ １ ． 论 文 组 织 结 构

论 文 的 结 构 如 下 ：  

第一章是绪论 。 该 章节主要介绍 了 课题 的研 宄背景 、 研究意义和研宄现状 ，

对课题的主要任务和本人承担 的 工作进行 了 说 明 ，

概 括 了 论 文 的 组 织 结 构 。  

第 二 章 是 相 关 技 术 介 绍 。 该 章 节 对 本 文 使 用 的 关 键 技 术 和 理 论 进 行 了 介 绍 。  

本 文 使 用 的 关 键 技 术 主 要 包 括 用 于 数 据 存 储 的 区 块 链 技 术 和 用 于 商 品 标 识 的 二  

维 码 技 术 等 。  

第 三 章 是 针 对 商 品 溯 源 系 统 与 区 块 链 技 术 相 结 合 的 分 析 与 研 究 。 该 章 节 对 商

品 溯 源 系 统 的 应 用 场 景 和 常 见 结 构 及 区 块 链 技 术 在 其 中 的 应 用 进 行 了 分 析 ， 结 合

商 品 溯 源 场 景 对 传 统 的 区 块 链 结 构 进 行 了 改 进 ， 设 计 了 适 用 于 商 品 溯 源 的 网 状 区  

块 链 结 构 。  

第 四 章 是 针 对 基 于 区 块 链 技 术 的 商 品 溯 源 原 型 系 统 的 需 求 分 析 和 概 要 设 计 。  

该 章 节 对 商 品 溯 源 原 型 系 统 的 需 求 进 行 了 分 析 ， 并 以 对 原 型 系 统 的 需 求 分 析 为 基  

础 ，

对原型 系统的整体结构进行描述 ，

划 分原 型系统 的功能模块 ，

介 绍 原 型 系 统

现 接 中 出

的

口 。  

第 五 章 是 针 对 商 品 溯 源 原 型 系 统 的 详 细 设 计 和 实 现 。 该 章 节 中 对 原 型 系 统 的

各模块设计与 实现进行 了 阐 述 ，

详细介绍 了 各模块 的工作流程和实现方法 ，

给 出

了 原 型 系 统 中 数 据 库 表 的 设 计 详 情 。  

第 六 章 是 测 试 与 验 证 。 该 章 节 介 绍 了 原 型 系 统 的 开 发 和 运 行 环 境 针 对 原 型 ，

系 统的主要功能设计 了 测试用 例 并进行 了 测试 ，

通过截图 的方式 ，

对 原 型 系 统测  

试 过 程 中 的 关 键 步 骤 进 行 了 展 示 。  

第七章是总结和展望 ，

该 章 节 对 己 经 完 成 的 工 作 和 存 在 的 不 足 进 行 了 总 结 ，  

对 未 来 的 优 化 方 向 进 行 了 展 望 。

４  

第二章 相关技术介绍



  

第 二 章 相 关 技 术 介 绍

本 章 介 绍 基 于 区 块 链 技 术 的 商 品 溯 源 系 统 中 涉 及 的 相 关 理 论 和 技 术 ， 主 要 包   括 用 于 数 据 存 储 的 区 块 链 技 术 和 用 于 商 品 标 识 的 二 维 码 技 术 等 ， 并 对 原 型 系 统 开   发 中 涉 及 的 技 术 和 开 源 框 架 进 行 了 简 要 介 绍 。  

２ ． １ 区 块 链 技 术

２ ． １ ． １ 区 块 链 技 术 概 述  

区块链技术起源于

中

本聪提

出

的

比特

币

项

目

２ ［ １

］

。

它通过对数据进行加密 ，

将  

数 据 进 行 链 式 勾 稽 、 多 副 本 存 储 等 方 式 ， 借 助 工 作 量 证 明 等 共 识 算 法 ， 实 现 对 数  

据 的 分布式 、

去 中 心化存储和 管理 。

底层技术赋予 区 块链难 以篡改、

去 化 中 心

、  

可追溯等特性 １９

［

］

。

优秀 的特性使 区块链在数字货 币 、

供应链管理 、

单据管理、

金  

融 、 教 育 等 领 域 得 到 了 广 泛 的 探 索 和 应 用 。  

区块链是一种 复合技术 ，

它 的产生离不开密码学 、

共

识

机

制

和

网

络

的

支

持

Ｍ

［

］

。

区 块 链 中 使 用 的 密 码 学 成 果 主 要 是 哈 希 函 数 和 数 字 签 名 算 法 。 共 识 算 法 和 Ｐ ２ Ｐ 网

络 则 共 同 辅 助 区 块 链 完 成 数 据 的 多 副 本 存 储 ， 赋 予 了 区 块 链 去 中 心 化 的 特 性 。 区

块 链 按 照 去 中 心 化 的 程 度 可 以 被 划 分 为 公 链 、 联 盟 链 和 私 链 。 公 链 开 放 程 度 最 高 ，

数据信息对全部参与者公开 ，

全 体节 点 都 能够 参 与 对 数据 的 读写 ；

联 盟 链 由 机 构

主导 ，

参与 网络需要授权 ，

数据写 入权限 由 部分节点控制 ；

私链则 更为封 闭 ，

数  

据 写 入 权 限 由 个 体 节 点 控 制 。  

区 块 链 技 术 最 初 的 应 用 场 景 是 加 密 货 币 。 传 统 的 区 块 链 中 交 易 数 据 以 块 链 的

形 式 存 储 ， 一 段 时 间 内 产 生 的 若 干 条 交 易 数 据 被 共 同 打 包 ， 借 助 哈 希 运 算 以 Ｍｅｒ ｉｄ ｅ 树 的 形 式 形 成 数 据 区 块 ， 区 块 由 区 块 头 和 区 块 体 组 成 。 区 块 头 中 包 括 时 间 戳 、 本 区 块 哈 希 值 、 前 驱 区 块 哈 希 值 、 区 块 生 成 证 明 等 信 息 ， 区 块 体 中 则 存 储 具   体 的 交 易 数 据 。 区 块 首 尾 相 连 形 成 数 据 链 ， 下 一 个 区 块 中 包 含 上 个 区 块 的 哈 希 值 。 块 中 的 数 据 一 旦 被 篡 改 ， 将 导 致 其 哈 希 值 与 后 续 数 据 块 不 相 符 ， 从 而 保 障 链 中 存   储 的 数 据 难 以 被 篡 改 。 比 特 币 、 以 太 坊 和 超 级 账 本 等 应 用 中 均 使 用 块 链 结 构 存 储  

数 据 。

随 着 技 术 的 发 展 和 应 用 场 景 的 扩 大 ， 区 块 链 的 组 织 形 式 也 被 逐 渐 拓 宽 ， 不 再  

泥 于 链 式结 无 环 是 块 链 结 构   拘

构 Ａ Ｇ 有 向 Ｄ 。

（ ｄｉ ｒｅ ｃｔｅ ｄａｃｙ ｃ ｌ ｉ ｃｇｒａｐｈ ，

图） 即 在

基 础 上 扩 展 产 生 的 另 一 种 图 式 存 储 结 构 。 ＤＡＧ 模 式 下 通 常 每 条 交 易 数 据 都 作 为

一 个 单 独 的 数 据 块 ， 数 据 块 之 间 通 过 哈 希 值 的 引 用 形 成 网 状 结 构 。 相 比 块 链 结 构 ，  

５

北京 邮 电大 学工学硕士学位论文



  

ＤＡ Ｇ 在 响 应 时 间 、 可 扩 展 性 方 面 有 着 更 好 的 发 展 潜 力 。 使 用 ＤＡ Ｇ 结 构 存 储 数 据

等 提 块 的 块 链 应 用 包 括 区

Ｎ  ０ 八 ｋ ａｎ ｏ ［ １ ６

１

丁

２ ［

１］

项 Ｎ 。

ａｎｏ

目中

出了区

点 阵 结 构 ， 以  

用 户 为 线 索 组 织 数 据 ， 将 用 户 间 的 交 易 抽 象 为 用 户 链 数 据 间 的 引 用 ， 加 快 了 交 易  

查询 的速度 。

Ｉ Ｏ ＴＡ 中 则 提 出 了

缠 结 “

”

的 概念

，

通 过 对 数 据 块 的 多 次 验 证 和 交

叉 引 用 保 证 数 据 的 安 全 。  

２ ２ １ ．

．

区 块链 关 键 技 术  

区块链技术 中应用 的关键技术主要包括哈希算法、

数字签名 、

络 Ｐ ２Ｐ 网

、

共  

机 等 识 制

。  

１ ） 哈 希 算 法  

哈希

（ 也称为散列 ）

算

法是

密

码

学

在

区

块链

中

的

应

用

之

一

２２

［

］

。

哈 希 算 法将 任  

意长度的输入值变换为固 定长度的输 出

散 列 值 （

），

散列值与输入值相关 ，

输 入  

值的微小 区 别将导致散列值存在 巨大差异 。

哈希运算难 以逆 向进行 ，

在 短 时 间 内  

很 难 根 据 散 列 值 逆 推 出 输 入 值 。  

在 区 块 链 技 术 中 ， 哈 希 算 法 被 用 于 数 据 的 加 密 和 校 验 。 每 条 信 息 的 散 列 值 被

看 作 信 息 的 唯 一 标 识 ， 散 列 值 间 的 相 互 引 用 则 构 成 了 区 块 链 的 链 式 结 构 。 它 们 共  

同 保 障 区 块 链 中 的 数 据 难 以 被 篡 改 。 常 见 的 哈 希 算 法 包 括 Ｓ Ｈ Ａ １ 、 Ｓ ＨＡ２ ５ ６ 、 Ｍ Ｄ ５

等。

比特 币 底层使用 的哈希算法是

Ｈ Ａ Ｓ

２ ６ ５

。  

２ 数 字 签 名   ）

数字签名

旨 在证 明 消

息或文档

的 真 实 性 ２３

［

］

。

常 见 的 数 字 签 名 使 用 非 对 称 加  

密算法 ，

其密钥 由 公开部分

公 钥 （

）

和私有部分

私 钥 （

）

成对组成 。

数 字 签 名 过  

程 即 通 过 私 钥 对 数 据 进 行 加 密 ， 签 名 认 证 过 程 即 使 用 公 钥 对 加 密 的 数 据 进 行 解 密 。  

通过私钥 加密和 公钥解密两个环节 ，

即可保障传输消 息 的真实性和完整性 。

常 用

的 非对称 加密算法有 ＲＳＡ 、 ＥＣＤＳＡ 、

等 Ｓ ｃｈｎｏ ｒｒ 、 Ｄ Ｓ Ｓ

，

在 比特币 系统中 ，

公 钥

由 私 钥 通 过 椭 圆 曲 线 加 密 算 法 生 成 ＰＩ  

 ３

Ｐ２Ｐ

）

网 络  

区块链系 统 中 使用 的 网络结 构是 Ｐ２Ｐ 网 络 ，

又称对等 网络 ，

各 节 点 之 间 关 系

平等 ，

相 互连通 。

每个节点 既可 以作为服务器 向其他节点提供资源 ，

也 可 以 作 为

客 户 端 请 求 其 他 节 点 的 资 源 。 相 比 传 统 的 客 户 机／ 服 务 器 模 式 ， Ｐ２ Ｐ 网 络 中 各 节 点

间 没有主从分别 ，

降低 了 对单一服务器 的访 问 压力 ，

是 区 块 链 能 够 具 备 去 中 心 化  

特 性 的 基 础 。

４ 共 识 机 制 ）

共 识 机 制 用 以 在 多 节 点 间 维 持 数 据 存 储 的 致 一 性 。 在 链 式 结 构 的 区 块 链 中 ，

常 用 共 识 算 法 包 括 作 量 算 法 的

Ｗ Ｗ 工 Ｐ Ｏ

（ Ｐ ｒｏ ｏ ｆｏ ｆ

ｏｒｄ ，

证明

Ｏ Ｐ ） 、 Ｓ  （ Ｐ ｒ ｏ ｏ ｆ ｏ ｆ  

６

第二章 相关技术介绍



  

股 权 证 算 法 委 托 权 益 证 算 法 Ｓｔａｃｋ ，

明

Ｄ Ｏ Ｄ ） 、

Ｐ Ｓ（

ｅｌ ｅ ｇ ａｔｅ ｄＰｒｏ ｏ ｆｏ ｆＳ ｔａｋｅ ，

明

） 、  

实 用 拜 庭 容 错 算 法 算 法 等 Ｔ Ｏ Ｂ Ｆ

Ｘ Ｔ



Ｐ ｒ ａｃ

ｔｉ

ｃ

ａ

ｌ



ｙ ｚａｎｔ ｉｎ ｅ Ｆ ａ ｕ ｌ ｔ  Ｔｏ ｌ ｅ ｒａｎ ｃ ｅ ，

占

Ｒ ） 、

ａ ｆｔ 

。  

其 中 Ｐ Ｏ Ｗ 基 于 工 作 量 证 明 ， 是 较 为 基 础 的 一 类 共 识 机 制 ， 使 用 该 共 识 算 法 的 代

表 应 用 是 比 特 币 。 这 种 算 法 的 优 点 在 于 去 中 心 化 程 度 高 ， 但 共 识 过 程 需 要 消 耗 大

量 算 力 ， 造 成 了 资 源 的 浪 费 ， 且 共 识 所 需 的 时 间 较 长 。 Ｐ Ｏ Ｓ 和 Ｄ ＰＯ Ｓ 算 法 基 于 节  

点 权 益 ， 节 点 间 通 过 工 作 量 或 权 益 份 额 竞 争 数 据 写 入 权 ， 与 ＰＯ Ｗ 相 比 ， 该 类 算  

法 能 够 一 定 程 度 上 降 低 共 识 消 耗 的 算 力 资 源 。 这 三 类 算 法 都 在 公 链 （ 尤 其 是 代 币 ）  

场 景 下 使 用 较 多 。 ＰＢ ＦＴ 和 Ｒａｆｔ 算 法 则 通 过 选 举 主 节 点 的 方 式 达 成 共 识 ， 摒 弃 了  

共识算法中 的激励机制 ，

具备较低 的共识成本 ，

但在去 中 心化程度上稍有欠缺 ，

在 联 盟 链 和 私 链 场 景 中 更 为 适 用 ， 使 用 此 类 算 法 的 代 表 项 目 是 Ｈ ｙｐｅｒｌ ｅｄ ｇｅ ｒ 。 此   外 还 有 一 些 区 块 链 使 用 多 种 共 识 方 法 混 合 进 行 共 识 。 而 在 图 式 结 构 中 ， 共 识 通 过  

对 引 用 数 据 的 验 证 完 成 ， 借 由 图 结 构 的 复 杂 性 保 障 数 据 致 一 ， 其 中 较 为 具 有 代 表

性 包 括 等 的 应 用

Ｉ Ｏ ＴＡ 、 Ｎ ａｎ ｏ

。

２ ２ 商 品 标 签   ．

商 品 标 签 是 商 品 溯 源 系 统 中 不 可 或 缺 部 的 一 分 。 系 统 通 过 商 品 标 签 将 实 体 商

品 与 商 品 信 息 进 行 绑 定 。 目 前 商 品 溯 源 系 统 中 常 用 的 商 品 标 签 包 括 ＲＦ Ｉ Ｄ 标 签 和

维 标 二

码

签 。

频 射 识 别 是 种 非 接 触 式 的 动 识   Ｄ Ｒ ＲＦＩ

（

ａｄ ｉ ｏ  Ｆ ｒｅ ｑｕ ｅ ｎ ｃｙ  Ｉ ｄ ｅ ｎ ｔ ｉ ｆｉ ｃ ａｔ ｉ ｏ ｎ ，

一
）

自

别技术 ，

它利用

无线

电

信

号

完

成对特定

目

标

的

识别

和

相

关数据

的

读

写

２４

［

］

。

ＲＦ Ｉ Ｄ  

具 有 识 别 方 便 、 容 量 较 大 等 优 点 。 但 ＲＦ Ｉ Ｄ 的 使 用 需 要 特 定 的 读 写 器 支 持 ， 读 写

器 的 普 及 度 相 对 较 低 ， 尤 其 是 在 普 通 消 费 者 中 极 少 配 备 。 这 使 得 在 溯 源 系 统 中 应  

用 ＲＦＩ Ｄ 标 签 作 为 商 品 标 签 的 成 本 较 高 ， 不 利 于 推 广 。  

二 维 码 是 按 一 定 规 律 在 平 面 上 分 布 黑 白 像 素 的 特 定 图 形 。 二 维 码 通 过 像 素 点

的 排 列 组 合 表 示 意 义 ， 具 有 密 度 大 、 承 载 信 息 量 大 的 特 点 。 常 见 的 二 维 码 包 括 行

排 列 式 维 码 矩 阵 式 维 码 等 二

ＣＯＤＥ４９ 、

Ｄ Ｐ

Ｆ ４ ７ １

，

二

Ｍ Ｄ ａｔａ

ａ ｔｒｉ ｘ 、 Ｑ Ｒ ｃ ｏ ｄ ｅ

２５

［

】

。  

Ｑ Ｒｃ ｏ ｄ ｅ 是 由 Ｄ ｅ ｎ ｓ ｏ 公 司 于 １ ９ ９４ 年 ９ 月 研 制 的 一 种 矩 阵 二 维 码 符 号 。 越 来 越 多 企 业 在 运 营 中 推 出 基 于 Ｑ Ｒｃｏｄｅ 的 新 产 品 和 服 务 ， 并 且 己 经 取 得 了 较 好 的 效  

果 ２５

【

］

。

它 具备成本低廉 、

容量大等优点 。

且 在 识 别 ＱＲｃｏｄｅ 时 ，

用 户 不 需 配 备 额

外 设 备 ， 仅 通 过 普 通 摄 像 头 即 可 完 成 识 别 。 这 使 得 在 商 品 溯 源 系 统 中 使 用 Ｑ Ｒｃｏ ｄ ｅ

作 为 商 品 标 签 成 为 了 一 种 行 之 有 效 的 方 法 。 Ｑ Ｒ ｃｏｄ ｅ 配 合 用 于 识 别 和 生 成 二 维 码  

的 开 源 库 Ｚｘ ２６

ｎｇ［
ｉ

Ｉ ，

能 够 较 好 地 实 现 商 品 溯 源 系 统 中 的 商 品 信 息 数 据 与 实 体 商 品  

的 绑 定 。  

７  

北京邮 电大学工学硕士学位论文



  

２ ． ３ 相 关 开 发 技 术  

本 文 中 实 现 了 一 个 Ｂ ／Ｓ 结 构 的 商 品 溯 源 原 型 系 统 ， 主 要 使 用 的 开 发 框 架 和 开  

源 工 具 包 括 框 架 等 系 统 基 于 Ｂ Ｓ ｐ ｒｉ ｎ ｇ ｏ ｏ ｔ

、

ｏ ｔ － ｉ

、

Ｄ ｉ ｓｒｕｐｔｏ ｒ 、

Ｚ ｘｉ ｎｇ

。

 Ｓ ｐ ｒｉ ｎｇ Ｂ ｏ ｏ ｔ

框架进行开发 ，

使用

ｏ ｔ － ｉ

框架和 队列组件

进 行 节 通 信 Ｄ ｉ ｓ ｒｕｐｔｏｒ

点间 ，

数 据 存 储  

则 使 用 和 Ｍ ｏｎｇｏ Ｄ Ｂ

Ｍ Ｑ 

ｙＳ

Ｌ 。  

框 架 开 发 是 个 基 于 的 轻 量 级 开 发 框   Ｓ ｐｒ ｉ ｎｇＢ ｏ ｏｔ

由 Ｐ ｉ ｖ ｏ ｔａｌ Ｔｅ ａｍ

２７

［

］

，

一

Ｊ ａｖａ

架 它 使 模 式 嵌 容 器 具 备 控 制 反 转 ，

用 了 Ｓ ｐｒ ｉ ｎｇＭＶ Ｃ

，

内

了Ｓ ｅｒｖ ｌ ｅｔ

，

Ｉ ｏ Ｃ（

） 、  

Ａ ｏ Ｐ（ 面 向 切 面 编 程 ） 等 特 性 ， 配 置 简 便 ， 易 于 使 用 ， 对 其 他 框 架 具 备 较 好 的 兼

容性 。 使用

Ｓ ｐｒｉ ｎｇＢ ｏ ｏ ｔ

作为系 统开发的 基础框架能够简化系 统环境的搭建过程 ，

便 于 系 统 的 开 发 、 配 置 和 管 理 。  

ｏ ｔ － ｉ

是一个开源 的通信框架

它 为 系 统 提 供 了 基 于 Ｔ Ｃ Ｐ 协 议 的 通 信 Ａ ＰＩ 。  

则 是 个 Ｄ ｉ ｓ ｍｐ ｔ ｏ ｒ

一

由

ＬＭＡＸ

公

司

开源

的

消

息

组

件

２９

［

］

，

它 基 于 生 产 者 ／消 费 者 模  

型 ，

以环形数组为核心 ，

用

于

在

线

程

间

高

效

地

传

递

数

据

３
［

ｆ
Ｕ

Ｚｘｉｎｇ

是一个 使 用

Ｊ ａｖ ａ  

实现 的 开源

１ Ｄ／２Ｄ

条形码

图 像 处理库

，

该开源库提供

了

针对

Ｑ Ｒ Ｍ ｃ ｏ ｄ ｅ 、

Ｃ ａｘ ｉ

ｏ ｄ ｅ 、  

Ｕ Ｐ Ｃ － Ａ 等 多 种 二 维 码 和 条 形 码 的 生 成 和 识 别 接 口 。  

２４ ．

本 章 小 结

本 章 节 主 要 对 区 块 链 技 术 进 行 了 概 述 ， 对 区 块 链 技 术 依 托 的 哈 希 算 法 、 数 字   签 名 算 法 、 共 识 算 法 等 关 键 技 术 进 行 了 介 绍 ， 并 介 绍 了 商 品 溯 源 系 统 中 需 要 使 用 的 ＲＦ ＩＤ 、 二 维 码 等 商 品 标 签 技 术 ， 最 后 对 论 文 所 述 系 统 使 用 的 开 发 框 架 、 通 信 框 架 等 相 关 开 发 技 术 进 行 了 简 要 介 绍 。  

８

第三章 基于 区块链技术 的商 品溯源系统分析与研 究



  

第 三 章 基 于 区 块 链 技 术 的 商 品 溯 源 系 统 分 析 与 研 究  

本 章 对 传 统 型 和 基 于 区 块 链 技 术 的 商 品 溯 源 系 统 的 结 构 和 优 缺 点 进 行 分 析 ，   并 给 出 针 对 商 品 溯 源 场 景 的 区 块 链 的 改 进 方 案 ， 设 计 了 一 种 适 用 于 商 品 溯 源 场 景   的 网 状 区 块 链 。
３ ． １ 商 品 溯 源 系 统 结 构 分 析  

３．

１

．

１

传 统 商 品 溯 源 系 统  

传统的商品溯源系统大多针对食品 、

农产品 、

奢侈品等品类 ，

针 对 单 且 以

一  

商 品 的溯源为主 。

系统多 由 生产企业 、

销 售 企业或 行业协会等组织进 行搭 建 ，

如

各 类 地 区 性 的 农 产 品 溯 源 查 询 系 统 、 电 商 平 台 溯 源 系 统 等 ， 为 消 费 者 提 供 商 品 溯  

源信息查询服务 。

在设计上 则 多 结合

Ｄ Ｒ Ｆ 丨

、

二维码 、

Ｅ Ｐ Ｃ 等 物 联 网 设 备 和 相 关

标 准 进 行 商 品 数 据 的 采 集 ， 并 使 用 中 心 化 数 据 库 对 商 品 信 息 数 据 进 行 存 储 。 如 图

所 示 ３ － １

，

传统的商品溯源系统结构大致可分为应用层 、

服务层 、

数 据 层 和 物 理  

层 层 四

。

￣

 ＺＺＺＩＺ ＺＺＺＺＺ

潮 淞 丨 ｓ 息 呈 现  

       服 务 。

丨 户行理

Ｊ Ｉ

 ｜

Ｉ

Ｉ

Ｉ

Ｉ

１ ｜

？ … “  

 商 品 ＆ 据
 
数 拋 Ｍ  ｔ 心 化 玫 Ｗ 痄

＾ 一  ￣  一  ＂一


：

 ，  

    物 ｆ

ｎｎ ｎ

１

Ｉ

｜

条 形码



Ｉ

｜

二维码

  ？ … ”  

Ｉ

｜

图

３－ １

传 统 商 品 溯 源 系 统 结 构  

商 品 溯 源 系 统 中 物 理 层 负 责 完 成 底 层 商 品 信 息 数 据 的 采 集 工 作 。 该 层 由 物 联  

网 设 备 组 成 ， 借 助 各 类 商 品 标 签 ， 协 助 用 户 以 自 动 或 手 动 的 形 式 将 商 品 的 实 际 流  

转 数 据 输 入 到 系 统 。 其 中 商 品 标 签 的 表 现 形 式 包 括 但 不 仅 限 于 Ｒ Ｆ Ｉ Ｄ 标 签 、 条 形  

维 维 码 二 、

码、 三

码 等 。  

物 理 层 对 商 品 信 息 数 据 进 行 采 集 后 ， 需 要 将 获 取 的 数 据 传 入 系 统 进 行 存 储 。

数 据 层 负 责 商 品 信 息 数 据 的 存 储 。 传 统 的 商 品 溯 源 系 统 中 使 用 中 心 化 数 据 库 进 行

数 据 存 储 ， 虽 然 可 以 根 据 商 品 信 息 数 据 的 规 模 选 用 集 中 式 或 分 布 式 的 数 据 库 ， 但

数 据 始 终 由 单 一 机 构 控 制 。
９  

北京邮 电大学工学硕士学位论文



  

服务层和应用层共 同组成商 品溯源系统的主体 ，

服务层即 系统的后端部分 ，

依 托 数 据 层 中 存 储 的 商 品 流 转 信 息 数 据 ， 为 用 户 提 供 商 品 信 息 查 询 、 商 品 信 息 录  

入等服务 。 应用 层负责直接与 用 户 进行交互 。 根据 系 统架构 的不 同 应用 层 由 ，

Ｗｅ ｂ  

页 面 或 客 户 端 构 成 。  

３．

１

２
．

基 于 区 块 链 技 术 的 商 品 溯 源 系 统

传 统 的 商 品 溯 源 系 统 虽 然 为 用 户 的 商 品 溯 源 提 供 了 便 利 ， 但 仍 存 在 一 些 不 足 。

传统的商 品溯源系统通常 由 生产商 、

经销商或第三方平 台等机构搭建 ，

商 品 信 息

数 据 的 采 集 和 存 储 由 搭 建 方 控 制 ， 供 应 链 上 的 其 他 成 员 对 系 统 的 参 与 度 较 低 控 ，

制 者 的 单 一 使 商 品 数 据 被 人 为 篡 改 的 难 度 较 低 ， 风 险 较 大 。 且 系 统 主 导 者 对 供 应  

链 上 其 他 环 节 的 控 制 能 力 较 弱 ， 相 应 数 据 的 可 信 程 度 同 样 存 在 隐 患 。

区 块 链 技 术 的 应 用 给 商 品 溯 源 系 统 中 向 品 数 据 易 被 纂 改 的 冋 题 带 来 了 新 的

解 决 思 路 。 区 块 链 的 可 追 溯 、 难 篡 改 、 多 方 维 护 等 特 性 能 够 有 效 弥 补 传 统 商 品 溯  

源系 统 中 存在
． ，

不足 。

引 入 区 块 链 技 术 后 商 品 溯 源 系 统 结 构 如 图 ３ － ２ 所 示 。

￣









满 源 息 呈 现  

客 户 端  浏 览 器

 駆 务 Ｑ

川

户

＊
ｔｉ

理倍

息

录

入Ｃ

息

僉

询…

…  

数 棋     Ｊ  ｒ ｊｚ －

ＺＴ

ｒ  ｊ ｚ ＿

ｉ

］

ｊｚ
＿

 ｉ

ｒ

ｒ
＼

  

据

Ｌ

Ｌ

Ｌ

Ｌ

Ｌ

 物 ＪＳ Ｕ

丨

賺



１

Ｉ

１

丨

綱

  － … －  

Ｉ

１

图 ２ ３ － 引 入 区 块 链 的 商 品 溯 源 系 统 结 构  

系 统 发生的 主要变 化集 中 在数据层 ，

引 入 区 块 链 的 商 品 溯 源 系 统 在 数 据 层 使

用

区块链取代或辅助传统数据库进行商 品 流转信息数据 的存储 ，

物 理 层 采 集 到 的

商 品流转信息被写入区块链中 ，

服 务 层 在 实 现 商 品 信 息 的 查 询 或 录 入 时 也 需 要 与

区 块 链 组 件 产 生 交 互 。  

在 数 据 层 中 ， 可 使 用 的 区 块 链 组 件 包 括 比 特 币 、 以 太 坊 、 超 级 账 本 等 开 源 区  

块链平 台 ，

也存在少 数解决方案 中使 用 自 行搭建的 区块链平 台 。

在 形 式 上 多 使 用  

联盟链 ，

少数使用 以太坊 、

比特 币 等开源平 台 的公链 。

在区块链中 ，

商 品 流 转 数  

据被进行相应的格式处理 ，

封装成为交易提交到 区块链系统 中 ，

等 待 系 统 将 其 确

认生成区块并进行 同步 ，

最 终 形 成 可 追 溯 的 商 品 流 转 信 息 记 录 。

３ ３ ．

１

．

使用

区 块 链 进 行 商 品 溯 源 面 临 的 问 题  

１ ０  

第三章 基于 区块链技术 的商 品溯源 系统分析与 研究



  

在 商 品 溯 源 系 统 中 引 入 区 块 链 组 件 进 行 商 品 信 息 数 据 的 存 储 虽 然 能 够 解 决

商 品 溯 源 系 统 中 潜 在 的 数 据 安 全 问 题 ， 但 仍 存 在 一 些 问 题 和 不 足 。  

首先，

区块链中数据 以区块的形式存储 ，

通过对哈希值 的 引 用 前后相连 ，

形  

成链状结构 。

典型 的块链结构 的 区块链

特 （ 如 比

币、

以 太 坊 等 ） 针 对 代 币 交 易 场  

景 进 行 设 计 ， 按 照 时 间 顺 序 对 数 据 进 行 组 织 ， 以 区 块 的 哈 希 值 作 为 索 引 。 在 此 结

构 下 商 品 流 转 信 息 将 作 为 交 易 的 附 加 信 息 在 区 块 链 中 进 行 存 储 。 这 使 得 在 针 对 指

定 商 品 或 指 定 商 家 的 流 转 记 录 进 行 查 询 时 ， 需 要 对 节 点 中 存 储 的 全 部 区 块 进 行 遍  

历 ， 从 而 导 致 查 询 效 率 较 低 ， 查 询 速 度 缓 慢 。  

其 次 ， 如 以 太 坊 、 比 特 币 等 主 流 区 块 链 平 台 ， 由 于 数 据 规 模 和 共 识 算 法 的 制

约 ，

区块生成所需的时间较长 ，

数据写入的性能较差 ，

针 对 商 品 溯 源 场 景 下 数 据  

录 入 的 需 求 无 法 进 行 有 效 的 支 持 。 此 外 为 了 保 障 数 据 的 安 全 ， 典 型 的 区 块 链 结 构

中 每 个 节 点 都 需 要 对 全 部 信 息 数 据 进 行 存 储 备 份 ， 这 种 设 计 在 面 对 商 品 溯 源 场 景

时 ， 尤 其 是 在 针 对 多 种 类 型 商 品 的 溯 源 系 统 中 ， 各 节 点 中 存 储 的 与 之 无 关 的 数 据

量较 多 ，

不仅造成系统 中 存在 大量冗余数据 ，

还 需 要 面 对 数 据 过 度 暴 露 带 来 的 风  

险 。  

２ ３ ． 针 对 商 品 溯 源 场 景 的 区 块 链 改 进 与 设 计  

针 对 章 节 ３ ３ ．

１

．

中 总结 的 问 题 ，

本 文 考 虑 通 过 对 区 块 链 结 构 和 数 据 存 储 规 则  

两 方 面 进 行 相 应 的 改 进 和 设 计 来 解 决 。  

３ ２ ．

．

１

商 品 信 息 区 块 链 结 构 的 改 进 与 设 计  

相 较 单 纯 以 时 间 顺 序 为 线 索 的 块 链 结 构 ， 本 文 所 述 的 区 块 链 使 用 以 用 户 和 商

品 两 者 为 线 索 的 网 状 结 构 对 商 品 信 息 数 据 进 行 组 织 ， 同 时 维 护 一 个 商 品 Ｄ Ｉ 与 商

品 最 新 信 息 块 散 列 值 的 映 射 表 ， 从 而 提 高 对 数 据 的 查 询 效 率 。  

Ｍ 状 结 沟  裢 式 结 构

 ６  

 〇  ＾一一 尚 品 线 索  用 户 线 家

间 线 索

图 ３ － ３ 商 品 信 息 存 储 情 况 图

１

１

北京邮 电大学工学硕士学位论文



  

如 所 示 图 ３ － ３

，

数据 的 存 储情况可 以抽 象为有 向 无环 图 ，

其 中 点 表 示 商 品 信  

息记录 ，

边则表示商品信息记录间 的 引 用 关系 。

引 用 存 在 于 针 对 同 件 一 商 品 或 同  

一 用 户 录 入 的 不 同 商 品 信 息 记 录 之 间 ， 按 照 时 间 顺 序 ， 后 生 成 的 记 录 对 先 生 成 的

记 录 进 行 引 用 。 通 过 记 录 间 的 引 用 ， 商 品 信 息 数 据 形 成 相 互 勾 稽 、 难 以 篡 改 的 网  

状 结 构 。 商 品 流 转 数 据 的 查 询 可 以 被 抽 象 为 对 图 中 指 定 点 的 查 找 ， 块 链 结 构 中 的

查 找 需 要 遍 历 全 部 节 点 ， 网 状 结 构 中 由 于 商 品 线 索 和 用 户 线 索 的 存 在 ， 通 过 引 用

可 以 直 接 找 到 相 应 记 录 ， 减 少 了 无 关 节 点 的 访 问 ， 大 大 减 少 了 查 询 次 数 ， 从 而 提  

高 了 查 询 的 效 率 和 速 度 。  

商 品信息数据 以商 品 信息块的形式存储 。

如 图 ４ ３ － 所 示 ，

商 品 信 息 块 中 的

Ｈ ａ ｓ ｈ 字 段 为 该 块 的 散 列 值 ， 同 时 也 是 唯 一 标 识 。 Ｃ ｒ ｅ ａｔ ｏｒ 字 段 记 录 产 生 该 信 息 块  

的 节 点 ， Ｐ Ｉ Ｄ 则 表 示 该 区 块 记 录 的 商 品 标 识 。 与 图 ３ － ３ 中 的 用 户 线 索 和 商 品 线 索

相对应 ，

商 品 信息块中 设置两 个对哈希值 的 引 用 字段

Ｈ ｐ ｒ ｅ

ａｓｈ

和

Ｈ ｐ ｒ ｅ Ｐ ｒ ｏ

ａｓｈ ，

其

该 节 产 块 散 值 是 中 ｐ ｒｅ Ｈ ａ ｓ ｈ 引 用 的

点上一个生 的信息 的 列

Ｃ （

ｒｅ ａｔ ｏ ｒ

相 同 ） ，  

指 该 商 上 信 息 块 相 则 Ｈ ｐ ｒｅ Ｐ ｒ ｏ

ａｓ ｈ

向

品 的 个 一

Ｄ Ｐ （

Ｉ

同 ） 。  

Ｈ ａ ｓ ｈ

Ｈ ｐ ｒ ｅ

ａ ｓ ｈ  

Ｈ ｐ ｒ ｅ Ｐ ｒ ｏ

ａ ｓ ｈ

Ｄ ａ ｔ ａ
ｒ

ＰＩ

Ｄ

 Ｘ Ｘ ＸＸ  
：

Ｘ  Ｘ Ｘ Ｃ ｒ ｅ ａ ｔ ｏ ｒ ： Ｘ  

图 ４ ３ － 商 品 信 息 块 关 键 字 段  

图 ３－５ 展示 了 一个 商 品 信 息 区 块链样 例 ，

图 中 对 编 号 为 Ｐ Ｉ 、 Ｐ ２ 、 Ｐ ３ 的 三 件

商 品信息进行 了 记录 ，

涉及 的 记录 由 ＣＯ 、

Ｃ］ 、

Ｃ２ 、

Ｃ３ 四 个参与 者产生 。

每 行 信

息 块 针 对 同 一 件 商 品 ， 每 列 信 息 块 由 同 一 个 记 录 者 产 生 。  

   Ｈ ＾ 

Ｈ ａ＾ｌｉ

＾ ＞  ￣

－
ｒ

ａ ｉ ＞ ｈ  

Ｈ  ｐ ｒ ｅ

ａ ｓｈ

ｐ ｒ ｃ ｌ  ｌ ａ ｓ ｈ  

 ｐ Ｐ ｏ ｈ ｒ ｃ

ｒ

ａ ｓ ｌ  ｌ

￣

ｐ ｒ ｃ Ｐ ｒ ｏ ｌ  ｌ ａ ｓ ｈ



Ｊ

Ｕ Ｐ Ｉ





ｌ

  Ｄ  ＊

：

１

１

ｊ
ＰＩ

ａ


１

 Ｐ ：

Ｉ  

  ｜

Ｃ  Ｃ ｏ ｒ ｅ ａ ｔ

ｒ ：

ｌ

｜

 Ｃ ｒｅａ ｔ ｏｒ

 ：

（

２ 丨

｜



＾

￣

  Ｓ  ｈ ＾￣￣

＾

＾  

１

Ｈ Ｐ ｒ ｅ

ａ＾ ｈ

—






Ｈ Ｐ ｒ ｅ

ａｓｈ

 Ｌ   ｐ ｃ ａｓ ｈ ｒ

ｌ ｌ





Ｈ ｐ ｒ ｅ

ａ ｉ ｈ  

 ｂ ｈ ｐ ｒ ｅ

ｏＨａｓｈ

 Ｈ    Ｌ — ＇

ｐｒｅ Ｐｒｏ

ａｓｈ

＿

ａ ｐ ｏ ｒ ｃ Ｐ ｒ

ｌ ｌ

ｓｈ

 Ｈ ．

ｐ ｒｅ Ｐ ｒｏ

ａ ｓ ｈ

迎 


ｉ

   ｜ ｒ ｍ Ｐ２
－

    厂   Ｉ




ｉ

（

 Ｐ ｒ ｌ

， ：

， ？ ｌ

Ｉ





，

Ｄ Ｐ Ｉ

： Ｐ Ｈ

］

＿ Ｉ

丨 ） ａ ｔ ａ  

Ｃａ

 ｌ

＿

－

－

－ －

Ｊ  Ｌ 二 

＿

＿

Ｃ：



＿

Ｊ  Ｈ ｊ  Ｉ

 １

一

Ｃ ｌｆ
一

〇   Ｏ  ＾ ｏ ｉ

ｒ ：

１

＾

＾



 —

 Ｌ

Ｈ ｐ ｒ ｅ

ａ ｓ ｈ

 Ｍ Ｐ ｒ ｃ Ｐ ｒ ｏ

ａ ｓｈ

Ｌ  ｐ Ｐ ｒ ｅ

ｏ ａ ｒ

ｌ

Ｉ

ｓ ｈ
－




１

（
  Ｐ Ｉ Ｄ 』

，

Ｊ   ｌ

＿

－

Ｄａ ｉ ａ



一

   一 一

 ＾ Ｉ

； Ｉ

］  

   Ｃ ｏ Ｃ  ｒ ｅ ａ ｔ

ｒ：

？

，

｜

图 ３ － ５ 商 品 信 息 区 块 链 示 例  

１ ２

第三章 基于 区块链技 术 的 商 品 溯源系 统分析与 研 宄



  

在 本 文 所 述 的 网 状 结 构 下 ， 数 据 查 询 的 速 度 与 商 品 链 的 长 度 ， 即 该 商 品 流 转  

信 息 的 条 数 有 关 。 而 块 链 结 构 下 针 对 商 品 信 息 的 查 询 速 度 则 与 节 点 中 存 储 的 商 品

流 转 数 据 总 条 数 有 关 。 随 着 商 品 数 据 的 增 多 ， 块 链 结 构 下 针 对 商 品 查 询 的 速 度 明

显 下 降 而 网 状 结 构 中 针 对 商 品 查 询 的 速 度 相 对 保 持 稳 定 。   ，

■  ｆ 询 碎 ｇ 时 Ｍ

 ７ ０ ０

  

雇  

 ？
ｉ

ｓ ｏ ｎ Ｚ  ， Ｚ  

互 Ａ００
’   

／  
，

 ， ｜ ｏｏ

＾＇ ２ ０ ０

 ｏ ｎ
ｉ

，  
爵

■  

■   ■     ｏ

       ０

２０

４０

８０

ＵＯ
ｉ

１ ２０

４０
１

１ Ｋ ０

簡 品 佔 息 记朵数

万 条 （

）  

图 ６ ３ － 块 链 结 构 中 的 查 询 时 间 与 商 品 信 息 记 录 总 数 的 关 系

图 ６ ３ － 描 述 了 块 链 结 构 下 随 着 商 品 记 录 数 的 增 长 ， 针 对 商 品 数 据 查 询 耗 时 的

变化情况 。

实验中 通过脚本生成 了共

１ ５ ０００００

条商 品 信息记录 ，

其 中 针 对 同 一 商

品 的数据记录为

４ ０ － １

条不等。

其中 横轴表示数据记录的总条数 ，

纵 轴 表 示 每 次

针 对 指 定 商 品 查 询 其 全 部 信 息 记 录 所 需 的 时 间 。 每 次 实 验 中 选 取 】 〇 〇 件 商 品 进 行

查 询 取 其 平 均 值 。 实 验 结 果 表 明 随 着 商 品 记 录 总 数 Ｎ 的 增 长 ， 查 询 单 件 商 品 的

时 间接近线性增长 ，

其时 间 复杂度约为

〇 Ｎ 。

（

）

■忾 询 所 芯 时 间 １
  
ｐ ０ １ ． 

２ ． ５

今  ０ ２  ． 

？ 窗

＇

備

＾ 一

￣

１ ，５

１ ． ０  



二一 一

一 ＂   ■

０ ．  ５

０ ．

０     

        ０

２０

４０

６０

８０

１ ００

２０
１

０ ４ １

Ｂ ０  
Ｉ

商 品 Ｗ 息 记录数

乃 条 （

）  

图 ３ － ７ 网 状 结 构 中 的 查 询 时 间 与 商 品 信 息 记 录 总 数 的 关 系

１ ３

北京 邮 电大学工学硕士学位论文



  

■Ｗ 丽 ｗ＿  
Ｉ

３ ０  ． 

 丨

 ｆ

’  

 釤 ２ ． ８

’

    ２． ６

Ｉ

／

ｉ

 １

 ／  
Ｉ

二 ？

２ 

．

！









，

乂

 Ｚ   Ｚ： ２ ． ２ ａ ｒ  

雄  Ｚ   ０ ２ 

．

，

’  

驚

老  ． ！

８

／  

 ｄ － ／  

丨

ｉ  

 ！

．

６

Ｚ  

繼 ｚ

’  
？
２ １ ．

０

！

．

 —  

１

５

＾

 ７

  Ｂ

Ｓ＞

１ ０

指定 商 品 倍 息记录 数

条 （

）  

图 ３ － ８ 网 状 结 构 中 的 查 询 时 间 与 指 定 商 品 信 息 记 录 数 的 关 系

使用 相 同 的数据针对 网状结构进行实验 ，

所 如 图 ３ － ７

示

，

可 以 发 现 随 着 记 录  

总数的增长 ，

查询 所需 的时间稳定保持在

２ｍｓ

左右 ，

未发生明 显变化。

图 ３ － ８ 则

记录 了 在

１ ５ ０００００

条商 品 信 息记录总数下 ，

针 对 商 品 记 录 数 不 同 的 商 品 进 行 查 询

所需的时间 。

通过对每次查询 中 单件商 品 记录数进行 比较 ，

可 知 在 该 结 构 下 针 对  

单 件 商 品 的 查 询 所 需 时 间 与 该 商 品 记 录 总 数 Ｍ 相 关 ， 时 间 复 杂 度 为 〇 Ｍ 。 在 应

（

）

用场景下 ，

由 于 商 品 总量较多 ，

全 部 商 品 记 录 总 数 Ｎ 的 增 长 速 度 和 数 据 规 模 均  

远 大 于 单 件 商 品 记 录 数 Ｍ 。

２ ２ ３ ．

．

数 据 存 储 规 则 的 改 进 与 设 计  

商 品流转信息被采集录入后 ，

需要通过哈希运算 、

数字签 名 生成 、

组 装 等 一  

系 列操作被封装成为商 品 信息块 ，

存储在本地数据库和有关节点 的数据库 中 。

与

典 型 的 公 链 和 联 盟 链 中 每 个 节 点 都 存 储 全 部 的 数 据 记 录 不 同 ， 本 文 所 述 的 区 块 链  

中 ， 数 据 按 照 以 下 规 则 存 储 ：  

１ ）

每 个 节 点 都 存 储 其 参 与 流 转 商 品 的 全 部 数 据 ， 而 每 件 商 品 的 信 息 数 据 仅  

存 储 在 与 之 相 关 的 节 点 中 。

２ ）

若一个节点是某商 品 流转过程 中 的最新节 点 ，

那 么 称 该 节 点 是 此 商 品 当

前 的 控 制 者 。 规 定 当 且 仅 当 某 节 点 是 某 商 品 的 控 制 者 时 ， 该 节 点 具 备 录  

入 该 商 品 信 息 的 权 限 。  

３ ）

每次商 品 信息数据产生时 ，

录入信 息 的节点将逐级

向 上 游 节 点 进 行 同 步 。  

上游节点在收到信息 后 ，

对 信 息进行校验 ，

校 验 通 过 后 将 数 据 存 储 在 本  

地 数 据 库 内 ， 并 继 续 将 信 息 向 上 发 送 ， 直 至 商 品 信 息 同 步 到 其 生 产 商 处 。

４ ）

商 品 控制者发生变化时 ，

新控制者需要 向 原控制者 申 请注册

注 册 通 过  

，

后 控 制 者 发 生 转 移 ， 信 息 录 入 权 限 也 随 之 转 移 。

１ ４  

第三章 基于 区块链技术 的商 品溯源系 统分析与研究



  

该规则 即 商 品流转过程 中 各环节对应 的数据 处理规则 。

在此规则 下 ，

与 某 商  

品 相 关 的 信 息 数 据 全 部 存 储 且 仅 存 储 在 与 之 相 关 的 供 应 链 成 员 节 点 处 ， 其 他 节 点

不 对 其 信 息 进 行 存 储 。 通 过 此 种 方 法 ， 能 够 保 障 商 品 信 息 不 被 过 度 暴 露 ， 同 时 减  

少 系 统 中 的 冗 余 数 据 。  

２ ３ ．

３ ．

正 确 性 分 析  

在 商 品 溯 源 系 统 中 引 入 区 块 链 进 行 商 品 流 转 信 息 数 据 存 储 的 目 的 在 于 防 止  

商 品 流 转 数 据 被 轻 易 捏 造 和 篡 改 。  

１ 捏 造 商 品 数 据 ）
捏 造 商 品 数 据 指 的 是 在 不 具 备 商 品 控 制 权 的 情 况 下 向 系 统 提 交 商 品 流 转 数  

据 。 由 于 每 个 节 点 处 都 存 储 有 该 节 点 处 理 过 的 商 品 的 全 部 流 转 信 息 记 录 ， 节 点 可  

以 通 过 查 询 商 品 记 录 获 知 该 节 点 的 当 前 控 制 者 。 不 具 备 控 制 权 的 节 点 录 入 的 信 息  

向 上 游 同 步 时 将 由 于 与 记 录 不 相 符 被 拒 绝 。 而 下 游 节 点 仅 在 收 货 时 向 上 游 节 点 请  

求 商 品 历 史 记 录 ， 其 余 时 间 同 步 的 记 录 也 将 被 拒 绝 。 网 状 结 构 中 较 多 的 哈 希 值 引  

用 和 系 统 中 记 录 权 由 商 品 流 转 过 程 决 定 的 数 据 存 储 规 则 共 同 提 高 了 用 户 捏 造 商

品 数 据 的 难 度 。  

此 外 商 品 信 息 块 中 含 有 通 过 节 点 私 钥 加 密 生 成 的 签 名 ， 在 私 钥 未 知 的 情 况 下  

破 译 并 伪 造 签 名 的 难 度 极 大 。 因 此 捏 造 商 品 数 据 的 情 况 在 系 统 中 能 够 得 以 防 范 。  

２ ）

事 后 篡 改 商 品 数 据  

篡 改 商 品 数 据 指 的 是 用 户 对 本 地 节 点 存 储 的 商 品 流 转 数 据 进 行 篡 改 。  

商 品 信 息 块 中 包 括 散 列 值 字 段 ， 散 列 值 生 成 的 过 程 是 不 可 逆 的 。 当 用 户 修 改  

商 品 信 息 块 中 的 商 品 信 息 时 ， 若 不 重 新 生 产 散 列 值 ， 则 会 使 散 列 值 与 具 体 信 息 不  

匹配 ，

从而导致修改后 的数据 失效 。

若 重新生 成散 列 值 ，

则 该 商 品 信 息 块 的 散 列

值 发 生 变 化 ， 将 引 发 系 统 中 对 该 信 息 块 进 行 了 引 用 的 其 他 信 息 块 失 效 。 由 于 商 品

流 转 数 据 存 储 在 该 商 品 供 应 链 上 的 全 部 成 员 节 点 中 ， 通 过节 点 间 记 录 的 对 比 能 够  

找 出 对 数 据 进 行 篡 改 的 节 点 。 此 外 ， 一 个 节 点 生 成 的 全 部 信 息 块 间 按 照 时 间 顺 序  

存 在 引 用 关 系 ， 篡 改 其 中 一 个 信 息 块 将 对 该 节 点 之 后 生 成 的 全 部 信 息 块 造 成 影 响 ，  

这 使 得 信 息 块 的 篡 改 成 本 升 高 ， 更 容 易 被 发 现 和 定 位 。  

３ ３ ． 本 章 小 结  

本 章 首 先 对 现 有 的 商 品 溯 源 系 统 结 构 进 行 了 分 析 ， 简 述 了 目 前 在 商 品 溯 源 系 统 中 区 块 链 技 术 应 用 存 在 的 不 足 和 问 题 ， 随 后 从 商 品 信 息 区 块 链 结 构 和 数 据 存 储 规 则 两 方 面 详 细 介 绍 了 针 对 商 品 溯 源 场 景 的 区 块 链 改 进 与 设 计 方 案 ， 通 过 实 验 对   比 了 改 进 方 案 与 传 统 区 块 链 结 构 进 行 商 品 信 息 查 询 时 耗 时 的 差 异 ， 结 合 设 计 原 理  
１ ５

北京邮 电大学工学硕士学位论文



  

和 实 验 结 果 说 明 了 方 案 能 够 提 高 商 品 溯 源 场 景 下 的 信 息 查 询 速 度 。 最 后 结 合 商 品 溯 源 场 景 对 该 方 案 的 正 确 性 进 行 了 阐 述 。  

１ ６  

第四 章 商品溯源原型 系统需求分析与概要设计



  

第 四 章 商 品 溯 源 原 型 系 统 需 求 分 析 与 概 要 设 计

本 章 结 合 前 文 对 商 品 溯 源 系 统 的 分 析 和 总 结 ， 对 基 于 商 品 信 息 区 块 链 的 商 品

溯 源 原 型 系 统 进 行 需 求 分 析 ， 明 确 原 型 系 统 的 各 类 需 求 ， 并 基 于 需 求 分 析 对 原 型

系 统 进 行 概 要 设 计 ， 介 绍 原 型 系 统 的 层 次 结 构 、 模 块 划 分 、 接 口 设 计 和 数 据 库 设  

计。

为 了 便于描述 ，

本章中均 以

统 “ 系

”

指 代 基 于 商 品 信 息 区 块 链 的 商 品 溯 源 原

型 统 系

。

４ ． １ 商 品 溯 源 系 统 业 务 场 景 分 析  

商 品 溯 源 系 统 旨 在 对 商 品 从 生 产 到 售 出 的 全 流 程 数 据 进 行 收 集 和 存 储 ， 并 对  

消 费 者 等 用 户 进 行 商 品 信 息 的 呈 现 。 不 同 类 型 的 商 品 在 生 命 周 期 中 经 历 的 详 细 流  

程存在不 同 ，

但总体可 以划分为生产 、

运输 、

分销 、

零售等环节 ，

部 分 情 况 下 还  

需 要 经 历 仓 储 和 质 检 等 过 程 。 商 品 溯 源 的 参 与 者 是 商 品 供 应 链 上 的 全 部 成 员 ， 包  

括 商 品 生 产 商 、 分 销 商 、 零 售 商 、 物 流 提 供 商 、 消 费 者 等 ， 有 时 还 需 要 考 虑 存 在  

二 手 商 品 交 易 的 情 况 。 现 有 的 区 块 链 系 统 大 多 面 向 或 起 源 于 代 币 场 景 ， 关 注 的 重  

点在于单次交易信息 、

账户 余额信 息等独立 、

单次 的 信 息 ，

使 用 此 类 区 块 链 系 统  

进 行 商 品 溯 源 信 息 的 存 储 时 ， 商 品 信 息 数 据 作 为 交 易 的 附 加 数 据 存 储 。 而 相 较 代  

币 场 景 而 言 ， 商 品 溯 源 场 景 下 用 户 更 关 心 商 品 流 转 的 全 流 程 信 息 ， 而 非 单 次 的 商

品转移信息 。

图 ４－ １

展示 了 一种商 品流转场景 ，

其 中 包括 了 商 品 的生产 、

销 售 、

运 输 等 环 节 ， 在 各 环 节 中 参 与 者 借 助 商 品 标 签 将 实 体 商 品 与 系 统 中 的 商 品 数 据 信

息 进 行 绑 定 ， 将 商 品 数 据 上 传 到 区 块 链 中 ， 同 时 也 能 够 通 过 区 块 链 及 时 地 查 询 商

数 据 品

。

一

一

一

一

Ｌ

Ｉ

＿

Ｌ ＿

Ｌ ＿

｜

｜

｜

商 品 流 转 数 据 ｋ 块 涟


 ｚ  ｙ

丨 、

？  

 Ｚ ，
一

、

１

、

、 、

、  

／ 提 据   流 转 数 义 Ｎ －

Ｕ

ｎｒ

、 、 、

、

、 、

、

｛

、  

 Ｚ   一

一

＇

、

Ｉ

、

、

＼

、  

？

Ｉ

   ■
＾

一

’

，

、   、  、  

Ｉ

 物 流

， 物

流



 物 流

ｓ  

Ｉ

生 产 商 仓 库 分 销 商  苓 售 商  消 费 荇  

包 装 质 份 —

— —

—  

图

４－ １

商 品 流 转 场 景  

１ ７

北京邮 电大学工学硕士学位论文



  

商 品 类 型 多 种 多 样 ， 用 户 对 各 类 商 品 数 据 的 关 注 点 也 不 尽 相 同 。 譬 如 针 对 食

品 类 商 品 用 户 更 为 关 注 商 品 的 生 产 流 程 、 原 材 料 来 源 ， 针 对 部 分 药 品 类 商 品 用 户  

可 能 更 为 关 注 商 品 的 运 输 渠 道 。 且 不 同 商 品 数 据 的 各 类 属 性 也 存 在 不 同 。 常 见 的

属性如操作人员 、

操作时 间 、

操作地点等 固 然能够采用 统一标准 ，

但 质 检 数 据 、

原 材 料 数 据 、 加 工 数 据 等 属 性 在 不 同 的 商 品 种 类 之 间 存 在 较 大 的 差 异 。 因 此 在 系  

统 中 数据的采集需要较为灵活 的定义方式 ，

具体 的数据属性应 由 用 户 进行定 义 ，

从而更好地满足用 户 需求 。

此外为 了 保障实体商 品 与 系统中 数据 的对应 ，

需 要 使

用 商 品 标 签 与 商 品 实 体 进 行 绑 定 ， 以 便 用 户 录 入 和 查 询 信 息 。  

４ ２ 原 型 系 统 需 求 分 析   ．

系 统 需 要 为 用 户 提 供 可 靠 的 商 品 流 转 信 息 查 询 服 务 。 在 现 实 的 商 品 流 转 场 景  

中，

有消 费者、

生产商 、

分销商 、

物流提供商 等 多 种 参与 者 ，

他 们 需 要 从 系 统 中  

获 取 种 类 繁 多 的 商 品 流 转 信 息 。 为 了 满 足 这 一 目 的 ， 系 统 需 要 提 供 以 下 功 能 ：

１ 用 户 管理功能 ： 方便 区 分 系统 中 不 同种类 的参与者并对其权限进行划 分

）

；

２ 信 息 查 询 功 能 ： 使 用 户 能 够 方 便 地 从 系 统 中 获 取 已 经 存 储 的 商 品 流 转 信 ）

息 ；  

３ ）

信 息 录 入 功 能 ： 使 商 品 的 位 置 、 操 作 时 间 、 操 作 人 、 商 品 状 态 等 信 息 能  

够及时被存储在 系统 中 ，

以便用户 的后续查询 ；

４ ）

商 品类型管理：

划分种类繁杂 的商 品 ，

便 于 用 户 进 行 商 品 信 息 的 查 询 和

录入 ；  

５ ）

商 品编码功能：

为商 品 分配唯一 的标识 ，

将 现 实 世 界 商 品 的 物 理 实 体 与

系统中 商 品信息这一逻辑实体建立映射 ，

便于商 品信息 的 查询 和录 入

；  

６ ）

数据 传输功 能 ：

使商 品数据能够在用 户 间共享 ；  

针 对 以 上 功 能 需 求 ， 系 统 将 其 整 合 为 四 类 基 本 功 能 ， 即 用 户 管 理 功 能 、 节 点

管理功能 、

商 品信息管理功能和商 品属性管理功能 ，

统 如 所 系 用 例 图 图 ４ － ２

示 。

商 品 溯 源 系 统  

⑴ 户 竹 理

图 ４ － ２ 商 品 溯 源 原 型 系 统 用 例 图
１ ８

第 四 章 商 品 溯源原 型 系统 需求 分析与 概要 设 计



  

在 满 足 基 本 的 功 能 需 求 之 外 ， 系 统 还 应 具 备 较 好 的 安 全 性 和 性 能 。 保 障 系 统 中 的 商 品 数 据 不 易 被 篡 改 、 能 且 仅 能 被 指 定 权 限 的 用 户 访 问 ， 系 统 承 载 较 多 用 户   的 同 时 使 用 并 稳 定 地 为 用 户 提 供 服 务 。  

４ ２ ．

１ ．

原 型 系 统 功 能 性 需 求  

系 统 主 要 包 括 用 户 管 理 、 节 点 管 理 、 商 品 信 息 管 理 和 商 品 属 性 管 理 四 类 功 能 。  

１ 用 户 管 理 功 能   ）
现 实 场 景 中 商 品 的 流 转 过 程 需 要 涉 及 生 产 商 、 分 销 商 、 物 流 公 司 、 零 售 商 、   消 费 者 乃 至 二 手 市 场 等 多 种 角 色 ， 且 根 据 商 品 类 型 的 不 同 ， 牵 涉 的 用 户 类 型 也 不 尽 相 同 。 因 此 系 统 中 将 其 抽 象 为 三 类 用 户 角 色 ， 即 系 统 管 理 员 、 商 品 管 理 员 和 普   通 用 户 。 不 同 的 用 户 角 色 对 系 统 有 着 不 同 的 权 限 ， 系 统 为 之 提 供 的 功 能 也 各 不 相 同 。 其 中 系 统 管 理 员 能 够 对 其 他 两 类 用 户 进 行 管 理 ， 包 括 创 建 和 删 除 用 户 、 管 理   自 身 及 非 系 统 管 理 员 的 用 户 信 息 、 修 改 非 系 统 管 理 员 用 户 的 权 限 等 。 商 品 管 理 员 和 普 通 用 户 在 用 户 管 理 功 能 中 的 权 限 并 无 差 别 ， 都 仅 具 备 管 理 个 人 信 息 的 权 限 。   用 户 的 个 人 信 息 包 括 联 系 电 话 和 备 注 信 息 等 。 用 户 管 理 功 能 用 例 图 如 图 ４ ３ － 所 示 。
商 品 溯 源 系 统  

 ｇ Ａ

〉   Ｃ

ｉ 其 他 用 广 ｉｇｊ

麗 商

＾  

Ａ

Ｌ — ，

二 杜 础 功 能

＾５￣ “ 包 含

Ｓ ３  ＇

改 备 丨Ｏ  

＇  
普）

图 ４ ３ － 用 户 管 理 用 例 图
无 论 是 哪 一 类 用 户 ， 都 必 须 拥 有 相 应 的 账 号 并 成 功 登 录 后 才 能 使 用 系 统 。 未 拥 有 账 号 的 用 户 在 第 一 次 使 用 系 统 时 需 要 进 行 注 册 。 用 户 在 注 册 时 必 须 输 入 自 定 义 的 账 号 和 密 码 ， 其 中 账 户 不 得 与 系 统 中 己 存 在 的 其 他 用 户 重 复 ， 否 则 系 统 将 给   予 提 示 并 拒 绝 用 户 此 次 的 注 册 请 求 。 自 行 注 册 的 账 户 默 认 权 限 为 普 通 用 户 ， 若 需 要 修 改 权 限 ， 则 需 要 由 系 统 管 理 员 进 行 操 作 。 用 户 在 登 录 时 需 要 填 写 账 号 和 密 码 ，   系 统 对 其 验 证 无 误 后 用 户 方 可 使 用 系 统 服 务 。 系 统 管 理 员 对 其 他 用 户 的 信 息 进 行 修 改 时 ， 首 先 对 待 修 改 的 用 户 信 息 进 行 查 询 ， 随 后 提 交 修 改 后 的 信 息 到 系 统 ， 系  
１ ９  

北京邮 电大学工学硕士学位论文



  

统 将 把 修 改 结 果 返 回 到 页 面 。 用 户 在 对 个 人 信 息 进 行 修 改 时 则 需 要 进 入 个 人 信 息

页面 ，

填 写 相 应 信 息 并 提 交 信 息 。  

２ 节 点 管 理 功 能 ）
系 统 中 商 品 流 转 数 据 以 区 块 链 的 形 式 存 储 ， 需 要 在 多 个 供 应 链 成 员 处 设 置 节   点 进 行 数 据 的 备 份 ， 商 品 流 转 数 据 也 需 要 在 节 点 间 进 行 传 输 共 享 。 因 此 各 节 点 间 需 要 建 立 通 信 。 节 点 管 理 功 能 旨 在 帮 助 系 统 各 节 点 间 建 立 通 信 并 传 输 数 据 具 体
，
表 现 为 对 节 点 信 息 的 管 理 。 用 户 仅 在 有 系 统 管 理 员 权 限 时 才 能 使 用 该 功 能 。 该 功   能 用 例 图 如 图 ４－４ 所示 。
  
商 品 溯 源 系 统  

Ｃ 新 增 节 点 信 息   
￥   〇 除 节 点 丨

 ｌＬ

— ￣￣
￣

ｉ

系 统 管 理 ｗ  

节点倍

—  

互） 询 节 点 仏

￥＾ 改 备 注 倍  

图 ４ － ４ 节 点 管 理 用 例 图

节 点 管 理 功 能 主 要 包 括 新 增 节 点 信 息 、 修 改 节 点 信 息 、 删 除 节 点 信 息 和 查 询

节点信息 。

节点 信息包括节点 的 ＩＰ 地址 、

公钥信 息 、

节点名 称和备注信 息等 ，  

其 中 公钥信 息和节点 名 称共 同组成节点 的 唯一标识 ，

各节点 间 不允许重复 ，

一 经  

确 定 就 不 能 修 改 。 在 新 建 节 点 时 用 户 需 要 输 入 节 点 的 Ｉ Ｐ 地 址 、 公 钥 和 节 点 名 称  

等信息 ，

信息缺失或有误时系统将拒绝用 户 的请求 。

用 户 可 以 对 己 经 录 入 的 节 点

Ｉ Ｐ 地 址 和 备 注 信 息 进 行 修 改 。  

３ 商 品 信 息 管 理 功 能 ）
商 品 信 息 管 理 功 能 包 括 对 商 品 流 转 信 息 的 录 入 功 能 和 查 询 功 能 是 系 统 的 核 ，

心 功 能 。 其 中 商 品 录 入 功 能 仅 有 具 备 管 理 员 权 限 的 用 户 （ 包 括 系 统 管 理 员 和 商 品

管 理 员 ） 才 能 使 用 ， 而 商 品 信 息 查 询 功 能 则 对 系 统 的 全 体 用 户 开 放 。 其 用 例 图 如

图 所 示 ４ ５ －

。  

２ ０



第 四 章 商 品 溯源 原 型系统需求分析与 概要设 计
  

商 品 溯 源 系 统  
〇  

 Ｌ

商 品 －  

 ＾   Ｉ
＼＼  ＾ ＾ 系 统 管 ｓｌ

一

—

吣一
ｙ

品信总

、－

－

＜

  ￣   

＾

 ｎ －

生 产 ｆ３ ｉ

＞

 〇

）  ｃ

一  ＝ＨＬ  

   ｌ

＼

ｉ

ｌ

＼

交收货 倍

￣

＿＿

＿

＾  商 品 賴 员 ＜

５ 交 记 录  

）  

〇 一 ＂ ＂ ＂ ＂ ＂   ＂
＾
ｒ



  

１

＾ ｍ  ．

．

普 通 用 户  ＾ ｉ

Ｆ４ ７ ｈ５

＞

＾

图 ４ ５ － 商 品 信 息 管 理 用 例 图

在 现 实 场 景 的 商 品 生 命 周 期 中 ， 用 户 会 对 商 品 产 生 生 产 、 检 验 、 运 输 、 出 售 、 购 买 等 多 种 操 作 ， 而 每 种 操 作 场 景 下 都 有 可 能 需 要 对 商 品 信 息 进 行 录 入 ， 考 虑 到 过 程 中 商 品 的 状 态 及 商 品 控 制 者 的 变 化 ， 可 以 将 需 要 商 品 信 息 录 入 的 场 景 划 分 为

以 下 四 类 基 本 场 景 ：

ａ 生 产 商 品 ： 一 件 商 品 从 无 到 有 的 过 程 ， 也 是 商 品 生 命 周 期 的 起 点 ； ）

ｂ

发送商 品 ：

商 品 的控制 者权限 发生转移 ，

但 尚 未完成 ；

）

Ｃ 接 收 商 品 ： 商 品 的 控 制 者 权 限 完 成 转 移 ；   ）

ｄ 处 理 本 地 商 品 ： 商 品 的 控 制 者 权 限 不 发 生 转 移 ， 但 可 能 由 于 清 点 、 检 验   ）

等 操 作 的 进 行 需 要 产 生 商 品 信 息 的 录 入 。  

在 以 上 四 类 场 景 下 用 户 需 要 录 入 的 商 品 信 息 可 能 存 在 较 大 差 异 ， 因 此 系 统 需

要 针 对 不 同 场 景 为 用 户 提 供 相 应 的 商 品 信 息 录 入 服 务 。 录 入 商 品 信 息 时 ， 仅 商 品

当 前 的 控 制 者 能 够 将 商 品 的 信 息 录 入 系 统 ， 而 不 具 备 商 品 当 前 控 制 权 的 其 他 用 户

提 交 的 录 入 请 求 都 应 该 被 系 统 拒 绝 。 在 商 品 的 发 送 接 收 过 程 中 ， 商 品 的 信 息 应 当

是 无 法 被 录 入 的 。   针 对 生 产 商 品 场 景 下 的 信 息 录 入 ， 用 户 需 要 选 取 待 录 入 商 品 的 类 型 ， 并 按 照
提 示 录 入 相 应 的 信 息 。 成 功 提 交 信 息 后 ， 用 户 能 够 获 取 该 商 品 的 标 识 码 ， 以 便 进   行 后 续 操 作 ， 其 流 程 如 图 ４ － ６ 所 示 。 而 其 他 三 类 场 景 下 ， 用 户 都 是 针 对 己 经 获 取 到 的 实 体 商 品 进 行 信 息 录 入 ， 因 此 用 户 首 先 需 要 扫 描 商 品 上 附 着 的 二 维 码 ， 将 二   维 码 提 交 到 系 统 后 选 择 商 品 类 型 ， 根 据 提 示 输 入 待 录 入 的 商 品 信 息 ， 最 终 将 商 品 信 息 提 交 到 系 统 。 用 户 录 入 的 商 品 信 息 被 写 入 区 块 链 中 ， 存 储 在 符 合 要 求 的 节 点

处 。

２ １

北京邮 电大学工学硕士学位论文



  



 商 品 溯 源 系 统  


？  

（

选择录 入的 品 佶息类型 ，

）  

是 否 商 品 生 产 倍 息

＾ ＇ ＾ ＇ ＇ ＇

提交商 品 二维码

＜ 
）

识 别 商

维 码 ：

）

＾ｙ

ｆ

＾
－
＾ ＿ ！ ｆ ｅｓ＝

＿ ＿＿ ＿
＾   ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＿ ＾

Ｃ＆ Ｗｍｍ ＷＪ

＜  
＂ 一 ＂  



迕 询 商 品 秃 喟 对 应 的 Ｍ ｆｆ ｅ 信 息

）  

（ 选 择类 型 ）

＾

￣



  

   ｛  － 

返回 厲性列表

）





埤写商 品魚忭 通
（

￣￣
 ＜ 一  

检 冇 数 据 完 幣 性 、

＾ Ｋ ／ Ｊ ，

、

ｒ

 ｍｎＥ

ｍ ｉｍ ）

 ／

，

￣

，



—


 

（

 ＇  
返 Ｎ结果



）  

图 ４ － ６ 商 品 信 息 录 入 活 动 图

此 外 ， 每 一 条 被 录 入 的 商 品 流 转 信 息 都 应 该 具 备 准 确 的 时 间 记 录 和 相 应 的 操  

作 人 记 录 ， 以 便 保 障 数 据 的 真 实 性 和 可 追 溯 。  

针 对 商 品 信 息 的 查 询 可 能 发 生 在 商 品 生 命 周 期 的 任 意 时 刻 。 用 户 可 能 通 过 扫  

描 商 品 上 的 二 维 码 标 识 或 者 直 接 输 入 商 品 编 码 进 行 对 商 品 流 转 信 息 的 查 询 。 因 此  

系统需要对其分别进行处理 ，

保障 用 户 无论使 用 哪种方法 ，

都 能 获 取 到 正 确 的 商

品 流 转 信 息 。

４ 商 品 属 性 管 理 功 能   ）

现实场景 中 商 品 多种多样 ，

每种商 品 的关键属性不尽相 同 ，

商 品 流 转 过 程 中

产 生 的 信 息 也 种 类 繁 多 。 如 果 没 有 相 应 的 规 范 和 引 导 ， 用 户 很 难 做 到 快 速 、 方 便

地录入商 品流转信息 。 为 了 使用 户 在录入商 品 信 息 时 能够正 确 并方便地输 入信 息 ，  

管 理 员 需 要 对 系 统 中 可 能 需 要 录 入 的 商 品 类 型 及 其 属 性 信 息 进 行 管 理 。 因 此 系 统  

需 要 提 供 相 应 的 商 品 属 性 管 理 功 能 来 辅 助 管 理 员 进 行 操 作 。 商 品 属 性 管 理 功 能 的

例 如 所 示 用

图

图 ４－７

。

２ ２  

第 四 章 商 品 溯源原型 系统需求分析与 概要设计



  

商 品 溯 源 系 统  

 〇

商 品

一



｛



＇包汽 ，
一

   

一

１

  －
１

＿＿＿

？
品 鉍性－

＿？

、

除商品属

＼／ 丄 、 
系统管

？
＇ 钕 岔，
、 於 〉

＾  
属 忤 取 值 ＾

  ／ ＼

商 品

＾

Ｐ ／ ＼ （ ＼

－

－

＾ ＜＾＾￥ ： 二 
Ｉ

 商 Ｗ 苷 ｉｌ 员 ， ，

  ＾

一

一

饱） ＞

：二

、

、

、

邮、

＇
ｌｉ 賴 品 类 ｉ
商品

  
ｚ
舰 的

图 ４ － ７ 商 品 属 性 管 理 用 例 图
商 品 属 性 管 理 功 能 需 要 用 户 在 商 品 管 理 员 或 系 统 管 理 员 权 限 下 才 能 使 用 。 借 助 该 功 能 管 理 员 可 以 对 需 要 录 入 的 商 品 类 型 及 其 对 应 属 性 进 行 管 理 。 该 功 能 具
，
体 包 括 商 品 类 型 的 新 增 、 删 除 、 修 改 、 查 询 和 具 体 商 品 属 性 的 新 增 、 删 除 、 修 改 和 查 询 。 其 中 商 品 属 性 即 为 用 户 录 入 商 品 流 转 信 息 时 实 际 需 要 输 入 的 信 息 ， 一 个   商 品 类 型 应 包 含 至 少 一 条 商 品 属 性 。  

４ ２ ２ 原 型 系 统 非 功 能 性 需 求

．

．

系 统 的 非 功 能 性 需 求 主 要 包 括 安 全 性 需 求 和 性 能 需 求 等 。

安 全 性 需 要 主 要 针 对 用 户 和 数 据 两 方 面 。 用 户 方 面 需 要 进 行 用 户 的 身 份 认 证   和 用 户 信 息 的 加 密 存 储 。 用 户 在 使 用 系 统 前 需 要 进 行 登 录 ， 在 用 户 使 用 系 统 功 能   时 系 统 也 需 要 对 用 户 的 身 份 再 次 进 行 校 验 。 此 外 为 了 避 免 非 法 登 录 和 用 户 信 息 的

泄 露 系 统 对 存 储 的 用 户 信 息 需 要 进 行 相 应 的 加 密 处 理 。 同 时 系 统 还 需 要 控 制 一   ，
个 账 号 同 时 只 能 被 一 个 用 户 使 用 ， 避 免 单 账 号 多 用 户 在 线 的 情 况 发 生 。 针 对 数 据

则 需 要 保 障 数 据 录 入 的 真 实 性 和 数 据 存 储 的 安 全 性 。 数 据 录 入 时 系 统 需 要 对 录 入  

节 点 的 信 息 和 录 入 用 户 的 信 息 进 行 校 验 ， 避 免 非 法 数 据 的 录 入 。 针 对 已 经 录 入 系

统 的 数 据 ， 系 统 则 采 取 多 备 份 、 数 字 签 名 等 区 块 链 相 关 技 术 保 障 数 据 难 以 被 篡 改 。 性 能 需 求 方 面 ， 系 统 应 及 时 响 应 用 户 的 请 求 ， 并 反 馈 正 确 的 请 求 结 果 。 在 保  

证 系 统 数 据 安 全 性 的 同 时 ， 降 低 节 点 的 数 据 存 储 量 ， 合 理 设 计 数 据 存 储 结 构 ， 可  

使 系 统 更 好 地 满 足 性 能 需 求 。

２ ３

北京 邮 电大学工学硕士学位论 文



  

此外 系统还应该具备一定 的可靠性 ，

需 要 对 可 能 产 生 的 异 常 进 行 相 应 的 预 防

措 施 和 处 理

。  

４ ３ 原 型 系 统 整 体 结 构 ．

本 文 所 述 的 商 品 溯 源 原 型 系 统 使 用 了Ｂ ／Ｓ 架 构 。 Ｂ ／ Ｓ 架 构 具 有 访 问 方 便 的 优  

点 。 系 统 被 划 分 为 前 端 页 面 （ 浏 览 器 ） 部 分 和 后 端 服 务 器 部 分 。 前 端 部 分 负 责 为

用 户 提 供 可 视 化 的 交 互 界 面 ， 方 便 用 户 访 问 系 统 提 供 的 各 类 服 务 。 后 端 部 分 根 据  

商 品 供应链情况 ，

由 一个或多 个服务器节点组成 ，

节 点 需 要 完 成 数 据 的 存 储 和 同  

步 。 每 个 服 务 器 节 点 包 括 Ｗｅ ｂ 服 务 器 和 本 地 数 据 库 ， Ｗｅ ｂ 服 务 器 负 责 为 前 端 提

供 服 务 支 持 ， 本 地 数 据 库 则 负 责 进 行 数 据 的 存 储 。 每 个 服 务 器 节 点 通 过 Ｔ Ｃ Ｐ 协

议与 其他 的 服 务器节点进行数据 交互 。

前端 则通过访 问

接 ＲＥ Ｓ Ｔ ｆｕ ｌ

口 ，

借 助  

Ｈ Ｔ Ｔ Ｐ 协 议 向 后 端 请 求 服 务 。 后 端 的 多 个 服 务 器 节 点 应 部 署 在 商 品 供 应 链 上 的 各

个 参 与 者 处 ， 共 同 完 成 商 品 信 息 的 存 储 。 系 统 拓 扑 结 构 如 图 ４ ８ － 所 示 。

＆ ＬｊＳ

Ｊ  

 Ｓ？

服 务 器  

ｆ

｜

ｃｂ  Ｓ ｆ

Ｉ  Ｉ  

｜

｜

（

 ｍ Ｏ

  ｉ ＝ ａａ

 Ｌ 据 座 Ｊ

、

Ｔ Ｃ ｜ 

Ｐ  ｉ

， 国

＿




服 务 器 节 点  

＇

＇

＇

 Ｔ １

１１

  團ｐ  ｐ 服

－
／＝
，
Ｉ ｉ 

＇ ＇
—

Ｒ ｐ —
＜

， —
＾



Ｓ ｉ ｎ  
｜   ．

＾ ｆ ｅｌ ｌ  

 ｕｍ ｊ

Ｌｉｊｕ

＼  浏 览 器

Ｕ Ｊ  用 面 —－

ｉ

］

（

户界

）

图 ４ ８ － 系 统 拓 扑 图

系统在技术架构上使用 了 分层 的方法进行划 分 ，

主要分为应用层 、

控 制 层 、

业务逻辑层 、

数据持久化层等 四层 。

为了 方便描述 ，

后 文 中 将 应 用 层 称 为 前 端 部  

分 ，

其余三层称 为后 端部 分 。

系 统 的 层 次 结 构 如 图 ４ － ９ 所 示 。

２ ４  

第 四 章 商 品溯源原 型 系统需求分析与 概要设计



  

？
应 ＿  川 户 猝 ＿  （ ｉ 螨 災 曲 ）  

 功 能 柃 制 此 务 拎 制

｜

  ＾   控 制 接

户 賴节 点管理

ｙ ，
，

＋
ｔ

＿￣

商品 信总斌入

｜

］

商品倍总査询

｜

１  

｜

  Ｆ   用 户 皆 理 模 块

Ｈ ｉ ｖ 点 皆 埤 模 块
 ｜


｜

ｉｉ Ｉ 彳｜ 穴 理

｜

商 品 ｆｓ 总 录 入



￣


ｍ ｆ ±

Ｈ

商 品 （２ ￡ 企 询

｜





｜

｜

｜

１

１

｜  

   ｍ ｒ ＾ ｗ ｍ

点 ｖ丨

录

入

｜

｜

＾＾



—＿



 氽

—    

｜

  ＊ 务 逻 辑 Ｓ

Ｆ ｇ ＾ －

！

Ｊ Ｉ

，

丨

  观

＇

 ｔ

＜
１

Ｋ 块 铳 辋 肋 模 块  

Ｉ

     用 广 （３ Ｓ

Ｖ 点》 綠

；

｜

＾｜

ｌｌｇ ＾

１

 ｜

［

］  

 节 点 询    Ａ Ａ   —

Ｓ







ｉｒ ＂

Ｓ ａｉ


１

１

１

 ｜

与 （ 丁 

Ｈ 丁 ； ｄ

ｎ 



？？

？ Ｍ ■ 

ｔ

 Ｋ Ｊ

功

能

数雄

？？

储校块

也务

数 据 存 硓 校 块

 ／ 、

＾ 、







ｉ Ｌ ｉ   

 数 獅

又 系 ＃ 数 据 库 善 又 系 哨 数 据 库  

图 ４ － ９ 系 统 架 构 设 计 图

应 用 层 即 前 文 所 述 的 前 端 页 面 部 分 ， 负 责 与 用 户 的 直 接 交 互 。 应 用 层 将 通 过  

访 问 相 应 的 Ｕ Ｒ Ｉ 调 用 控 制 层 提 供 的 接 口 ， 使 用 户 能 够 正 常 使 用 系 统 提 供 的 服 务 。  

控 制 层 主 要 负 责 业 务 控 制 和 功 能 控 制 ， 对 前 端 的 服 务 请 求 进 行 相 应 的 分 发 处  

理 。 其 中 业 务 部 分 针 对 商 品 数 据 的 查 询 和 录 入 等 业 务 功 能 ， 调 用 业 务 逻 辑 层 中 的

商 品 信 息 模 块 。 功 能 部 分 则 针 对 节 点 管 理 、 商 品 属 性 管 理 等 系 统 管 理 功 能 ， 调 用

业 务 逻 辑 层 中 的 用 户 管 理 模 块 、 节 点 管 理 模 块 和 商 品 属 性 管 理 模 块 。 在 收 到 应 用

层 的 请 求 后 ， 控 制 层 会 对 请 求 及 用 户 输 入 的 数 据 进 行 处 理 ， 并 调 用 业 务 逻 辑 层 的

方 法 相 应

。  

业 务 逻 辑 层 包 括 用 户 管 理 、 节 点 管 理 、 商 品 属 性 管 理 和 商 品 信 息 管 理 四 个 具

体 的 功 能 模 块 ， 和 一 个 辅 助 性 模 块 ， 即 区 块 链 辅 助 模 块 。 用 户 管 理 模 块 负 责 用 户

的 登 录 、 注 册 、 信 息 管 理 、 权 限 验 证 等 。 节 点 管 理 模 块 负 责 对 系 统 中 其 他 服 务 器  

节 点 的 信 息 进 行 记 录 和 维 护 ， 包 括 对 节 点 信 息 的 新 增 、 查 询 、 删 除 和 修 改 等 ， 以  

备 系 统 通 信 和 用 户 使 用 。 商 品 属 性 管 理 则 负 责 对 商 品 类 型 信 息 和 商 品 属 性 信 息 两

类 信 息 进 行 管 理 ， 协 助 用 户 完 成 商 品 流 转 信 息 的 录 入 。 用 户 管 理 模 块 、 节 点 管 理  

模 块 、 商 品 属 性 管 理 模 块 将 调 用 数 据 持 久 化 层 中 的 功 能 数 据 存 储 模 块 提 供 的 相 应

接 口 。 商 品 信 息 管 理 模 块 负 责 提 供 商 品 流 转 信 息 的 查 询 和 录 入 功 能 ， 此 外 还 需 要  

负 责 信 息 录 入 、 查 询 过 程 中 商 品 二 维 码 的 生 成 和 识 别 。 系 统 中 商 品 流 转 数 据 以 区

块 链 的 形 式 存 储 ， 为 了 完 成 这 一 目 标 ， 商 品 信 息 管 理 模 块 需 要 区 块 链 辅 助 模 块 的

支 持 。 录 入 商 品 流 转 信 息 时 ， 商 品 信 息 管 理 模 块 将 用 户 录 入 的 商 品 流 转 信 息 提 交

２ ５

北京邮 电大学工学硕士学位论文



  

到 区 块 链 辅 助 模 块 ， 区 块 链 辅 助 模 块 负 责 将 具 体 的 商 品 流 转 信 息 经 过 散 列 值 运 算 、

签 名等处理 ，

封装成为商品 信息块 ，

并将商品 信息块在各节点间进行传输，

最 终  

完 成 节 点 间 商 品 信 息 数 据 的 同 步 ， 保 障 每 个 节 点 中 都 存 储 有 全 部 与 之 相 关 的 商 品

流转信 息 。

查询 商 品 流转信 息 时 ，

需要通过 区块链辅助模块对 区块链进行查询 ，  

并 将 查 询 到 的 商 品 信 息 块 传 递 到 商 品 信 息 管 理 模 块 。 区 块 链 辅 助 模 块 将 调 用 数 据  

持 久 化 层 中 业 务 数 据 存 储 模 块 提 供 的 相 应 接 口 ， 商 品 信 息 管 理 模 块 则 通 过 调 用 区

块 链 辅 助 模 块 提 供 的 接 口 进 行 数 据 的 存 储 和 查 询 。  

数 据 持 久 化 层 主 要 负 责 对 数 据 进 行 存 储 。 系 统 中 涉 及 的 数 据 主 要 包 括 两 类 ，

即 业 务 数 据 和 功 能 数 据 。 业 务 数 据 指 的 是 商 品 流 转 信 息 数 据 这 部 分 数 据 在 商 品 ，

生 产 、 交 易 、 运 输 的 过 程 中 产 生 ， 由 用 户 录 入 至 系 统 ， 系 统 对 数 据 进 行 处 理 ， 并  

以 区 块 链 的 形 式 存 储 。 功 能 数 据 则 指 的 是 账 号 信 息 、 服 务 器 节 点 信 息 、 商 品 属 性

信 息 、 商 品 类 型 信 息 等 用 于 维 护 系 统 功 能 的 数 据 和 信 息 。

４ ４ 原 型 系 统 功 能 模 块 划 分 ．

系 统 在 功 能 上 被 划 分 为 用 户 管 理 模 块 、 节 点 管 理 模 块 、 商 品 信 息 管 理 模 块 、

商 品属性管理模块、

区块链辅助模块等五 个模块 ，

其 中 前 四 个 模 块 面 向 用 户 直 接

的功能需求 ，

区块链辅助模块用 以对数据进行封装和 存储 ，

从 而 保 障 系 统 中 的 数  

据 难 以 被 篡 改 。 面 对 不 同 类 型 的 商 品 时 ， 用 户 只 需 要 借 助 属 性 管 理 模 块 进 行 相 应  

的 设 置 和 组 合 ， 而 不 必 关 注 区 块 链 部 分 。 在 系 统 中 区 块 链 部 分 起 到 存 储 数 据 的 作

用，

类似于传统溯源 系统中 的 中 心化数据库组件 。

其 体 情 所 具

况 如 图 ４ ０ － １

示 。  

商 砧 溯 源 系 统  

 Ｉ





  

 ”  ，

 ”  ”  
ｙ



用 户 资 理 漠 块 节 点 ？ 理 模 块  商 品 佔 ￡ 管 理 模 块 商 品 敁 性 管 理 模 块  Ｋ 坎 链 辅 助 模 块

Ｖ    ｉ

＾

ｉ

ｊ

商品信怠 商品

＇



ｉ

１

－

－

－

ｐ

ｎｆ

，

Ｉ

｜

｜

，  

 Ｓ  尕   ▼  ｔ  ▼  ▼  ▼  ｔ  ▼  ▼

ｆｌ

ｉ

］

入

加密

ｍ

ｈ
＼





ｉ

 商 品 属  商 品 类  Ｊ Ｌ Ｒ ｒ  －

－ ，

１

￣

￣

Ｔ Ｈ－  Ｔ ．



Ｊ  

Ｉ

－

－

ｊ
｜

ｐ －

Ｒ ｉ Ｍ ｆＳｉ ｆ ｌ＾ ｍ

ｎ Ｈ ｖ 

ｆ





ｒ

Ｌ ？ ｆ 



．

登总Ｈ控

 录 ＿ Ｕｉ  查

￥Ｈ 二

３ｆ ｍ 新 ＿ Ａ 改 新 ＿ ｆ 改 蓄 ｓ  ｇ  ｜ 录 查  

ｉ  Ｈ  ＿  人 新 Ｋ ： 甸 丨 ｉ ｉｆ
Ｕ Ｕ Ｕ Ｕ Ｕ Ｕ Ｕ巴 ｕ Ｈ ｍ  Ｕ Ｕ Ｕ Ｕｍ Ｕ Ｓ Ｂ ０ Ｕ Ｌ Ｉ

３

＾３

ｗｓ

５ｉｆｆｆｆ

Ｌ Ｉ

！Ｊ

ｕｕ〇

增 除 仰 喊 增 除 询 矣 ：：

？ 属 属 件ｍ ｗ 性性性偵 型型型信

ａ 兰

Ｌ

ｉ！Ｊ

ｊＪ

ｈｆ 芒
值 ， 豈 管 ＆ｆ

入 拘
Ｌ

图

４ ０ － １

系 统 功 能 模 块 划 分 图

２ ６  

第 四 章 商 品溯源原型 系统需求分析与 概要设计



  

４ ４ ．

．１

用 户 管理模 块  

用 户 管 理 模 块 包 括 用 户 的 注 册 、 登 录 、 用 户 对 个 人 信 息 的 查 询 和 修 改 、 管 理  

员 对 其 他 用 户 信 息 的 查 询 和 修 改 及 用 户 在 请 求 服 务 时 的 权 限 控 制 。 根 据 需 求 分 析 ，  

系 统 中 的 用 户 角 色 被 划 分 为 三 类 ： 系 统 管 理 员 、 商 品 管 理 员 和 普 通 用 户 。 不 同 的

用 户 角 色 能 够 使 用 的 系 统 功 能 各 不 相 同 。  

４４２

．

．

节 点 管理模块  

系 统 中 的 每 个 节 点 具 备 一 组 成 对 的 密 钥 ， 用 于 通 信 和 数 据 录 入 时 的 身 份 验 证 。  

其 中 公 钥 信 息 向 系 统 中 的 其 他 节 点 公 开 ， 私 钥 信 息 则 仅 由 该 节 点 保 存 。 为 了 与 其  

他 节 点 进 行 数 据 的 传 输 和 同 步 ， 系 统 中 的 节 点 需 要 将 其 他 节 点 的 Ｉ Ｐ 地 址 、 名 称 、  

公 钥 等 信 息 存 储 在 本 地 数 据 库 中 。 节 点 管 理 模 块 负 责 对 本 地 存 储 的 其 他 节 点 信 息  

进 行 新 增 、 删 除 、 修 改 和 查 询 等 操 作 。  

新 增 节 点 信 息 时 用 户 需 要 提 交 节 点 名 称 、 节 点 Ｉ Ｐ 地 址 、 节 点 公 钥 等 必 要 信

息 ，

系统将 自 动记录创建时间 等信 息 。

其 中 节 点 名 称 和 节 点 公 钥 是 标 识 一 个 节 点

的 唯 一 凭 证 ， 提 交 之 后 就 无 法 再 次 进 行 修 改 。 节 点 Ｉ Ｐ 地 址 和 备 注 信 息 则 可 以 进  

行 修 改 更 新 。 更 新 后 系 统 将 自 动 保 存 更 新 信 息 的 时 间 记 录 。

针 对 节 点 信 息 的 各 类 操 作 都 需 要 系 统 管 理 员 权 限 才 能 进 行 ， 在 用 户 进 行 相 关  

操作 时 ，

系统会对用 户 的权限进行校验 ，

校 验 通 过 后 操 作 才 能 正 常 进 行 。  

４ ４ ．

３ ．

商 品 信 息 管理模块  

商 品 信 息 管 理 模 块 包 括 商 品 信 息 查 询 子 模 块 、 商 品 信 息 录 入 子 模 块 和 二 维 码  

管 理 子 模 块 。

商 品 信 息 查 询 子 模 块 需 要 实 现 扫 码 查 询 和 按 商 品 Ｉ Ｄ 査 询 两 个 子 功 能 。 用 户

可 以 通 过 提 交 商 品 实 体 上 附 着 的 二 维 码 标 签 图 片 或 直 接 输 入 商 品 Ｄ Ｉ 来 查 询 商 品

的 全 部 流 转 信 息 ， 信 息 按 照 时 间 顺 序 从 新 到 旧 排 列 。  

商 品 信 息 录 入 子 模 块 需 要 实 现 生 产 信 息 录 入 、 发 货 信 息 录 入 、 收 货 信 息 录 入  

和 记 录 信 息 录 入 四 个 子 功 能 。 如 果 一 件 商 品 当 前 位 于 某 个 服 务 器 节 点 所 在 的 组 织  

处 那 么 该 节 点 即 该 商 品 当 前 的 控 制 者 。 只 有 商 品 当 前 控 制 者 所 辖 的 用 户 能 够 进 ，

行 对 该 商 品 的 信 息 录 入 。 此 外 ， 商 品 信 息 的 录 入 还 需 要 用 户 具 备 商 品 管 理 员 或 系

统 管 理 员 权 限 。 商 品 信 息 录 入 后 将 被 封 装 为 商 品 信 息 块 ， 以 区 块 链 的 形 式 进 行 存  

储 。

二 维 码 管 理 子 模 块 则 负 责 商 品 标 识 二 维 码 的 生 成 和 识 别 。 二 维 码 是 实 体 商 品

与 系统 中 数据绑定 的工具 ，

与 实 体 对 应 商 品 一 一

。  

４４４

．

．

商 品 属 性 管理 模块

２ ７  

北京邮 电大学工学硕士学位论文



  

商 品 属 性 管 理 模 块 是 对 商 品 信 息 管 理 模 块 的 辅 助 模 块 ， 设 置 该 模 块 的 主 要 目

的 在 于 方 便 商 品 信 息 的 录 入 流 程 。 该 模 块 功 能 的 使 用 需 要 系 统 管 理 员 或 者 商 品 管

理 员 权 限 。 该 模 块 具 体 包 括 对 商 品 属 性 和 商 品 类 型 的 管 理 功 能 ， 即 对 商 品 属 性 和

商 品 类 型 的 创 建 、 删 除 、 更 新 和 查 询 。  

商 品属性包括

Ｄ Ｉ

、

名 称、

类型、

取值范围等具体信息 。

其 中 名 称 和 类 型 需 要

在 创 建 商 品 属 性 时 由 用 户 录 入 ， 商 品 属 性 的 Ｉ Ｄ 则 由 系 统 自 动 生 成 。 商 品 类 型 信  

息中除

Ｄ Ｉ

、

名 称等常规信 息外 ，

还包括该类型商 品 应具备的属 性 ，

每 个 商 品 类  

型 至 少 包 含 一 条 商 品 属 性 。  

在对商 品属性和商 品类型进行管理时 ，

都需要先对用户 的身份进行校验 ，

只  

有 具 备 商 品 管 理 员 或 者 系 统 管 理 员 权 限 的 用 户 才 能 进 行 使 用 相 应 的 功 能 。 删 除 商  

品 属 性 时 ， 需 要 对 该 属 性 的 状 态 进 行 检 验 ， 仅 当 属 性 不 被 商 品 类 型 使 用 时 才 能 被   删 除 。 对 商 品 属 性 的 更 新 包 括 对 商 品 属 性 名 称 、 类 型 、 取 值 范 围 的 更 新 ， 对 商 品

类 型 的 更 新 则 包 括 对 商 品 类 型 名 称 的 更 新 和 对 商 品 类 型 中 包 含 的 商 品 属 性 的 修  

改 。 查 询 功 能 则 包 括 查 询 全 部 商 品 属 性 、 查 询 全 部 商 品 类 型 、 以 商 品 属 性 Ｉ Ｄ 为  

查 询 某 个 商 品 属 性 的 详 细 信 息 、 查 询 某 个 商 品 类 型 包 括 的 商 品 属 性 详 细 信 息 等 功

能 。  

４ ４ ．

５ ．

区 块链辅助 模 块  

区 块 链 辅 助 模 块 是 对 商 品 信 息 管 理 模 块 的 辅 助 模 块 ， 负 责 以 区 块 链 的 形 式 存  

储 商 品 流 转 数 据 。 区 块 链 辅 助 模 块 包 括 数 据 录 入 、 数据 查 询 、 加 密 工 具 和 通 信 工  

具 四 个 子 模 块 。  

数 据 录 入 子 模 块 负 责 将 用 户 录 入 的 商 品 流 转 信 息 封 装 为 商 品 信 息 块 ， 并 调 用

相 关 方 法 完 成 对 商 品 信 息 块 的 存 储 和 传 递 。 当 前 节 点 收 到 来 自 其 他节 点 的 区 块 信

息时 ，

也 需要 由 数据录入子模块进行校验 、

存储 、

转发等处理 。

数 据 查 询 子 模 块  

负 责 为 商 品 信 息 管 理 模 块 的 查 询 功 能 提 供 支 持 ， 从 商 品 信 息 区 块链 中 查 询 商 品 信

息块 ，

并返 回 到商 品 信 息管理模块 。

通 信 工 具 子 模 块 负 责 协 助 数 据 录 入 子 模 块 完  

成 数 据 在 多 个 节 点 间 的 发 送 、 接 收 。 加 密 工 具 子 模 块 负 责 为 数 据 录 入 子 模 块 提 供

散 列 值 、 数 字 签 名 相 关 接 口 ， 具 体 功 能 包 括 散 列 值 管 理 和 数 字 签 名 管 理 。 散 列 值

管 理 包 括 为 商 品 流 转 数 据 生 成 散 列 值 和 进 行 散 列 值 校 验 。 数 字 签 名 管 理 则 包 括 为  

商 品 流 转 数 据 生 成 数 字 签 名 和 在 各 节 点 间 传 递 商 品 信 息 块 时 进 行 数 字 签 名 的 校  

验 。  

４ ． ５ 接 口 设 计  

控 制 层 接 ４ ５ ．

．１

口

２ ８

第 四 章 商 品 溯 源原 型 系 统 需 求分析与概要设计



  

控 制 层 的 交 互 接 口 被 应 用 层 调 用 ， 为 应 用 层 提 供 服 务 。 控 制 层 接 口 的 设 计 使

用 表 征 状 态 转 移 风 格 接 的 调 用 借 助 Ｒ Ｒ Ｅ Ｓ Ｔ（

Ｔ ｅ ｐ ｒ ｅ ｓ ｅ ｎ ｔａ ｔ ｉ ｏ ｎ ａｌ  Ｓ ｔａｔｅ  ｒａｎ ｓ ｆｅ ｒ ，

）

口
，

ＨＴＴ Ｐ 协 议 实 现 。 应 用 层 通 过 访 问 控 制 层 提 供 的 Ｕ ＲＩ ， 使 用 Ｇ ＥＴ 、 Ｐ Ｏ Ｓ Ｔ 、 Ｄ ＥＬ ＥＴＥ

等 动 词 调 用 控 制 层 接 口 ， 并 向 控 制 层 提 交 数 据 对 象 作 为 参 数 。 控 制 层 接 口 收 到 调  

用 后 将 进 行 相 应 的 操 作 ， 并 将 操 作 结 果 以 Ｊ Ｓ ＯＮ 数 据 的 形 式 反 馈 给 应 用 层 。

表

４－ １

控制层接 口 情况



  

接 口 类型

接 Ｐ 推述



  

用 户 管 理 接 口

包 括 用 户 登 录 接 口 、 用 户 注 册 接 口 、 删 除 用 户 接 口 、 用 户 信 息  

更新接 口 和拉取用 户 列表接 口



  

当前节点信息查询接

用 于查询本节点的 公钥 、

地 址 Ｉ Ｐ

、

名 称 等 信 息

Ｐ

＿

  

节 点 管 理 接 口  

包 括 节 点 新 增 接 口 、 节 点 信 息 更 新 接 口 、 节 点 删 除 接 口 、 拉 取  

节点信息列表接 口



  

包 括 商 品 类 型 新 增 接 口 、 商 品 类 型 删 除接 口 、 商 品 类 型 信 息 查  

商 品 类 型 管 理 接 口

询接 口 和商 品类型信息更新接 口

■  





包 括 商 品 属 性 新 增 接 口 、 商 品 属 性 删 除 接 口 、 商 品 属 性 信 息 查  

商 品 属 性 管 理 接 口  

询接 口 和商 品 属性信 息更新接 口



  

商 品 流 转 信 息 管 理 接 包 括 商 品 生 产 信 息 录 入 接 口 、 发 货 信 息 录 入 接 口 、 收 货 信 息 录  

Ｐ

入 接 口 、 商 品 记 录 信 息 录 入 接 口 和 商 品 流 转 信 息 查 询 接 口

＿



控 制 层 为 应 用 层 提 供 的 接 口 访 问 地 址 均 由 服 务 器 Ｉ Ｐ 地 址 、 服 务 器 端 口 号 和  

方法描 述三部 分组成 。 访 问 方法则 包括 ＰＯＳＴ 、

ＧＥＴ 和 ＤＥＬＥＴＥ 三 类 ，

分 别 用 于

数 据 的 新 增 、 数 据 的 查 询 和 数 据 的 删 除 。 控 制 层 向 应 用 层 反 馈 的 Ｊ Ｓ Ｏ Ｎ 数 据 格 式  

如 下 ：  

｛

＂

＂

ｃｏｄｅ ２００

：

，  

Ｕ Ｃ Ｃ Ｅ ＂

＂

＂

ｍｅ ｓ ｓａｇｅ

Ｓ
：

＂
ＳＳ ，  

＂

＂

ｄ ａｔａ ：

［ ］  

｝  

其中

ｃ ｏ ｄｅ

字 段作 为标识码 ，

表示此次操作是 否成功 。

ｍｅ ｓ ｓ ａｇ ｅ 字 段 对 具 体 的

操 作 情 况 进 行 描 述 ， ｄａｔａ 字 段 则 返 回 应 用 层 请 求 的 具 体 数 据 。 控 制 层 中 提 供 的 接  

如 表 所 示 口

４－ １

，

下 文 中 将选取用 户 登录接 口 和节 点 信 息删 除接 口 为示例 ，

对 控  

制 层 接 口 的 详 细 格 式 进 行 说 明 。  

以用 户 登录接 口 为例 ，

如 所 示 表 ４ ２ －

，

前 端 页 面 通 过 Ｈ ＴＴＰ 协 议 由 访 问 服 务  

地 址 务 端 地 址 器 Ｉ Ｐ

服 、 器

号 和 组 成 的 口

“

”

ｕｓ ｅｒ／ｌ ｏ ｇ ｉ ｎ

，

使 用 ＰＯ Ｓ Ｔ 方 法 提 交 账 号

和 密 码 ， 使 用 用 户 登 录 功 能 。  

２ ９  

北京邮 电大学工学硕士学位论文



  

表





４－２

用 户 登 录接 口
  

接 口 名称用 户 登录接 口
  

接 口 提供方用 户 管 理模块 （ 控 制 层 ）
  

接 口 调用 方前 端 页 面 （ 应 用 层 ）
  

用 户 向 系 统 提 交 登 录 请 求 ， 应 用 层 通 过 Ｈ ＴＴＰ 协 议 调 用 系 统 控 制 层 的 接  

接 口 场景描述  

口 ， 

将待登 的用户 账号信 息传递到控制层

￥

  

錄名称


  

錄錄用 户 账号

待登录用户 的账号 ， 不可为空
  

用 户 密 码 待 登 录 用 户 的 密 码 ， 不 可 为 空   ｜ 

接 口 返 回 值 返 回 一 条 固 定 格 式 的 Ｊ Ｓ ＯＮ 数 据 ｜

调 用 节 点 信 息 删 除 接 口 时 ， 前 端 页 面 使 用 Ｄ ＥＬ Ｅ ＴＥ 方 法 向 控 制 层 提 交 节 点

信 息 和 发 出 请 求 的 用 户 信 息 ， 该 接 口 的 具 体 情 况 如 表 ４－３ 所 示 。  

表 ４ ３ － 节 点 信 息 刪 除 接 口





  

接 口 名称节 点 信 息 删 除接 口
  

接 口 提供方

节 点 管理模块 （ 控制 层 ）
  

接 口 调用方前端 页 面 （ 应用 层 ）
  

接 口 场最描述 用 户 向 系 统 提 交 删 除 某 节 点 信 息 的 请 求
  

＿名称


  

用 户 信息

进行删除节点信息操作 的用户 的账户 信息
  

节点信息


待删除节点 的节点信息
  

接口返回值

返 回 一 条 固 定 格 式 的 Ｊ Ｓ ＯＮ 数 据 ， 其 中 ｄａｔａ 字 段 值 为 空

｜

  

４ ２ ５ ．

．

业 务 逻 辑 层 接 口  

业 务 逻 辑 层 中 的 接 口 借 助 Ｓｐｒｉ ｎ ｇＢ ｏｏｔ 框 架 实 现 ， 由 控 制 层 调 用 。 上 文 所 述

控制 层接 口 的返 回 值是一条固 定格式 的

Ｊ Ｓ ＯＮ

数据 ，

其 中 的 ｄａｔａ 字 段 内 容 即 由  

控制 层调 用 业务逻辑层 的接 口 获取 。

控制层抽取从应用 层获取的参数 ，

调 用 业 务

逻辑层 的相 应接 口 ，

将参数全部或部分提交到业务逻辑层 ，

获 取 到 需 要 返 回 应 用

层 的 数 据 。 此 类 接 口 的 使 用 通 常 伴 随 业 务 逻 辑 层 内 对 数 据 持 久 化 层 接 口 或 区 块 链

辅 助 模 块 中 接 口 的 调 用 。 除 此 之 外 ， 业 务 逻 辑 层 还 包 括 一 些 工 具 型 接 口 ， 如 二 维

码 生成接 口 、

二维码识别接 口 等 ，

这类 接 口 通 常 被 业 务 逻辑 层 或 控 制 层 中 的 模 块

调 用 但 实 现 中 不 需 要 对 数 据 持 久 化 层 的 接 口 进 行 调 用 。 业 务 逻 辑 层 接 口 的 简 要 ，

情 况 如 表 ４－４ 所 示 ， 其 中 不 包 括 区 块 链 辅 助 模 块 接 口 ， 区 块 链 辅 助 模 块 部 分 的 接  

将 说 口 情 况

在章节

４ ４ ５ ．

．

中 详细

明 。

３ ０  

第 四 章 商品溯源原型 系统需求分析与概要设计



  

表 ４－４ 业 务 逻辑 层 接 口





  

接 口 类型

接 ｎ 描述



  

包 括 用 户 新 增 接 口 、 用 户 删 除 接 口 、 用 户 信 息 查 询 接 口 、 用 户 信  

 用 户 信 息 管 理 接 口

更 新 接 息 和 用 户 ＆ ＆  ＾  
口

验证接

口



  

节 点 信 息 管 理 接 口

包 括 节 点 新 增 接 口 、 节 点 删 除 接 口 、 节 点 信 息 查 询 接 口 和 节 点 信 息更新接 口



  

商 品 类 型 管 理 接 口  

包 括 商 品 类 型 新 增 接 口 、 商 品 类 型 删 除 接 口 、 商 品 类 型 信 息 查 询 接 口 和商 品类型信息更新接 口



  

包 括 商 品 属 性 新 增 接 口 、 商 品 属 性 删 除 接 口 、 商 品 属 性 信 息 查 询

商 品 属 性 管 理 接 口

接 口 和商 品 属性信息更新接 口



  

用 于 处 理 录 入 商 品 信 息 时 需 要 进 行 的 操 作 ， 包 括 商 品 生 成 信 息  

商 品 信 息 录 入 接 口 录 入 接 口 、 发 货 信 息 录 入 接 口 、 收 货 信 息 录 入 接 口 和 商 品 记 录 信  

息录入接 口



  

商 品 信 息 査 询 接 口 包 括 按 照 商 品 Ｄ Ｉ 查 询 和 按 照 商 品 二 维 码 查 询 接 口
  

包 括 节 点 信 息 初 始 化 接 口 和 节 点 信 息 查 询 接 口 。 初 始 化 接 口 仅  

当 前 节 点 信 息 管 理 接 口  

在 当 前节 点第 一次部署或 当 前节 点 信 息缺失 时被调 用



  

Ｔ  维 码 管 理 接 口

包 括 二 维 码 生 成 接 口 和 二 维 码 识 别 接 口

｜

业 务 逻 辑 层 接 口 的 输 入 为 控 制 层 处 理 后 的 数 据 对 象 ， 其 类 型 可 能 是 字 符 串 、  

类 对 象 、 列 表 等 。 输 出 值 则 包 括 数 据 集 、 数 据 对 象 、 操 作 结 果 标 识 等 。 以 表 ４ － ４  

中 的节点信 息查询接 口 为例 ，

如 表 所 示 ４ － ５

，

这是一 个典型 的数据返 回接 口 。

其  

输 入 为 一 个 表 示 节 点 信 息 的 字 符 串 ， 输 出 则 为 查 询 到 的 节 点 信 息 对 象 。 该 对 象 的

值 可 能 为 空 。

表 ４－５ 节 点 信 息 查询 接 口





  

接 口 名称节 点 信 息 查询 接 口
  

接 口 提供方 节 点 管 理 模 块 （ 业 务 逻 辑 层 ）
  

接 口 调用方控制 层
  

接 口 场景描述 用 户 向 系 统 提 交 查 询 某 节 点 具 体 信 息 的 请 求 ， 控 制 层 收 到 来 自 前 端 页 面  

的请求和参数后 向 业务逻辑层提交相应参数



  

主

錄名称

ｍｍｍ



  

节点名称

待查询 的节点 名 称 ，

不 可 为 空  

Ｉ



 接 口 返 回 值

返 回 一 个 类 型 为 节 点 信 息 的 数 据 对 象

｜

４ ５ ３ ．

．

数 据 持 久 化 层 接 口  

３ １  

北京邮 电大学工学硕士学位论文



  

数 据 持 久 化 层 接 借 助 框 架 和 实 口

Ｓ ｐｒｉ ｎ ｇＢ ｏ ｏ ｔ

Ａ Ａ ＪＰ  （ Ｊ ａｖ ａ  Ｐ ｅ ｒ ｓ ｉ ｓ ｔｅ ｎ ｃ ｅ  Ｐ Ｉ ）

现 。 该 层 中 对 Ｓ ＱＬ 语 句 进 行 了 封 装 ， 向 下 借 助 数 据 库 的 外 部 接 口 对 数 据 库 中 的

数 据 进 行 增 、 删 、 改 、 查 等 基 础 操 作 ， 向 上 则 将 这 些 操 作 作 为 接 口 提 供 给 业 务 逻  

辑 层 ， 使 业 务 逻 辑 层 通 过 调 用 本 层 的 接 口 即 可 实 现 对 底 层 数 据 的 操 作 。 其 具 体 情

况 如 表 所 示 ４－ ６

。  

表 ４－６ 数 据持 久 化 层接 口





  

接口名称

接 ａ錄

接口返回





  

数 据 在 数 据 库 中 存 储 的 主 键 或 候 数 据 库 中 的 一 条 记 录  

精 确 查 询 接 口  

选键值



  

数 据 集 查 询 接 口  

无 法 唯 一 标 识 数 据 记 录 的 数 据 参 数 据 库 中 的 一 组 查 询 结 果 集 合   ｍ



  

数据新增 接 口必 要 的数据信 息

操作成功或失败



  

数 据 删 除 接 口 待 删 除 的 数 据 Ｄ Ｉ

操作成功或失败



  

  数 据 更 新 接 口

必要的数据信 息

操 作 成 功 或 失 败

｜

｜

系 统 中 的 数 据 分 为 业 务 数 据 和 功 能 数 据 两 部 分 ， 针 对 存 储 在 Ｍｙ Ｓ Ｑ Ｌ 数 据 库  

中 的 功 能 数 据 ， 数 据 持 久 化 层 中 针 对 每 张 数 据 库 表 提 供 相 应 的 数 据 对 象 的 新 增 、  

删 除 、 查 询 和 修 改 四 类 功 能 接 口 。 业 务 数 据 则 以 区 块 链 的 形 式 存 在 ， 由 ＭｏｎｇｏＤ Ｂ

负 责 数 据 的 底 层 存 储 ， 数 据 持 久 化 层 对 其 提 供 新 增 和 查 询 两 类 功 能 接 口 。  

使 用 节 点 名 称 为 关 键 字 进 行 节 点 信 息 查 询 时 调 用 的 数 据 持 久 化 层 接 口 详 情  

表 所 如

４－ ７

示。

节 点 信 息 以表 的 形式存 储在 ＭｙＳＱＬ 数据库 中 ，

该 接 表 口 属 于

４ －  

６ 中 的 精 确 查 询 接 口 ， 返 回 结 果 中 仅 包 括 一 条 记 录 。 若 查 询 不 到 符 合 要 求 的 记 录 ，

返 回 值 则 为 空 。  

表 ４－７ 指 定 节 点 信 息 查询接 口





  

接 口 名称节 点 信 息 查 找接 口
  

接 口 提供方功 能 数 据 存 储 模 块 （ 数 据 持 久 化 层 ）
  

接 口 调用方节 点 管 理模块 （ 业 务逻辑 层 ）
  

接 口 场景推述在 节 点 信 息 表 中 根 据 节 点 名 称 查 找 指 定 节 点 的 详 细 信 息

主

￣

￣  

  

 錄名称

一

  

Ｍｅ ｍ ｂｅｒＮ ａｍｅ 待 查 找 的 节 点 的 名 称



  

 接 口 返 回 值

返 回 一 条 名 称 属 性 值 符 合 要 求 的 节 点 信 息 数 据 记 录 或 空 值  

｜

块 链 接 区 ４ ４ ５ ．

．

口

系 统 中 商 品 流 转 数 据 以 区 块 链 的 形 式 存 储 。 区 块 链 辅 助 模 块 提 供 两 类 接 口 ，

其 一 被 商 品 信 息 管 理 模 块 调 用 ， 负 责 商 品 信 息 数 据 的 录 入 和 查 询 ， 包 括 商 品 信 息

３ ２  

第 四 章 商 品溯源原 型 系统需求分析与 概要设计



  

块 录 入 接 口 和 商 品 信 息 块 查 询 接 口 。 其 二 负 责 各 节 点 间 数 据 的 同 步 ， 节 点 需 要 对   商 品 信 息 块 进 行 封 装 、 发 送 、 接 收 等 处 理 ， 在 此 过 程 中 ， 商 品 信 息 块 被 封 装 为 商   品 信 息 包 并 进 行 传 输 。 区 块 链 接 口 的 详 情 如 表 ４ ８ － 所 示 。  

表





４－ ８

区 块 链接 口   

接 口名称

接Ｐ錄

接 口 返 回





记 录 该 商 品 流 转 记 录 的 全  

区 块 链 数 据 查 询 接 口 待 查 询 的 商 品 Ｉ Ｄ  

部商品 信息块集合



  

必 要 的 商 品 流 转 信 息 、 商 品 信 息  

区 块 链 数 据 录 入 接 口 录 入 成 功 ／ 失 败

ｍｍ



  

商 品 信 息块生成接 口必要 的 商 品 流转信 息

生 成 的 商 品 信 息 块  



商 品 信 息 包 生 成 接 口 商 品 信 息 块 和 商 品 信 息 类 型 指 定 类 型 的 商 品 信 息 包  

商 品 信 息 包 发送 接 口指 定 节 点 名 称 和 商 品 信 息 包发送 成 功／失败
  

商 品 信 息包接收接 口商 品 信 息包

分发 成功／失败



  

商 品 信 息 包 处理接 口指 定类 型 的商 品 信 息 包

处理成功／失败



  

ｉ   品 信 息 块 校 验 接 口

商 品信息块

校 验 通 过 ／ 未 通 过  

｜

Ｉ

用 户 对 商 品 流 转 数 据 进 行 查 询 时 ， 商 品 信 息 管 理 模 块 将 调 用 区 块 链 数 据 查 询

接口 ，

获取相应 的商 品信 息块集合 。

在录入商 品流转信 息时 ，

商 品 信 息 管 理 模 块  

调 用 区 块 链 数 据 录 入 接 口 ， 将 商 品 流 转 数 据 写 入 区 块 链 。 在 将 商 品 流 转 数 据 写 入  

区 块 链 时 ， 需 要 调 用 商 品 信 息 块 生 成 接 口 将 商 品 流 转 信 息 封 装 为 商 品 信 息 块 ， 并  

将 商 品 信 息 块 发 送 到 相 关 节 点 处 。 发 送 商 品 信 息 块 之 前 需 要 将 商 品 信 息 块 封 装 生  

成 商 品 信 息 包 。 其 他 节 点 收 到 商 品 信 息 包 后 ， 需 要 通 过 接 收 接 口 将 信 息 包 按 照 类   型 分 发 到 相 应 的 处 理 接 口 。 在 处 理 的 过 程 中 需 要 调 用 商 品 信 息 块 校 验 接 口 对 商 品

信 息 块 进 行 校 验 。  

４ ． ６ 数 据 库 设 计  

如前文所述 ，

系统中 需要存储的数据包括业务数据和功能数据 。

根 据 数 据 的

特 点 和 前 文 中 对 系 统 的 分 析 ， 系 统 选 取 Ｍｙ Ｓ ＱＬ 数 据 库 对 功 能 数 据 进 行 存 储 。 而  

业 务 数 据 通 过 哈 希 运 算 、 附 加 签 名 等 流 程 封 装 形 成 区 块 ， 系 统 使 用 ＭｏｎｇｏＤ Ｂ 存

储 区 块 数 据 。

３ ３

北京邮 电大学工学硕士学位论文



  

— －一 ￣

 ｙ ／＼

ｕ  ＼＜ ＞

＼

＾ｒ＜＾＞

＾＾  （

ｆ Ｎ Ｂ ＇

ｆ

Ｉ

ｊ）

商品炎堃

一 ＾  
＾

数 库 图

４－ １１

据 设 计 Ｒ Ｅ － 图

功能数据部分 的数据库设计如 图

４－ １１

所示 。

其 中 基 础 的 数 据 表 包 括 用 户 信

息 表 、 节 点 信 息 表 、 商 品 属 性 表 和 商 品 类 型 表 。 为 了 便 于 数 据 的 管 理 ， 还 需 要 建

立 商 品 属 性 － 商 品 类 型 映 射 表 。  

业 务 数 据 以 区 块 的 形 式 存 储 在 Ｍ ｏ ｎ ｇｏ Ｄ Ｂ 中 ， 每 条 商 品 流 转 数 据 通 过 哈 希 运   算 生 成 哈 希 值 ， 和 哈 希 值 引 用 、 时 间 戳 等 信 息 共 同 被 封 装 成 为 一 个 区 块 。 每 个 区

块 作 为 一 条 记 录 进 行 存 储 。 此 外 商 品 的 控 制 者 信 息 也 被 存 储 在 Ｍ ｏ ｎ ｇ ｏ Ｄ Ｂ 中 。 其  

具 体情况将在章节

５６ ．

相 关 部 分 进 行 介 绍 。

４ ７ 本 章 小 结   ．

本 章 对 基 于 商 品 信 息 区 块 链 的 商 品 溯 源 原 型 系 统 进 行 了 详 细 的 需 求 分 析 ， 并   根 据 需 求 分 析 对 系 统 进 行 了 概 要 设 计 。 首 先 简 述 了 原 型 系 统 对 应 的 实 际 场 景 ， 随 后 结 合 用 例 图 对 原 型 系 统 的 功 能 性 需 求 和 非 功 能 性 需 求 进 行 了 阐 述 。 根 据 对 系 统   的 分 析 ， 本 章 还 给 出 了 原 型 系 统 的 整 体 结 构 ， 并 对 原 型 系 统 的 功 能 模 块 进 行 了 划 分 。 最 后 介 绍 了 对 原 型 系 统 中 各 类 接 口 和 数 据 库 的 设 计 。  

３ ４

第五章 商 品溯源原 型 系统 洋细 设计 与 实现



  

第 五 章 商 品 溯 源 原 型 系 统 详 细 设 计 与 实 现  

本 章 对 网 状 商 品 信 息 区 块 链 和 基 于 该 区 块 链 的 商 品 溯 源 原 型 系 统 进 行 详 细  

设计和实现 ，

介绍 系统各模块的详细设计过程和具体实现的关键步骤。

其 中 ５ ５ ．

小 节 以 第 三 章 的 设 计 为 基 础 ， 对 商 品 信 息 区 块 链 进 行 详 细 设 计 和 具 体 编 码 实 现 。  

５ ． １ 用 户 管 理 模 块  

用 户 管 理 模 块 包 括 用 户 注 册 、 用 户 登 录 、 用 户 信 息 修 改 、 用 户 删 除 等 子 模 块 。  

用 户 信 息 包 括 用 户 账 号 、 用 户 密 码 、 用 户 备 注 、 用 户 权 限 、 用 户 电 话 号 码 等 ， 用

类 所 示 户 类 的

图 如 图 ５－ １

。  

 Ｕ ｓ ｅ ｒ
［

ｇ   ｄ  ｏ ｎ －



ｉ

：

ｌ

｜

ｒ ｎ ｍ － ｕ ｓ ｅ

ａ

 Ｓ ｅ ：

ｔｒ

ｉ ｎ ｇ

｜

Ｓ －


ｐａ

ｓ

ｓ

ｗ

ｏ

ｒｄ


：

ｔ ｒ ｉ ｎ ｇ

！

ｏ  Ｓ ｎ －

ｉ

ｔ

：

ｕ

ｉ ｎ ｇ

－

ｐ

ｈ

ｏ

ｎ

ｅ

ｎ

ｕ

ｍ

Ｓ
：

ｕ

ｉ ｎ ｇ

丁 ｍ ｅ ｃ － ｒ

ｅａ ｔ ｅ

ｊ

：  

Ｔ Ｔ － ｕ ｐ ｄ ａ ｉ ｅ

ｍ ｉ

ｅ ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

ｖ  ｕ ｅ － ｌ

ｅｌ

：

ｒ ｉ

类 图

５－ 〗

用户

图

户 注 册   ５ ． １

．

１

用

用 户 在 注 册 时 必 须 提 交 自 定 义 的 个 人 账 号 、 密 码 和 电 话 号 码 ， 个 人 说 明 属 于  

选择提交 内 容 。

用 户 在前端页面输入注册信息后 ，

前 端 页 面 将 对 信 息 进 行 校 验 。

注 册 信 息 需 要 符 合 以 下 条 件 才 会 被 提 交 到 后 端 ：  

１ ）

账号 不 为 空 ，

且 仅 包 含 中 英 文 字 符 和 阿 拉 伯 数 字 。  

２ ）

密码不为空 ，

且 仅 包 含 英 文 字 符 和 阿 拉 伯 数 字 。

３

电话号码符合定 义

长 度 为 位 （

１１

，

且 仅 包 含 阿 拉 伯 数 字 ） 。  

）

；

如 果 用 户 提 交 的 信 息 不 符 合 要 求 ， 前 端 页 面 将 给 出 相 应 提 示 ， 要 求 用 户 重 新

填写注册信 息 。

注册信息通过前端页面 的校验后 ，

将被封装为用 户 类对象 ，

作 为

访 问 控 制 层 用 户 注 册 接 口 的 参 数 。 用 户 注 册 接 口 收 到 前 端 调 用 后 调 用 业 务 逻 辑 层

的 Ｕ ａｄ ｄ ｓｅ ｒ 方 法 。 该 方 法 在 传 入 的 用 户 类 对 象 参 数 中 获 取 待 注 册 的 用 户 账 号 名 称 ，  

调 用 数 据 持 久 化 层 的 用 户 查 询 方 法 ｆｉ ｎ ｄ Ｂ ｙ Ｕ ｓ ｅ ｒ ｎ ａｍ ｅ ， 杳 询 是 否 存 在 对 应 用 户 。 若   已 经 存 在 同 名 用 户 ， 业 务 逻 辑 层 将 返 回 注 册 失 败 提 示 ， 否 则 调 用 数 据 持 久 化 层 中

的新增用 户 方法 ，

为用 户 分配一个长整型 数字作 为该用 户 在 数据库表 中 的

Ｄ Ｉ

，  

并 在 数 据 库 的 用 户 表 中 新 增 一 条 用 户 记 录 。 随 后 业 务 逻 辑 层 将 向 控 制 展 返 冋 表 示  

３ ５

北京 邮 电大学工学硕士学位论文



  

注册成功 的标识 。

控制 层将根据业务逻辑层传 回 的结果代码 ，

构 造 个 一

Ｂ ａ ｓ ｅ Ｄ ａ ｔ ａ  

类 型 的 数 据 对 象 ， 该 数 据 对 象 即 为 向 应 用 层 返 回 的 结 构 ， 其 形 式 为 Ｊ Ｓ Ｏ Ｎ 数 据 。  

类 的 类 如 图 所 示 Ｂ ａ ｓ ｅ Ｄ ａ ｔａ

图

２ ５ －

。  

Ｂ ａ ｓ ｅ Ｄ ａ ａ  ｔ

  — 

－

－ 一 

＂

—  

 Ｒ Ｇ 



ｕ ｅ ｓ

ｌｔ

ｅ ｎ ｅ ｒ ａ ｔ ｏ ｒ

ｃ ｏ ｄ ｅ  ｎ  －

：

ｉ

ｔ

 

 —        

Ｄ Ｒ Ｕ Ｔ Ｃ Ｃ Ｍ Ａ Ｇ ＇  － ｍ ｅ ｓ ｓ ａ ｇ ｅ  Ｓ ｔ ｒ ｉ ｎ ｐ

 ￣ －

￣

ＥＡ ｋ

Ｌ

ＳＬ

＿

ＥＳＳ
＿

ＥＳＳ

Ｅ Ｓ  ：

ｔ

ｒｉ

ｎ ｇ

Ｏ Ｒ Ｏ Ｂ Ｄ ｄ －

ａ ｔ ａ ：

ｂ ｅ ｃ ｔ 十 ｅ ｅ ｎ Ｓ ｕ ｃ ｃ ｅ ｓ ｓ ｅ ｓ ｕ ｋ

 ：

ａ ｓｅ

ａ ｔ ａ

ｊ

＾





 Ｆ Ｒ ｍ Ｂ Ｄ ３

ｇ ｅ ｎ －

－

＾

ａｉ ｌ

ｅ ｓ ｔ ｉ ｉ ｌ

ｆ

ｅ ｓ ｓ ａ ｇ ｅ Ｓ  ： ｔ ｒ ｉ

ｎｅ

）


：

ａ ｓｅ

ａ ｔ ａ

Ｒ Ｒ Ｃ Ｒ Ｃ ｍ Ｂ Ｄ ｎ Ｆ － ｇ ｅ

ａｉ ｌ

ｅ ｕ ｓ

ｌ ｔｉ

ｅｓｕｌ ｔ

ｏ

ｄ

ｅ


：

ｅｓｕ ｌ ｔ

ｏ ｄ ｅ  ，

Ｓ ｅ ｓ

ｓａ

ｇｅ


：

ｇ  ｔ ｒ ｉ ｎ

）：

ａｓｅ

ａ ｔ ａ

Ｒ Ｏ Ｂ Ｄ ＾ ＾ ｅ ｎ Ｓ ｕ ｃ ｃ ｅ ｓ ｓ

ｕ ｅ ｓ

ｄ ａ ｌ ｔ ｔ

ｔ ａ  ：

ｂ ｅｃｔ


：

ｊ

）

ａｓｅ

ａｔａ



．  

Ｒ  Ｃ ｅ ｓ ｕ ｌ ｔ

ｏｄｅ

｜

类 图  Ｄ ５ － ２ Ｂ ａ ｓ ｅ

ａｔ ａ

图

其 中 ｃ ｏ ｄ ｅ 字 段 是 对 请 求 结 果 的 标 识 码 ， 对 请 求 成 功 和 失 败 的 各 类 情 况 分 别

进行了 定义，

如 成 功 值 为 ２ ０ ０（ Ｓ Ｕ Ｃ Ｃ Ｅ Ｓ Ｓ ） 、

失 畋 值 为 Ａ ４ ０ ０（ Ｆ

Ｌ Ｉ

）、

接 口 不 存 在

值 段 对 请 为 等 字 ４ ０ ４（ Ｎ Ｏ Ｔ Ｆ Ｏ Ｕ Ｎ Ｄ ）

。 ｍｅ ｓｓａｇｅ

求 结 果 进 行 附 加 描 述 ， 对 ｃ ｏ ｄ ｅ

＿

表 示 的 情 况 进 行 补 充 说 明 。 ｄ ａｔａ 字 段 的 内 容 则 用 于 向 前 端 页 面 返 回 其 请 求 的 数 据 。

户 登 录   用 ５ ２ ．

１

．

用 户 在 登 录 时 需 要 在 前 端 页 面 中 输 入 用 户 账 号 （ 注 册 时 用 户 自 行 填 写 ， 并 非

系统分配的长整型

Ｄ Ｉ

）

和密码 ，

随后点击按钮确认登录 。

如果登录成功 ，

前 端 页

面 将 自 动 跳 转 到 系 统 主 页 ， 否 则 页 面 将 会 停 留 在 登 录 界 面 并 给 出 相 应 提 示 。  

￣

 户



，

丨 １

‘
”

 ］  — Ａ ． ｌ

＾ ｔ ｓ ｃ ｒ Ｓ ｃ ｍ ｃ ｃ

Ｉ

｜

  Ｉ ，

｜

｜

 输 八 账＾ 密 Ｕ ｜

，

    ！ Ｉ

Ｉ

１

 ｎｎ  

ｉ

ｉ

ｉ

Ｉ

 Ｕ  

１

ｉ

ｉ

ｉ

 校 验 怡 总 圮  Ｉ

 Ｉ

２．

  ＾

Ｉ

Ｉ



１

細



；

！

１

！

 校 验 通 过 提 ａｙ  ｉ

［

：

：



１

＞

 Ｌ＿＿
！



！

！

    ■

丨

１
４．

１

 ＾

ｉ

ｉ

＾   ｉ

ｉ



Ｉ

！

：

！

 Ｌ

Ｉ

！



  

Ｉ

ｊ

Ｔ ．

１

Ｉ

８ ．

返 问 脸 诚 结 采

Ｉ

ｎ ｖ

Ｃ ｔ ａ ＾ ｃ  

＂
Ｕ  

  ９ ＾  ４ ｎ   ＇

Ｉ

Ｉ

１

． 

．

ｊ

ｃ 〇 ｋ －  ｊ Ｊ ｊ

ｔ

＜

ｌ

Ｉ

？ｎ   

—

；

 返 结 〇 ｉ

？

问无

Ｕ  

  Ｖ  ＜ 

ｉ

；

ｉ

ｉ  

 ＜   

Ｉ

：

！

Ｉ

Ｉ  



ｉ

Ｉ

   Ｉ

Ｉ

Ｉ




Ｉ

  ｊ

ｊ

｜

   丄 硓 ？ １

／／



ｉ

Ｉ

ｉ

ｉ

ｌ

返 Ｓ 录 结 卜  回

ｆ、



Ｉ

丨

Ｉ

＜    

ｉ

１

Ｉ

丨

ｉ

    Ｉ

ｌ

ｉ

Ｉ

Ｉ

    ｔ

ｉ

ｉ

ｊ

Ｉ

图 ５ － ３ 用 户 登 录 时 序 图

３ ６

第 五章 商 品溯源原型系统详细设计与实现



  

用 户 登 录 的 流 程 如 图 ５ － ３ 所 示 ， 主 要 包 括 以 下 步 骤 ：

１ ）

用 户 在 前 端 页 面 输 入 用 户 账 号 和 密 码 ， 前 端 页 面 以 Ｐ Ｏ Ｓ Ｔ 方 法 访 问 系 控  

制 层 中 的 用 户 登 录 接 口 ， 访 问 参 数 为 用 户 的 账 号 和 密 码 。  

２ ）

控 制 层 收 到 访 问 ， 从 参 数 中 抽 取 用 户 账 号 和 密 码 ， 调 用 业 务 逻 辑 层 中 的

ｆｉｎ ｄＢｙＮａｍ ｅ 方 法 查 询 系 统 中 是 否 已 经 存 储 有 该 用 户 的 账 号 信 息 。 若 信

息 已经存在 ，

则对密码进行校验 ，

校 验 通 过 则 意 味 着 该 用 户 登 录 成 功 。  

若 查 询 不 到 账 号 信 息 或 密 码 校 验 不 通 过 则 用 户 登 录 失 败 。  

３
）

若登录成功 ，

则 系 统 将 使 用 用 户 的 账 号 为 该 用 户 生 成 一 个 ｔ ｏ ｋｅｎ ，

ｔ ｏ ｋ ｅ ｎ  

将 被 缓 存 在 后 端 作 为 用 户 的 登 录 凭 证 。 最 终 后 端 向 前 端 返 回 一 个  

数 据 对 象 Ｂ ａ ｓ ｅ Ｄ ａｔａ

，

若登录成功 ，

该 数 据 对 象 的 ｄａｔａ 域 中 将 包 括 生 成 的

和 信 ｔｏ ｋｅｎ

用 户 的 账 号 息 。  

登 录 成 功 时 系 统 分 配 的 ｔｏｋｅｎ 将 作 为 用 户 使 用 系 统 的 身 份 凭 证 ， 前 端 对 ｔｏｋ ｅｎ  

进行存储 ，

并 在 每 次请 求 服 务 时 将 ｔｏｋｅｎ 写 入 请求 头 中 ，

后 端 在 接 收 到 请 求 时 会  

校 对 进 行 验 ｔｏｋｅ ｎ

，

若校验失败则会拒绝用 户 的请求 。

通 过 这 种 方 法 能 够 实 现 对  

系 统 的 权 限 管 理 和 用 户 的 身 份 验 证 。 控 制 层 每 次 收 到 来 自 前 端 的 请 求 时 都 会 对  

ｔ ｏｋｅｎ 进 行 校 验 ， 其 流 程 是 相 同 的 ， 因 此 在 后 文 中 对 有 关 ｔｏｋｅｎ 的 请 求 校 验 部 分  

行 进

省 略 了

。  

５ ３ １ ．

．

用 户 权 限控制

用 户 的 权 限 控 制 一 方 面 通 过 用 户 登 录 时 对 ｔｏｋｅ ｎ 的 发 放 和 用 户 请 求 服 务 时 对  

ｔ ｏ ｋｅｎ 的 验 证 实 现 ， 保 证 未 注 册 和 未 登 录 的 用 户 无 法 访 问 系 统 服 务 。 另 一 方 面 主  

要 通 过 前 端 页 面 的 路 由 控 制 实 现 。 用 户 成 功 登 录 时 后 端 返 回 的 数 据 中 包 括 用 户 的

账 户 信 息 ， 前 端 页 面 通 过 解 析 账 户 信 息 即 可 获 知 该 用 户 的 角 色 权 限 （ 系 统 管 理 员 、  

商 品 管 理 员 或 普 通 用 户 ） ， 而 后 根 据 用 户 的 角 色 权 限 动 态 调 整 用 户 能 够 访 问 的 页

面 ，

使其权限外 的页面处于 隐藏状态 。

各类用 户 权限情况如表

５－ １

所 示 。  

表 ５－ 丨

用 户 权限 与 其可访问 的 页 面





  

权  用 户 限

ｌ ｅｖｅｌ

字段值

可访 问 的前端页面



  

节 点 信 息 管 理 页 面 、 本 地 界 面 信 息 页 面 、 用 户 信 息 管 理  

系 统 管 理 员 ２ 页 面 、 个 人 信 息 管 理 页 面 、 商 品 类 型 管 理 页 面 、 商 品 信

息管理页面



  

管  商 品 理 员

１  

商 品 类 型 管 理 页 面 、 商 品 信 息 管 理 页 面 、 个 人 信 息 管 理  



  

普通用 户

０商 品 信 息 查 询 页 面 、 个 人 信 息 管 理 页 面



  

 未 登 录 用 户 ／

注 册 界 面 、 登 录 界 面  

｜

３ ７

北京邮 电大学工学硕士学位论文



  

４ ５ １ ．

．

用 户 信 息 修 改  

用 户 信 息 的 修 改 包 括 两 种 类 型 ， 一 是 用 户 对 自 身 信 息 的 修 改 ， 可 修 改 的 信 息

包括密码 、

手机号码 、

备注信 息等 ？ ，

二是系统管理员 对其他用 户 信 息 的 修改 ，

此  

时 可 修 改 的 信 息 除 了 基 本 信 息 外 ， 还 包 括 账 户 的 权 限 。 系 统 管 理 员 仅 能 授 予 用 户

商 品 管 理 员 和 普 通 用 户 权 限 ， 无 法 授 予 系 统 管 理 员 权 限 。 当 存 在 多 个 系 统 管 理 员

时 ，

他 们 也 不 能 互 相 修 改 信 息 。  

修 改 个 人 信 息 时 ， 用 户 需 要 访 问 个 人 信 息 修 改 页 面 ， 在 指 定 位 置 填 入 待 修 改  

信 息 并 提 交 。 前 端 页 面 对 用 户 提 交 的 信 息 进 行 校 验 ， 确 认 无 误 后 将 其 封 装 为 用 户

类 对 象 传 入 作 为 参 数 ， 使 用 ＰＯ Ｓ Ｔ 方 法 访 问 控 制 层 的 用 户 信 息 修 改 接 口 。 接 口 调  

用 业 务 逻 辑 层 中 的 相 应 方 法 ， 业 务 逻 辑 层 收 到 调 用 后 首 先 调 用 数 据 持 久 化 层 中 针

对 用 户 的 精 确 查 询 方 法 ， 查 找 相 应 的 用 户 记 录 。 再 将 查 找 到 的 实 例 与 控 制 层 传 入  

的 参 数 进 行 对 比 和 更 新 ， 随 后 调 用 数 据 持 久 化 层 中 数 据 的 新 增 方 法 ， 将 更 新 后 的

用 户 实 例 保 存 到 数 据 库 中 。 最 后 逐 层 返 回 操 作 结 果 ， 直 至 前 端 页 面 给 予 用 户 反 馈 。

账 户 权 限 的 修 改 与 个 人 信 息 的 修 改 类 似 ， 其 不 同 点 在 于 需 要 具 备 系 统 管 理 员

权 限 的 用 户 访 问 用 户 信 息 管 理 页 面 才 能 使 用 账 户 权 限 修 改 服 务 。 此 后 系 统 后 端 的

流 程 与 个 人 信 息 的 修 改 相 同 。  

５ ． ２ 节 点 管 理 模 块

５ ２ ．

．１

本 地节 点 信 息  

在 系 统 中 每 个 ｗｅｂ 服 务 器 和 它 对 应 的 本 地 数 据 库 共 同 组 成 一 个 服 务 器 节 点 。  

节 点 间 需 要 进 行 数 据 的 共 享 ， 为 了 保 证 节 点 间 的 数 据 传 输 安 全 可 靠 ， 在 传 输 数 据

时 节 点 需 要 对 数 据 附 加 数 字 签 名 。 因 此 每 个 节 点 都 需 要 具 备 相 应 的 公 钥 和 私 钥 。  

公 钥 发 布 给 系 统 中 的 其 他 节 点 ， 而 私 钥 仅 保 存 在 该 节 点 本 地 。 本 地 节 点 信 息 类

的 类 如 图 所 示 Ｎ ｏ ｄｅ ｉ ｎｆｏ

图

５ －４

。  

Ｎ ｏ ｄ ｅ ｌ ｎ ｆｏ

Ｋ ｐ －

ｕｂｌ ｉ ｃ

ｅ ｙ Ｓ  ： ｔ ｎ ｎ ｇ  

Ｋ － ｐ ｎ ｖ ａ ｔ ｅ

ｅ ｙ Ｓ  ： ｔ ｒ ｉ ｎ ｇ  

Ｎ － ｎ ｏｄ ｅ

ａ ｍ ｅ ：  Ｓ ｔ ｒ ｉ ｎ ｇ

ｐ Ｓ ｎ ｇ － ｉ


：

ｔ ｒｉ

Ｔ Ｔ － ｕ ｐ ｄａ ｔ ｅ

ｍ ｉ

ｅ  ：

ｌ ｎ ｉ ｅ Ｓ ｔ ａ ｍ ｐ

图 ５ － ４ 本 地 节 点 信 息 类 图
本 地 节 点 的 信 息 存 储 在 Ｍｏ ｎｇｏ ＤＢ 中 ， 在 节 点 启 动 时 将 从 数 据 库 中 载 入 公 私 钥 等 信 息 。 如 果 当 前 节 点 未 存 储 有 本 地 节 点 信 息 ， 系 统 将 调 用 密 钥 生 成 方 法 ，   为 节 点 生 成 一 对 新 的 公 私 钥 ， 并 将 密 钥 信 息 存 储 在 数 据 库 中 。

３ ８

第 五章 商品溯源原型 系统详细 设计与 实现



  

２ ２ ５ ．

．

节 点 信 息 管 理  

各 节 点 间 为 了 实 现 商 品 流 转 数 据 的 共 享 ， 需 要 进 行 通 信 。 因 此 系 统 需 要 维 护

一 张 节 点 信 息 表 ， 表 中 存 储 其 他 节 点 的 公 钥 、 名 称 、 Ｉ Ｐ 地 址 等 信 息 ， 以 便 实 现 节 点 间 的 通 信 。 节 点 信 息 管 理 包 括 对 节 点 信 息 表 中 记 录 的 新 增 、 修 改 、 删 除 和 查 询 。 节 点 信 息 类 的 类 图 如 图 ５ － ５ 所 示 。 节 点 信 息 管 理 功 能 都 需 要 用 户 具 备 系 统 管 理 员  

权 限 才 能 使 用 。

Ｍ ｅ ｍ ｂ ｅ ｒ

ｇ   ｄ ｏ ｎ － ｉ

 ：

ｌ

－

ｎ

ａｍ

ｅ

Ｓ
：

ｒ ｔ

ｉ

ｎ

ｇ  

Ｋ ｐ ｂ －

ｕ

ｃ ｌ ｉ

ｅ

ｙ

Ｓ
：

ｕ

ｉ

ｎ ｇ  

－

Ｓ ｇ ｐ  ｉ

：

ｎ ｒ ｉ

ｉ

ｏ ｎ － ｉ

ｆ

Ｓ
：

ｒ ｔ

ｉ

ｎ

ｇ

Ｔ Ｔ － ｃ ｒ ｅ ａ ｔ ｅ

ｍ ｉ

ｅ


：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

Ｔ Ｔ － ｕ ｐ ｄ ａ ｔ ｅ

ｍ ｉ

ｅ ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

图 ５ － ５ 节 点 信 息 类 图

节 点 信 息 中 的 节 点 的 Ｐ Ｉ 地 址 和 备 注 信 息 是 可 以 修 改 的 ，

如 图 所 示 ６ ５ －

。

＂  


叩

＿ ＿     — 伽   －

Ｍ ｒ ｔ ｃ ｍ ｈ ，

ｍ ｙ 〇

ｏ ｒ

ｃ ｌ ｌ

ｒ

ｊ

Ｍ ｃｍ ｈｃｒ Ｓ ｏ ｎ

ｆｅ ｃ ｃ ｉ

ｉ

； ＾ （ ，

丨 ，（ ＞ ｜

｜

丨

１

．

输

入

节

点

工
丨

  Ｉ

Ｉ

Ｉ

卜  ｜  ｜

ＦＩ


Ｉ


Ｉ

１

   ２

校

验

Ｃ ｉ

息

这

否

完

＾

］

ｌ

 ＜  ＾


Ｉ

｜

＞

］ １

 ＼

＼

校 验  Ｉ

３．

［

通过： 提交



Ｉ

Ｉ

Ｙ  Ｍ  提 节 ４ Ｎ ＾

１
． ，
！

！  
＾

４．

交 点 信 总  

   ＆ 按 照 ｖ』 ａ 名 称

！

Ｉ

！

     ！ ！

Ｌ Ｕ   ：

！

  、

＿

＿

Ｉ

丨

Ｉ

Ｉ

Ｉ

  对 比并更新记采 ｜ 丨 丨

  ＆ 疗沾新 记录 ； １ Ｉ

   ｙ ． 返 回 结 采 ｕ  

！

！

！

  返 回 结 史 Ｋ １

 返 回 结 罘 ＜  

Ｉ

Ｉ

１ １．

 ｜

＾

丨

０ １

．

 １
１ １

匕

返 问 结 １ ＜   ＊



２ １

．

！

ｆ

Ｉ

Ｉ

ｌ ｉ



ｌ

Ｉ

｜

    ｉ

ｉ

ｉ

Ｉ

Ｉ

图 ６ ５ － 修 改 节 点 信 息 时 序 图

用 户 选 取 需 要 修 改 信 息 的 节 点 ， 填 写 修 改 信 息 并 提 交 ， 前 端 使 用 Ｐ Ｏ Ｓ Ｔ 方 法  

访 控 制 接 问

层 中 的 Ｍ Ｕ ｐ ｄ ａｔ ｅ

ｅｍ ｂｅｒ

口 ，

将 含 有 修 改 信 息 的 Ｍ ｅ ｍ ｂ ｅ ｒ 类 对 象 传 入 控  

制 层 ， 控 制 层 调 用 业 务 逻 辑 层 的 相 应 方 法 ， 业 务 逻 辑 层 则 需 要 使 用 数 据 持 久 化 层

法 称 键 据 查 中 Ｍ 的 力 Ｒ ｅ ｍ ｂ ｅ ｒ

ｅ ｐ ｏ ｓ ｉ ｔ ｏ ｒｙ

ｆｉ ｎ ｄ Ｂ ｙ Ｎ ａ ｍ ｅ

以 甘点 名
，

为 关 手 从 数 库 中 询

该 节 点 的 信 息 记 录 ， 并 将 其 暂 存 为 一 个 节 点 信 息 类 对 象 。 随 后 将 暂 存 的 对 象 和 传

入 的 参 数 进 行 对 比 和 更 新 ， 最 后 将 更 新 后 的 结 果 传 入 数 据 持 久 化 Ｗ ， 存 储 到 数 据

３ ９

北京 邮 电大学工 学硕士学位论文



  

库 并 返 回 操 作 结 果 。 控 制 层 得 到 反 馈 结 果 后 生 成 一 个 Ｂ ａｓｅＤ ａｔａ 类 对 象 ， 作 为 对  

前 端 的 返 回 结 果 。 查 询 和 删 除 节 点 信 息 的 流 程 也 与 之 类 似 。  

节 点 信 息 管 理 中 的 新 增 节 点 信 息 功 能 的 使 用 则 存 在 两 种 情 况 。 一 类 是 系 统 管

理 员 用 户 通 过 前 端 界 面 提 交 节 点 信 息 ， 经 过 控 制 层 、 业 务 逻 辑 层 、 数 据 持 久 化 层

方法 的逐层调 用 ，

前端页 面提交一个包括节 点 名 称 、

地 址 Ｉ Ｐ

、

公 钥 信 息 等 数 据 的

节 点 信 息 类 对 象 ， 控 制 层 将 该 对 象 传 递 到 业 务 逻 辑 层 ， 业 务 逻 辑 层 调 用 数 据 持 久

化 层 中 的 查 询 接 口 ， 确 认 系 统 中 尚 未 存 储 有 该 节 点 记 录 后 将 节 点 信 息 写 入 节 点 信

息 表 中 。 随 后 系 统 逐 层 返 回 新 增 节 点 的 结 果 ， 最 终 由 前 端 页 面 对 用 户 进 行 结 果 的

告 知 。 另 一 种 情 况 则 发 生 在 节 点 接 收 到 来 自 未 知 节 点 的 商 品 信 息 包 时 ， 此 时 由 区  

块链辅助模块调用 节点管理模块中

的 新增 节 点 方法 ，

操 作 结 果 不 需 要 返 回 给 控 制  

层 和 前 端 页 面 。  

５ ． ３ 商 品 属 性 管 理 模 块  

商 品 在 流 转 过 程 中 会 产 生 多 种 需 记 录 的 信 息 ， 如 商 品 的 规 格 、 体 积 、 重 量 、  

质 检 情 况 等 ， 此 类 信 息 在 系 统 中 被 抽 象 为 商 品 属 性 类 Ａ Ｐｒｏ ｔｒｉ ｂ ｕｔｅ ， 其 中 ｉ ｎｐｕｔ ｔｙ ｐｅ   ＿
字 段 表 示 该 类 信 息 的 录 入 方 法 ， 包 括 选 择 和 输 入 两 种 录 入 方 法 。 若 使 用 选 择 型 录  

给 入 则 需 要 在 ，

中 ｎ ｐ ｉ

ｕｔ

ｌ ｉ ｓｔ

出 备 选 项 ， 存 储 时 各 取 值 使 用 “ ” 进 行 分 隔 。   ；

＿

每件商 品 在一次信 息录入过程 中 往往 需要录入 多种 属性信 息 ，

而 每 种 属 性 信

息 也 会 在 多 种 商 品 的 录 入 过 程 中 被 使 用 。 因 此 系 统 引 入 了 商 品 类 型 信 息 ， 每 个 商  

品 类 型 中 包 括 若 干 个 商 品 属 性 。 两 者 通 过 一 个 辅 助 类 建 立 映 射 关 系 。 商 品 属 性 和

商 品 类 型 的 类 图 如 图 ５ － ７ 所 示 。  

Ｐ ｒｏ Ｔｖ ｐ ｅ  

ｏ ｄ  － ｉ

：

ｌ

ｎ ｇ  

ｍ  厂 － ｎ ａ

ｅ Ｓ  ： ｔ ｒ ｉ ｎ ｇ

  —

  

１

丁 Ｔ Ｔ Ｔ Ａ － ｃ ｒ ｅ ａ ｔ ｅ

ｍ ｉ

ｅ ：

ｉ ｍ ｅ Ｓ ｔ ａｍ ｐ芡

ｙｐｅ ｏ

ｔｒ
  

＇

Ｔ Ｔ  － ｕ ｐ ｄ ａ ｔ ｅ

ｍ ｉ

ｅ  ：

ｉ ｍ ｅＳ Ｅａｍ ｐ

＇

ｄ ｏ ｇ    － ｉ

 ：

ｌ

ｎ

Ａ －

ｔｔ

ｒ

ｉ

ｂ

ｕｔｅ

ｌ

ｄ

 ：

ｌ

ｏ

ｎ

ｇ

Ｔ  

－

ｙ

ｐ

ｅ

ｌ

ｄ

 ：

ｌ

ｏ

ｎ

ｇ

ｉ

Ａ Ｔ Ｔ Ｐ ｒｏ

ｔｔ ｒｉ ｂｕ ｔｅ －ｃｒｅ ａ ｔ ｅ

ｍ ｉ

ｅ ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

 Ａ Ｔ － ｄ ｏ ｇ ｉ

：ｌ

ｎ

＾ ｓｅｔ

ｒ ｔ ｔ

ｉ

ｂ

ｕｔｅ

ｌ

ｄ （

ｆｙ

ｐｅ

： Ｐ ｒｏ

ｖ ｐ ｅ ） ：  ｖ ｏ ｉ ｄ

 Ｔ Ａ ｍ － ｎ ａ

ｅ Ｓ ：  ｔ ｒ ｉ ｎ ｇ

＾ｓｅｔ

ｙ ｐｅ

ｌ

ｄ ｊ

ａ

ｔ

ａｉ

ｂｕｔ

ｅ

： Ｐ ｒｏ

ｂ ｔ ｔ ｒ ｉ

ｕ ｔ ｅ ） ：  ｖ ｏ ｉ ｄ

－
ｎ ｐ ｕ ｙ ｐ ｎ ｉ

ｔ

ｒ

＿

ｅ  ：

ｉ

ｔ  

Ｓ ｔ ｒ ｉ ｎ ｇ  

Ｔ Ｔ － ｃ ｒ ｅ ａ ｔ ｅ

ｍ ｉ

ｅ ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ  

Ｔ Ｔ － ｕ ｐ ｄ ａ ｔ ｅ

ｍ ｉ

ｅ  ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

图 ５ － ７ 商 品 属 性 类 图

５ ３ ．

．１

商 品 属 性 管理  

针 对 商 品 属 性 信 息 的 管 理 包 括 对 商 品 属 性 的 新 增 、 查 找 、 修 改 和 删 除 。  

４ ０

第 五章 商 品 溯源 原 型 系统详细 设 计与 实现



  

用 户 在 新 增 商 品 属 性 时 将 在 前 端 页 面 填 写 相 应 信 息 ， 前 端 按 照 用 户 填 写 的 信  

息 生 成 一 个 商 品 属 性 类 对 象 ， 将 其 作 为 参 数 使 用 Ｐ Ｏ Ｓ Ｔ 方 法 提 交 到 控 制 层 。 控 制

层将对该对 象进行校验 ，

确认信 息完整后调 用 业务逻辑层 中 的

Ａ ａ ｄ ｄ

ｔｒｉ ｂ ｕｔｅ

方 法  

将 该 对 象 传 入 业 务 逻 辑 层 。 业 务 逻 辑 层 中 将 对 传 入 的 参 数 再 次 进 行 校 验 ， 确 保 数  

据 库 不 存 在 同 名 商 品 属 性 后 调 用 数 据 持 久 化 层 方 法 将 其 存 储 到 数 据 库 中 ， 并 将 处  

理 结 果 返 回 到 控 制 层 。 控 制 层 根 据 业 务 逻 辑 层 返 回 的 结 果 生 成 返 回 给 前 端 的 Ｂ ａ ｓ

对 象 Ｄ ｅ

ａ ｔａ

，

如果添加成功 ，

其 ｄａｔａ 字 段 内 容 为 新 添 加 的 商 品 属 性 对 象 。

商 品 属

性 信 息 的 修 改 与 其 新 增 流 程 基 本 相 同 ， 仅 在 业 务 逻 辑 层 的 校 验 中 存 在 区 别 。 修 改

时 需 要 数 据 库 中 存 在 同 名 的 商 品 属 性 记 录 。  

＾

￣￣

￣  

ＳＭ１ 业 务 逻 辑 Ｍ

数拋 持 久 化

丽 凹  类  类 而 ，

１＞ 、

Ｔ Ｃ Ｐ ｒ ｏ

ｙ ｐｅ

ｏ ｏ ｎ ｔ ｒ

ｅ ｌ

ｌ

ｒ

Ｐｒｏ Ｔｙ ｐｅ Ｓ ｅ ｒ ｖ ｉ ｃ ｅ

Ｒｅｐｏ ｓｉｔ

接 ｒｙ 口

￣

—

ｏ

  ｒｓｋ 待 查 询 类 型

！ Ｉ

！

Ｉ  

＾  ；   ！
！

   提 交 待 査 戈 型 ２ ．

ｆｉ ｉ

）

丨

！

丨

丨

Ｉ

 ４ Ｉ
  ＨＭ ｜

捉 类 型 查 询  ３ ．

ｉ ；

ｉ

ｄ ｉ

，

Ｉ  

该类型与 属性的映射 Ｉ

｜ ］

  Ｉ Ｉ Ｉ

 ｜ ］

  Ｉ

Ｉ

Ｉ

 Ｉ  



 结 抽 取 性 丨
丨
   

人 ５

＞

．

ｊ ｊ 

｜

ｒ

果屮

属

Ｄ Ｉ
｜  
Ｉ  

Ｉ

Ｉ

Ｉ

  衣次 杏 尚 厲竹 ｉｄ对 ！   ！ ！


？


｜

１应

的

屈

性详

情

１

  ？ ｈ   Ｉ
Ｉ

ｋ



—

Ｉ

ｐ

 Ｉ Ｉ Ｉ

  Ｌ    １ Ｉ

Ｕ

Ｓ Ｓ ７ｊ §Ｊｉ

ｉｉ Ｓ

ｉ

＇



！ ：

＿＿

＾ Ｂ ｎ   ９ ｊ ．

ｇ ［

Ｊ

ａ ｓｅ

ａｌａ
 ｉ

Ｉ

Ｉ



ｌ

ｌ

ｉ



Ｉ

ｌ

ｌ

Ｉ

ｌ

ｉ


ｌ
 ＞

ｌ

ｌ


？

？  

图 ５ － ８ 查 询 商 品 属 性 详 情 时 序 图

系 统 中 对 商 品 属 性 的 查 询 包 括 两 类 ， 即 精 确 查 找 和 集 合 查 找 。 精 确 查 找 即 以  

商 品 属性

Ｄ
Ｉ

作 为关键词精确 查找对应 的 唯一记录 。

集 合 查 找 则 是 查 找 某 商 品 类  

型 包 括 的 全 部 属 性 ， 在 管 理 商 品 类 型 、 录 入 商 品 信 息 时 均 会 使 用 到 集 合 查 找 。 其

输 类 输 流 程 如 图 ５ － ８ 所 示 。 该 流 程 的

入是商 品

型 的 Ｄ Ｉ

，

出 则 是 个 一

Ａ Ｐ ｒ ｏ

ｔ ｒ ｉ ｂ ｕ ｔ ｅ

类对象的列表 ，

主 务 逻 辑 方 法 成 要 使 用 业

层 中 的 Ａ ｇ ｅ ｔ

Ｂ Ｔ ｔ ｔ ｒ ｉ ｂ ｕ ｔ ｅ ｓ

ｙ

ｄ ｉ

完

。

该 方 法  

中 首 先 生 成 一 个 成 员 为 商 品 属 性 类 对 象 的 空 列 表 ， 随 后 调 用 数 据 持 久 化 层 中 的 方  

法 对 商 品 类 型 － 映 射 表 进 行 查 询 ， 返 回 与 该 商 品 类 型 相 关 的 记 录 集 合 。 继 而 从 记  

录集合中 取 出 相应的商 品 属性

Ｄ Ｉ

，

调 用 对 属 性 的 精 确 查 找 方 法 获 得 相 应 的 属 性  

对 象 并 将 属 性 对 象 追 加 到 空 列 表 中 。 最 后 将 属 性 对 象 列 表 作 为 功 能 的 输 出 进 行 ，

返 回 。  

４ １

北京邮 电大学工学硕士学位论文



  

在进行对商 品 属性的操作时 ，

需要考虑商 品类型与商 品属性存在联系 ，

即 商  

品 类 型 信 息 中 包 括 对 商 品 属 性 信 息 的 引 用 。 直 接 对 商 品 属 性 记 录 进 行 删 除 将 导 致  

商 品 类型信息受到影响 。

因此系统规定 ，

删 除 商 品 属 性 时 需 要 对 该 商 品 属 性 的 使

用数，

即 与该商 品 属性相关 的 商 品－类型联系记录数进 行查询确认 ，

当 数 量 为 ０  

时 ，

才能调用 数据持久化层 中 的 数据删 除接 口 ，

对 商 品 属 性 记 录 进 行 删 除 。  

２ ５ ３ ．

．

商 品 类 型 管 理  

商 品 类 型 信 息 的 管 理 包 括 对 商 品 类 型 信 息 的 新 增 、 修 改 、 删 除 和 查 询 。 流 程  

与 商 品 属 性 管 理 类 似 。  

商 品 类 型 新 增 功 能 的 输 入 是 用 户 在 前 端 页 面 输 入 的 商 品 类 型 定 义 信 息 前 端   ，

页 面 将 其 包 装 为 一 个 商 品 类 型 参 数 类 Ｐ ｒ ｏ Ｔｙ ｐ ｅ Ｐ ａｒ ａｍ 对 象 传 入 控 制 层 ， 其 类 图 如

所 示 其 字 段 存 放 该 类 包 商 性 图 ５ － ９

。

中 Ｌ ｂ ａ ｔ ｔ ｒ ｉ

ｕｔ

ｉ ｓｔ

用于

商品 型 含的 品属

Ｄ Ｉ

。  

Ｐ ｒ ｏ Ｔｙ ｐ ｅ Ｐ ａ ｒ ａ ｍ  

－

ｎ

ａ

ｍ

ｅ

Ｓ
：

ｔ

ｒｉ

ｎ

ｇ  


ｊ

ｂ Ｌ ｏ ｎ ｇ ａ －

ｔ ｔ ｒｉ

ｕｔｅ

ｓ  ｓ－

ｉ

ｔ：

ｌｉ

ｔ

ｉ

＞  

Ｉ

图 ５ － ９ 前 端 传 参 类 图

新增 商 品类型信 息 的流程如 图

０ ５ － １

所 示 。  

￣

￣

 抟 ＿  逻 辑 Ｋ 数 据 持 久 化 Ｓ 酸 忆 ’

否
八

而

 类   Ｃ １

接 Ｐ ｒ ｏ Ｔ ｙ ｐｅ

＾ ｎ ｏ ｏ ｅ ｔ ｒ

ｌｌ

ｒ

ｌ

务 ｋ 、 丨

Ｔ Ｐ ｒ ｏ

ｐ ＞  ｅ Ｓ ｅ ｒ ｖ ｉ ｃ ｅ

Ｒｅ ｐｏ ｓ ｉ ｔ ｒｙ

□  

ｏ

＾ 

  １

Ｉ

Ｉ

  ｊ

 Ｕ ｉ

提
．

交包

含

必要

参

数

Ｉ

｜

｜

 的 类 对   ｌ

ＰｒｏＴｖ ｐｅ Ｐ ａ ｍｍ

 

Ｉ

ｌ

ｌ

  ｉ

象

 校 验 数 ＜ ｉ


ｂ ，

參 迠否 为宁 ｉ  

  Ｉ

ＬＪ


丨 Ｉ

 ！

３ ．

校验通过

提ｉ商 品

［

］

ｉ

类 型 名 称和 包 含 的 尚 品  ４？校验屈 性ＩＤ娃 否

｜

；

丨

｜  

  屈 性 ｍ 列 表 合 法  

Ｉ

Ｉ

  Ｉ

Ｉ

Ｉ

Ｙ５ ． ［ 校 验 通 过 ］ 将 商 品 类 型

Ｉ

记朵 Ｕ 入 数据 赤

Ｉ

＾  １

   

Ｉ

ｉ

Ｌ

６返 ．

Ｍ

操

作

结

果

Ｕ

  ｒ－

Ｉ

Ｉ

ｉ

  生成尚 品 类型－商品

！

Ｉ

｜

  屈 性 映 射 记录

Ｉ

Ｉ

Ｉ



 提 录 ８ ．

义 ｉ己

Ｉ

｜

｜  



 
Ｉ
 Ｉ

 １

ｂ１

０ ．

返

冋

结

果

＾９

诉

冋

操

作 维多粜  Ｖ   —

，

 返 结  卜—

Ｉ

回＊

  ｉ Ｉ

＜－
ｌ

 



？

１

Ｉ


Ｉ

 Ｉ

Ｉ  

图

５ ０ － １

新 增 商 品 类 型 时 序 图

４ ２  

第五 章 商 品 溯源原 型系统详细设计与 实现



  

新 增 商 品 类 型 信 息 时 ， 前 端 将 使 用 Ｐ Ｏ Ｓ Ｔ 方 法 访 问 控 制 层 的 ａｄｄ ＰｒｏＴｙｐｅ 方   法 。 控 制 层 对 前 端 传 入 的 参 数 进 行 校 验 ， 传 入 的 参 数 中 商 品 类 型 名 称 、 属 性 ＩＤ  

列 表 必 须 不 为 空 。 确 认 信 息 完 整 后 将 类 型 名 称 和 属 性 Ｉ Ｄ 列 表 传 入 业 务 逻 辑 层 ，

调 用 业 务 逻 辑 层 中 的 ａｄｄＰｒｏ Ｔｙｐｅ 方 法 。 业 务 逻 辑 层 对 属 性 Ｉ Ｄ 列 表 进 行 检 验 ， 确

保其均 为合法 的 属 性

Ｄ Ｉ

。

随后调用 数据持久化层 中 的接 口 ，

生 成 商 品 类 型 记 录  

并写入数据库 中 。

系统根据生成的商 品 类型

ＩＤ

和传入 的 商 品 属性

Ｄ Ｉ

，

生 成 相 应  

的 一 组 商 品 类 型 － 商 品 属 性 映 射 类 对 象 ， 并 将 其 写 入 数 据 库 。 最 后 将 操 作 结 果 逐  

层 返 回 到 前 端 页 面 。  

删 除商 品 类型时输入为商 品类型 的

Ｄ Ｉ

，

其流程与新增 商 品类型类似 ，

需 要  

将 与 待 删 除 商 品 类 型 相 关 的 商 品 类 型 － 商 品 属 性 映 射 记 录 一 并 从 系 统 中 删 除 。

５ ． ４ 商 品 信 息 管 理 模 块  

该 模 块 包 括 商 品 信 息 査 询 、 商 品 信 息 录 入 、 二 维 码 管 理 三 个 子 模 块 。 商 品 信 息 查 询 和 商 品 信 息 录 入 子 模 块 负 责 相 关 功 能 的 实 现 。 二 维 码 管 理 子 模 块 则 负 责 提   供 二 维 码 生 成 和 二 维 码 识 别 的 接 口 ， 协 助 其 他 子 模 块 实 现 功 能 ， 其 底 层 功 能 的 实 现 使 用 了 开 源 条 码 处 理 库 Ｚｘｉｎｇ 。 本 节 主 要 对 商 品 信 息 查 询 和 商 品 信 息 录 入 子 模   块 进 行 说 明 。  

５ ４ ．

．１

商 品 信 息 查 询  

商 品 信 息 的 查 询 指 的 是 用 户 对 某 一 件 商 品 全 部 流 转 信 息 的 查 询 。 用 户 可 以 通  

过 提 交 实 体 商 品 上 附 着 的 二 维 码 图 片 或 输 入 商 品 Ｉ Ｄ 来 进 行 查 询 。 当 用 户 提 交 二  

维 码 图 片 时 ， 前 端 页 面 传 入 控 制 层 的 参 数 是 图 片 形 式 ， 控 制 层 需 要 调 用 二 维 码 管  

理子模块 中 的二维码识别方法 ，

从方法 的返 回 值 中 获取商 品

Ｄ Ｉ

，

再 由 控 制 层 以  

商品

ＩＤ 作 为参 数调 用 业务逻辑层 中 的 查询方法 。

而用 户提交商 品

时 Ｉ Ｄ

，

前 端 页

面 将 直 接 使 用 Ｇ Ｅ Ｔ 方 法 ， 将 商 品 Ｉ Ｄ 提 交 到 控 制 层 ， 控 制 层 直 接 以 商 品 Ｉ Ｄ 字 符

串 为参数调用 业务逻辑层 中 的 查询方法 。

其 流 程 如 所 示 图 ５ － １１

。

４ ３

北京 邮 电大学工学硕士学位论文



  

户 商 品 郎 行 理 模 块

技 制 足 （

）

（

杏 洵商品倍息

＜ ￣
）

获取 参数

）

鉍 数 足 否 为 商 品 Ｍ ）  

Ａ ＜ 识 別 ｉ  ｉ

ｉ

维码 ）  

＂

－

（ 中 丨 卜）  

Ｔ   提 ／ ＜ （

交 按 照 商 查 商 品 ４ ⑴



）



＾
■

品 １Ｄ

间 ＾
）  

＾

 ／

（ ｍ ｅＳ ＾  ）

ｈ －

＾  

＾ ＜ ； ｓ

ｓ  ）  

图

５－ １１

商 品 信 息 查 询 活 动 图

业 务 逻 辑 层 的 商 品 信 息 查 询 方 法 参 数 为 商 品 Ｄ Ｉ 字 符 串 收 到 参 数 后 业 务 逻   ，

辑 层 将 调 用 区 块 链 辅 助 模 块 中 的 查 询 方 法 ， 继 而 区 块 链 辅 助 模 块 调 用 数 据 持 久 化  

层 的 业 务 数 据 查 询 接 口 对 Ｍ ｏ ｎ ｇｏ Ｄ Ｂ 中 存 储 的 商 品 信 息 块 进 行 查 询 。 数 据 持 久 化

模 块 在 Ｍ ｏ ｎ ｇ ｏ Ｄ Ｂ 中 查 询 相 应 记 录 ， 随 后 将 记 录 集 合 作 为 结 果 进 行 逐 层 返 回 。 商 品 信 息 查 询 模 块 对 记 录 按 照 生 成 时 间 顺 序 进 行 排 序 ， 并 将 排 序 结 果 返 回 到 控 制 层 。  

控制 层根据业务逻辑层返 回 的结果 ，

向前端页面返回 相应的

Ｄ Ｂ ａ ｓ ｅ

ａｔａ

对象 。

在

正 常 的 查 询 流 程 中 ， Ｂ ａ ｓ ｅ Ｄ ａｔａ 对 象 中 的 ｄ ａｔａ 字 段 将 包 括 已 经 排 序 好 的 商 品 流 转  

记录 。

使用 二维码进行商 品 信息 查询 的流程如 图

２ ５ － １

所 示 。

４ ４

第 五章 商 品溯源原型 系统详细设计与 实现



  

 ＷＭｓ 商 品 信 息 ｋ 块 链 辅 助 数 据 持 久 化  

＿

 ５ 询 模 块 ｜

Ｊ Ｐ ｒ ｏ ｄ ｕ ｃ ｔ Ｃ ｘ

ｍ ｎ ｔ

ｅ ｌ ｌ

ｒ

；

模 块  

｜

丨

１ ＾

 上 传 抑 品 维 ＾ ｉ

．

！

二

？

   Ｉ   Ｉ Ｉ




：   ！ ！

！

Ｙ 提 商 品 维 码 ２ ．

Ｘ

二

ｋ

  Ｉ Ｉ 丨

  ｎｎ  

 １ ＇

｜

Ｉ

厚 ３ 丨

只！

 丨 丨

ｉ

ｉ  

ｉ ｉ

 提 交 商 品     ４

Ｉ

．

ＩＤ

＾

Ｉ

Ｉ

Ｉ

   ：

！

！

！

 ｎ   ＇ ｉ ｉ

 ！  

］

Ｉ
 舍 刑 记 １

６ ．

，！

ｊ

：  

   ］

，

  １

Ｉ

１

 —   

ｌ

  

 ７ ． 返 回 ｓ 询 结 果

  — 卞 ！

！

！

＾
丨

． 卵魏賴

 Ｖ

ｊ 丨

  ｆ 序 后 的  ＾ Ｏ Ｓ ｕ ｌ

．ｊ

ｌ

ｌ



Ｉ

Ｉ

｜ Ｉ



ｋ  对 站 进 序 （＞ ．

奋 句 丨

果

打彳

ｆ

Ｊ  

—

ｉ

｜

   ２ １
｜

ｒｐ

ｊ Ｗ 据 返 ｎ 结 果 生  ｌ 丨

．





｜

ｊ

＿

 丨

成 —找

 丨 ； 丨

！

＇

＇

ｉ ｉ ｉ

图

５ ２ － １

使 用 二 維 码 查 询 商 品 信 息 时 序 图

４ ２ ５ ．

．

商 品 信 息 录 入  

根 据 对 应 现 实 场 景 的 不 同 ， 商 品 信 息 被 划 分 为 四 类 ， 即 商 品 生 产 信 息 、 发 货

信 息 、 收 货 信 息 和 商 品 记 录 信 息 。 商 品 信 息 的 录 入 分 为 三 个 步 骤 ： 商 品 二 维 码 处  

理 、 获 取 待 录 入 商 品 属 性 和 将 商 品 信 息 提 父 到 区 块 链 。  

１

商 品 二 维 码 处 理 。

）

此 步 骤 主 要 针 对 发 货 信 息 、 收 货 信 息 和 记 录 信 息 的 录 入 。 录 入 商 品 的 生 产 信

息 时 商 品 尚 未 被 分 配 Ｄ Ｉ 和 二 维 码 ， 系 统 需 要 根 据 用 户 选 择 的 商 品 类 型 和 商 品   ，

的 生 产 时 间 、 地 点 等 因 素 ， 在 信 息 录 入 完 成 后 为 商 品 生 成 唯 一 的 Ｄ Ｉ 和 相 应 的 二  

维 码 。 在 而 录 入 商 品 的 发 货 信 息 、 收 货 信 息 和 记 录 信 息 时 ， 商 品 已 经 与 二 维 码 进  

行 了 绑定 ，

因此需要对商 品 二维码进行识别 ，

获取商 品 的

Ｄ Ｉ

，

检 查 商 品 的 状 态 。

识别二维码的流程如 图

５ ３ － １

所示 。

首先 ，

用 户 在 前 端 界 面 的 相 应 位 置 提 交  

待 录 入 发 货 信 息 的 实 体 商 品 上 附 着 的 二 维 码 ， 前 端 页 面 将 对 用 户 上 传 的 二 维 码 图

片格式和 大小进行检验 ，

若二维码不是图片格式或图片 大小大于

ＭＢ

１

，

前 端 页

面 将 拒 绝 用 户 的 提 交 请 求 并 给 出 相 应 提 示 。 格 式 合 法 的 二 维 码 图 片 将 作 为 参 数 传  

递 到 系 统 的 控 制 层 ， 控 制 层 将 调 用 二 维 码 管 理 模 块 中 的 Ｑ ｒｅ ａ ｄ Ｒ ｃ ｏ ｄ ｅ 方 法 对 传 入  

的数据进行解码 ，

从中获取商 品

Ｄ Ｉ

。

随 后将根据商 品

Ｄ 丨

，

通 过 在 区 块 链 中 查 询

该 商 品 的 最 新 记 录 获 知 商 品 的 控 制 者 ， 检 验 当 前 节 点 是 否 符 合 录 入 该 商 品 信 息 的

要 求 。 若 当 前 节 点 符 合 要 求 ， 则 检 验 通 过 ， 进 入 下 一 步 骤 。 否 则 将 向 用 户 返 回 相

应 的 失 败 提 示 。

４ ５

北京 邮 电大学工学硕士学位论文



  

ＷＷＷ

  用 户 前 端 页 面

Ｃ ＾ ｍ Ｐ ｒ ｏ ｄ ｕ ｃｔ ｏ ｎ

ｃ ＞ Ｉ Ｉ

ｒ

尚

品

佶

息

录

入

模

块

Ｋ

块

链

＇
轴

助

模 块  

传 维 上

１

．

说品 一



说

丨

｜



Ｉ

Ｉ

Ｉ ！

 Ｍ  

Ｉ

Ｉ

Ｉ

Ｉ

   捡 验 一 维 码 挤 ４

］

＾  

｜

｜  

Ｊ ［

檢 验 通 过 提 交 ＿ 品 维 码    「 ：， ？

Ｉ

Ｉ

１

「



｜

Ｉ  

 ＾

＂

！

：

 ］ ［
   ＾ ４ ． 提 夂 商 品 — 维 码

Ｊ

｜

Ｊ

ｙ

对 维 —

码 进 解 丨亍

．

＿＿

！

！

！

［

   ｜

Ｉ

Ｉ

 朽 ４ １

１

？

获 得 商 品 ｄ ｉ

Ｉ  

，

，



Ｉ

Ｉ

！

Ｉ

ｉ

ｌ


ｌ Ｉ

   提 商 幺

＆ Ｄ Ｉ

，

饩询该

｜

｜

ｊ

     

！

！

ｊ







Ｉ

Ｉ

！

Ｉ

！

＾ ■

８ ． 检 ｆ ｔ 拧 制 芥 状 态 与

’

   Ｋ 配 返 回 品 ｙ ，

尚

） 丨

丨

｜

１

 ［

；

ｙ 商品采入Ｇ息炎型 总

１

；

Ｉ

｜

 

Ｉ

Ｉ

 ＾  否 匹   ？

ｄ ｆ ｉ

Ｉ  



＿

识   昆 小 、

１

１

．

｜



ｊ

ｊ  

二过 ，

页 而 跳转   

Ｉ

１

｜

！  

狀 态



Ｉ

ｉ

３

Ｉ

Ｉ  

    Ｉ

ｉ

ｉ

Ｉ

Ｉ  

图

５ ３ － １

录 入 商 品 信 息 二 维 码 处 理 流 程 时 序 图

２ 获 取 待 录 入 的 商 品 属 性 。 ）
二 维 码 识 别 完 成 后 进 入 待 输 入 属 性 的 获 取 步 骤 。 前 端 页 面 由 二 维 码 上 传 页 面  

切换为商 品 信息类型选择页面 。 该过程 中 前端页面 会调 用 商 品信息类型 查询方法 ，  

向 用 户 显 示 可 输 入 的 商 品 类 型 列 表 。 随 后 用 户 将 选 取 待 输 入 的 商 品 类 型 ， 此 时 前

端 将 使 用 Ｇ Ｅ Ｔ 方 法 将 该 商 品 类 型 信 息 传 入 后 端 ， 后 端 将 调 用 商 品 属 性 信 息 查 询

功 能 流 程 如 节 所 述 （

章

５ ３ ．

１ ．

） ，

向 前 端 返 回 含 有 一 个 商 品 属 性 列 表 的 结 果 。

３ 将 商 品 信 息 提 交 到 区 块 链 。 ）
用 户 将 商 品 流 转 信 息 的 具 体 值 填 入 前 端 页 面 的 相 应 位 置 。 前 端 页 面 根 据 用 户  

填 值 生 成 类 端 进 信 入 的

相 应 的 Ｔ ｒ ａ ｎ ｓ Ｉ ｎ ｆｏ Ｐ ａｒ ａ ｍ

对 象 作 为 与 后 ｔ ｒ ａｎ ｓ 丨 ｎ ｆｏ Ｐ ａ ｒ ａ ｍ ，

行

交 数 传 端 类 体 情 其 息 互 的 参

入后

。 Ｔｒ ａ ｎ ｓ Ｉ ｎ ｆｏ Ｐ ａｒ ａ ｍ

的具

况 如 所 示 图 ５ ４ － １

。

中 ｐ ｉ ｄ

字段 内 容即 为商品

Ｄ Ｉ

，

在 生 产 信 息 录 入 时 本 模 块 需 要 为 商 品 进 行 Ｄ Ｉ 的 生 成 ，

而

在 其 他类 型 信 息 录入 时 ，

Ｄ Ｉ 通 过 二 维 码 扫 描 过 程 获 取 。

Ｔｒ ａ ｎ ｓ Ｉ ｎ ｆ ｏ Ｐ ａ ｒ ａ ｍ  

－

ｐ

ｉ

ｄ

Ｓ  ：

ｔｒ

ｉ

ｎ

ｇ  

－ ｑ ｒ ｃ ｏ ｄ ｅ ：  Ｓ ｕ ｉ ｎ ｇ  

ｂ Ｓ ｎ ｇ ａ －

ｔｔ ｒ ｉ

ｕ ｅｓ ＾

ｔ

 ｓ ：

ｌｉ

－
ｔ

ｒ ｔ

ｉ

＞

＇

ｂ Ｘ Ｓ ｎ ａ －

ｔｔ ｒ ｉ

ｕ ｔｅ

ａ ｕ ｅ ｌ

ｓ  ｓ ＜ ：

１ ｉ

ｔ



ｔ ｒｉ

＞   ｇ



图

５ ４ － １

前 端 传 入 商 品 信 息 参 数 类 图

４ ６

第五章 商 品溯源原型系统详细设计与实现



  

的 和 字 段 为 实 际 录 入 商 信 中 ｔｒａｎｓＩ ｎｆｏ Ｐ ａｒａｍ

ａｔｔｒ ｉ ｂｕｔｅ ｓ

Ｖ ａｔｔｒ ｉ ｂ ｕ ｔｅ ａｌ ｕ ｅ ｓ

即

的品

息 ，

它 们 将 在 商 品 信 息 录 入 模 块 中 被 一 对 一 应 拼 接 后 生 成 字 符 串 ，

随 后 提 交 到 区

块 链 辅 助 模 块 中 进 行 存 储 。 参 数 传 入 控 制 层 后 根 据 用 户 所 使 用 商 品 信 息 录 入 功 能  

的 不 同 ， 处 理 流 程 也 有 所 区 别 。 录 入 商 品 生 产 信 息 和 发 货 信 息 时 系 统 需 要 将 商 品

的 二 维 码 标 识 返 回 给 用 户 ， 录 入 收 货 信 息 和 记 录 信 息 时 则 只 向 用 户 返 回 录 入 是 否

成 功 。  

５ ． ５ 区 块 链 辅 助 模 块  

区 块 链 辅 助 模 块 用 于 将 用 户 录 入 的 商 品 流 转 数 据 封 装 为 商 品 信 息 块 ， 并 准 确

地 形 成 网 状 结 构 ， 存 储 在 系 统 的 各 节 点 中 。 该 模 块 包 括 数 据 录 入 、 数 据 査 询 、 加  

密 工 具 和 通 信 工 具 等 子 模 块 。  

数 据 录 入 模 块 负 责 将 商 品 信 息 录 入 模 块 传 入 的 信 息 封 装 为 区 块 ， 并 调 用 数 据  

持 久 化 模 块 、 通 信 工 具 模 块 中 的 方 法 完 成 数 据 区 块 的 存 储 和 同 步 ， 以 及 处 理 节 点  

接 收 到 的 来 自 其 他 节 点 的 数 据 。 数 据 查 询 模 块 负 责 在 本 地 记 录 中 根 据 指 定 关 键 字  

查 询 商 品 流 转 信 息 。 加 密 工 具 子 模 块 负 责 为 数 据 处 理 提 供 必 要 散 列 值 、 签 名 生 成  

和 校 验 方 法 ， 通 信 工 具 负 责 在 各 节 点 间 发 送 、 接 收 和 处 理 区 块 ， 从 而 保 证 系 统 中

的 商 品 信 息 数 据 难 以 被 篡 改 和 伪 造 。 通 信 工 具 子 模 块 中 使 用 了 队 列 框 架 Ｄ ｉ ｓｒｕｐｔｅｄ  

和 通 信 框 架 ｏ ｔ－ ｉ

，

框架主要用 于提供接收 、

发送数据包的 基础功 能，

并 协 助 系 统  

对 接 收 的 数 据 包 进 行 的 初 步 的 处 理 ， 其 介 绍 在 章 节 ２ ． ３ 中 给 出 。 系 统 中 使 用 ６ ７ ８ ９  

端 口 进 行 服 务 器 节 点 间 的 通 信 。  

询   数 据 查 ５ ５ ．

．１

区 块 链 辅 助 模 块 需 要 为 商 品 信 息 管 理 模 块 提 供 查 询 接 口 。 商 品 信 息 管 理 模 块

将 商 品 Ｉ Ｄ 传 入 区 块 链 辅 助 模 块 。 区 块 链 辅 助 模 块 中 根 据 商 品 Ｉ Ｄ 查 找 对 应 的 最

新 信 息 块 的 散 列 值 ， 找 到 后 根 据 信 息 块 中 的 Ｈ ｐｒｅＰｒｏ ａｓ ｈ 字 段 依 次 向 前 査 找 该 商

品 的全部流转信 息 。

其 流 程 如 所 示 图 ５ １ － ５

。  

４ ７

北京 邮 电 大学工学硕 士学位论 文



  

Ｑ Ｍ ＾  － ｕ ｅ ｒ＞

ａ ｎａ ＾ｒ
．

Ｔ ｎ ｒ ａ ｎ ｓ Ｓ ｅ

－
ｉ ｃ ｅ ｊｉｇ

丨

娜 歓 跳 ” 、  

 抟 待 询 商 品 的  １

．

入

６？

Ｉ

ｄ
ｉ

＾  Ｉ

 最  １

２ ． 查 询 该 商 品 新 条 －

Ｉ  

 记 录 数 据 块 的 ｎａ ｓ ｈ ｔｅ

Ｉ

 Ｖ ？ 

 —

Ｊ －

Ｉ

ｒ

ｊ  

 Ｌ

３ 返 冋 紅 询 结 汜   ．


Ｉ

片

ｙ  

 创 翅 查 询 结 汜 列 友
Ｉ ｜

 循 环

 Ｉ

５

Ｉ

 ．
＾

  查

询

到

的

尚

品

Ｒ

录 ＆ ，

ｉｄ

Ｉ

＿

！

Ｉ

Ｉ  

中 Ｈ  ＾ ｐ ｒ ｅ Ｐ ｒ ｏ 

Ｈ ａ ｓ ｈ ！ ＝

ａｓｈ

ｌ



  

７ 杓 结 果 加 入 列 表 ．


Ｉ Ｉ

 抽 取 结 果 屮 的 字 

｜

．

｜

ｐ

ｐ ｒｅ Ｐ ｒｏ Ｈ ａ ｓｈ

丨

  ＾ Ｊ － 段 的 值 作 为 新 的 卉 询 关 键 词

｜

ｐｉ

｜  

  Ｉ

Ｈ ｆ ｌ ｈ ａ ｓ

ｆ 

｜  

 Ｉ

Ｘ





｜   

里 ｍ Ｌ

土



ｐｉ吃拖 ｉ 烈 查





！


Ｉ



Ｉ

Ｉ

 ■



■  

ｉ

图

５ ５ － １

区 块 链 辅 助 模 块 数 据 查 询 时 序 图

数 据 ２ ５ ５ ．

．

录 入  

实现商 品 信息录入功能时需要调用 区块链辅助模块中 的数据录入接 口 ，

向 数  

据 录 入 模 块 输 入 商 品 信 息 类 型 和 商 品 信 息 数 据 。 数 据 录 入 模 块 将 把 商 品 信 息 数 据

封装为商 品 信息块 ，

存储在本地数据库 中 ，

并 根 据 商 品 信 息 的 类 型 将 其 发 送 到 其

他节点 处 。

而节点在收到来 自 其他节点 的商品信息块时 ，

需 要 进 行 相 应 的 校 验 。  

校 验 通 过 时 商 品 信 息 块 才 会 被 写 入 数 据 库 。

商 品 信息块如 图

５ ６ － １

所示 ，

其 中 ｉ ｎ ｆ ｏ 字 段 为 商 品 信 息 ，

其 值 即 为 商 品 信 息

录入模块传入的 原始商 品 信息记录 ，

由 商 品 信 息 录 入 模 块 对 用 户 填 写 的 商 品 信 息

数 据 和 属 性 名 称 一 一 对 应 拼 接 生 成 。  

Ｔ ｒ ａ ｎ ｓ ｌ ｎ ｆ ｏ  

ｐ Ｓ ｇ   －

ｃ  ｉ

ｌ ：

ｎ ｒ ｔ

ｉ

－ ｈ ａ ｓ ｈ Ｓ  ： ｔ ｒ ｉ ｎ ｇ  

Ｈ ｐ －

ｒｅ

ａ ｓ ｈ Ｓ  ： ｔ ｒ ｉ ｎ ｇ

ｍ   ｕ ｍ ｎ －

 ：

ｉ

ｐ ｎ ｕ ｍ ｎ －

 ：

ｉ

ｔ

Ｈ － ｐ ｒ ｅ Ｐ ｒ ｏ

ａｓｈ

Ｓ
：

ｔｒ ｉ

ｎ

ｇ

－ ｃ ｒ ｅ ａ ｔ ｏ ｒ Ｓ  ： ｉ ｒ ｉ ｎ ｇ

ｓ －

ｉ

ｇｎ

Ｓ
：

ｔ ｒｉ

ｎ

ｇ

ｇ ｎ ｏ Ｓ ｎ － ｉ

ｆ


：

ｔｒｉ

Ｔ Ｔ － ｃ ｒｅ ａ ｔ ｅ

ｍ ｉ

ｅ  ：

ｉ ｍ ｅ Ｓ ｔ ａ ｍ ｐ

图

６ ５ － １

商 品 信 息 块 类 图

４ ８

第 五章 商 品溯源原型 系统详细设计与实现



  

商 品 信 息 块 的 生 成 步 骤 包 括 散 列 值 （ ｈ ａ ｓ ｈ ） 的 生 成 、 签 名 （ ｓ ｉ ｇ ｎ ） 的 生 成 、  

对历史散列值 的 引 用 等步骤 。

流 其 程 所 如 图 ５ － １

７

示。

散 列 值 通 过 对 商 品 信 息 数

据进行哈希运算产生 ，

需要调用 加密工具模块中

的

Ｈ ｇ ｅ ｔ

ａｓｈ

方法 。

签 名 通 过 对 哈  

希 值 使 用 节 点 的 私 钥 加 密 生 成 ， 需 要 调 用 加 密 工 具 模 块 中 的 ｇ ｅ ｔ Ｓ ｉ ｇｎ 方 法 。 历 史  

散 列 值 的 引 用 则 需 要 在 本 地 数 据 库 中 查 询 当 前 节 点 生 成 的 最 新 信 息 块 散 列 值 和  

该 商 品 的 最 新 信 息 块 散 列 值 。

息 录 入 模 块 类 类   商 品 信

Ｔｒａｎ ｓ Ｓ ｅｒ ｖ ｉ ｃ ｅ

Ｃ ｈｅ ｃ ｋ Ｓ ｅ ｒｖ ｉ ｃ ｅ

￣￣

—

１

传 入 商 品 佔 Ｓ ｆ ｏ   １

．

．

ｎ ｉ

ｔ

！



Ｉ

｜



： ！

！

  Ｉ

２ ．

根据

商

品

Ｉ

Ｄ

ｆ ｅ

其 ｔｆ Ｏ

最新

佶

息块

的 ｈ ａｓ ｈ

ｆ ｌ

Ｉ
＾

」 ＃ 雖 Ｌ   ＾ １

冋

＿

＿



 ！

   Ｉ   Ｉ ｜ ｜

块  
Ｉ

 Ｉ

４ ．

杏询

、

前节点生

成的ｐ

新

信总

的 ｈ ａ ｓ ｈ ｔ ｆｌ

Ｉ
＾

丨



  

｜

 ｈ Ｉ

 １ 嶒 」  

６ 组 合 杳 结 句 ｉ 果 ．

丨

丨

获 ７ ． 取 组 合 结 《 ！ 的 散 歹 ＾

 ｑ

获 取 汶  名



Ｉ

．

Ｉ

！

Ｉ

   Ｉ

＾１］

０ 获取私钔

１

．

丨

  Ｌ ｕ 遞 蓝 ！ Ｌ ！
Ｉ

？

 一  ＿



 ＿ ＿ ＿

Ｉ

  ｒ  － ｉ
ｉ ｉ

ｎ 撒   ｒ Ｉ Ｉ
＾

使 出 私 郎  ２ １

．

？

列 值 加 密  

  Ｕ 

！  

；

Ｖ ＾ 成  ＾ １

１

  ＬＴ

江 ４ 】

．

卞 结果

！

！  

 ｉ

ｉ

１

   ｉ ｉ ｉ ｉ

ｉ ｉ ｉ ｉ

 ｉ

  ｉ ｉ

ｉ

图

５ ７ － 丨

商 品 信 息 块 生 成 时 序 图

其 中 Ｔｒａｎ ｓ Ｓ ｅ ｒ ｉ ｖ ｃ ｅ 类 为 数 据 录 入 服 务 的 提 供 类 ， 商 品 信 息 录 入 模 块 通 过 调 用  

该模块 的方法 ，

并传入商 品信息数据 ，

将 数 据 块 链 商 品 信 息

写入区

Ｃ 。

ｈ ｅ ｃ ｋ Ｓ ｅ ｒ ｖ ｉ ｃ ｅ

为加密工具类 ，

其 体 情 节 说 具

况在 章

中 ５ ５ ４

．

．

明 。  

根据商 品 状态 的 不 同 ， 商 品 信 息在录入时被划 分为 四 种类型 ，

即 生 产 信 息 、

发 货 信 息 、 收 货 信 息 和 记 录 信 息 。 在 处 理 不 同 类 型 信 息 的 录 入 时 ， 商 品 信 息 录 入  

模 块 将 调 用 区 块 链 辅 助 模 块 中 的 相 应 方 法 。  

１ 处 理 生 产 信 息   ）
处 理 生 产 信 息 时 ， 区 块 链 辅 助 模 块 仅 需 要 将 生 产 的 商 品 信 息 块 存 储 在 本 地 数   据 库 中 ， 同 时 更 新 本 地 节 点 的 最 新 哈 希 值 信 息 ， 并 将 该 商 品 的 控 制 者 初 始 化 为 当 前 节 点 。 由 于 生 产 者 是 商 品 供 应 链 最 上 游 的 节 点 ， 此 时 该 商 品 信 息 块 不 需 要 向 上  

４ ９  

北京邮 电大学工学硕士学位论文



  

同 步 。 只 需 要 根 据 商 品 信 息 管 理 模 块 传 入 的 商 品 流 转 信 息 生 成 商 品 信 息 块 并 通   ，
过 业 务 数 据 持 久 化 模 块 将 生 成 的 商 品 信 息 块 写 入 Ｍ ｏ ｎ ｇ ｏ Ｄ Ｂ 中 。

２ 处 理 记 录 信 息 ）

商 品 Ｑ 息 管 理 模 块 区 块 链 辅 助 模 块 业 务 数 据 持 久 化 模 块 区 块 链 辅 助 模 块  

本 点 点 上 游 （

甘

 ）

（

本

节

 本 点 ）

（

Ｖ

 ）

（

竹 点 ）

 ！

提 交 商 品 录 倍 总 １

．

ｄ ｉ



‘

Ｉ

   Ｉ

ｕ

！ ！  

＾￣ 录 ２ ． 入 商 品 信 ＆ ． 块   １

 Ｉ



Ｉ

＿ ＿ ＿

Ｉ  

 息 块 Ｉ

成 品 ＇
ｋ ３ ．

商

估


丨 Ｉ  

 ＇



＇

１

 ＾ ＾   Ｖ

４ ．

将

商

品

忾

 发 送 到 上 新 节 点

Ｉ  

！

验 息 块 校 ５ ． 商 品 位

Ｉ

Ｉ

—

 
｜



Ｉ Ｉ


｜

 Ｉ

￣ ￣   Ｉ

  ７ ． 验 证 通 过 将 商 品 信 总 块

Ｉ

１

］

｜

１

０ ．

存

＿

商

品

倍

＆

＞  ＜  

 存 储到 木地数识 库

Ｉ

￣ ￣

ｈ

ｌ


｜

  二

Ｔ

Ｉ

—

、

＜ Ｕ

—

＇

Ｌ  该 点 是 商 

］ Ｉ

４ １

１

．
 Ｖ』

４ 、

，

返

   ！


成 上 ？ 品 ＇

丨

－

各向

！

］

ｙ  

   块   步 商 品 ａ ＂

Ｉ

］

＠ ．

，

｜ Ｉ

图

５ ８ － １

商 品 记 录 信 息 处 理 时 序 图

如 图 所 示 ８ ５ － １

，

处 理记录信 息 时 ，

录 入 信 息 的 节 点 可 能 是 商 品 供 应 链 中 的

任意一环 ，

因 此此类信 息需要 向 上游节点 同 步 。

数 据 录 入 模 块 需 要 查 询 该 商 品 的

上一任控制 者节 点

（ 直接上游节点 ）

信息 ，

并将记录信 息块 发送到该节点 。

直 接  

上游节点 收到信 息后将对信 息进行校验 ，

校验无误后

向 录 入 信 息 的 节 点 返 回 确 认  

信 息 ， 并 将 该 信 息 块 存 储 本 地 数 据 库 中 。 若 直 接 上 游 节 点 不 是 该 商 品 的 生 产 节 点 ，

则 继 续 将 信 息 块 向 上 游 节 点 进 行 发 送 。 重 复 此 流 程 即 完 成 记 录 信 息 的 存 储 过 程 。  

３ 处 理 发 货 信 息   ）

如 图 所 示 ５ ９ － １

，

处 理 发 货 信 息 的 流 程 与 记 录 信 息 类 似 。 其 区 别 在 于 处 理 发

货 信 息 时 ， 系 统 还 需 要 为 后 续 的 收 货 做 准 备 。 商 品 的 收 发 意 味 着 商 品 控 制 者 的 转

移 ，

即 信 息录 入权 限 的转移 。

发 货 信 息 的 录 入 节 点 需 要 为 后 续 的 收 货 节 点 生 成 一  

个一次性使用 的验证码 ，

并将验证码写入 区块链 中 。

收 货 节 点 需 要 凭 借 该 验 证 码  

加 入 商 品 信 息 区 块 链 中 。  

５ ０

第五章 商 品溯源原型系统详细设计与 实现



  

   商 品 信 Ｇ 管 理 措 块

Ｒ 块 链辅 助 模 块

业 务 数锯持 久 化

Ｒ 块 链 辅 助 模 块  

      ％ 节 本 （

：与 ）

｜
（ 木节点 ＞
｜

｜
模块 （ 本节点 ）
｜

｜

上 （

节 点 ）  

｜


！



Ｉ

Ｉ  

录 入 商 品 信 息 块  

 生 成 收 货 ｍ 骏  Ｉ

３ ．

ｌ Ｅ ｉ ｉ Ｆ

Ｉ  

 Ｌ  Ｉ

ｈｌ

ｉ

Ｉ  

 Ｉ

Ｘ Ｊ ４

４．

于 成商 品 倍息块 ．



丨

Ｉ  

  Ｉ

Ｔ５

将 商 品 信 总 块 发 送Ｉ到 上 游 节 点

．

Ｉ  
＾

  ＾  

： ！

￣ ￣  



６

Ｉ

．

校验 商 品佶息块

Ｉ

Ｉ

 ＾ ｒｒ

１   －

Ｉ

 返 回 结 犮 ｚ
＜＿

７ ． 

｜   

１

Ｉ  

  骑 通 过 将 齡 信 息 ８ ？

［

Ｆ ｉ ｉ ．

］

Ｉ

ｌ ｈ 存 储 肋 品 ０ 息 块  

！

 块存储到本地数据丨

 丨

ｕ  

１

—


Ｉ

 Ｈ 点 是 该 节 ２ １

．

［

不

Ｉ

＿＿ ．

Ｌ Ｕ

Ｉ

＿

＿

ｋ Ｊ遞

 「  ＬＪ


商 品 生 成 音 ］ 向ｒＬ＾Ｊ

ｉ





Ｉ

Ｉ

Ｉ  

Ｉ



Ｉ

Ｉ

Ｉ

图

５ ９ － １

发 货 信 息 处 理 时 序 图

４ 处 理 收 货 信 息   ）

￣

￣

￣

￣  

 尚 品 信 Ｓ 笪 玴 Ｈｉ 诀

区 块链 辅 助投块

 业 务 数据 Ｗ Ｘ 化 设 块

Ａ块链辅助 设块
１

（

     （ 木 节 点 ）

｜

节 点 小 （

）

游 节 点 （

卜

）  

｜

｜

｜

＿

提 １ ．
 ｜   ！

言息

＞  ！
ＭＪ

  录 入 收 仿 信 息

｜



３ ．

发送注彫谓求 偯 总



  

  Ｔ  

Ｉ

Ｉ

 验 注 册 码  Ｙ ４ ．

Ｅ ｉ ｉ

￣ Ｉ  

Ｉ


Ｉ

 Ｉ ［Ｔ  

验 过 询 Ｙ ５ ．

【

他通 ：

査
］

商

＿

 ｒ 品 历

■

ｒ

ｉ  

＾

＾ § ０ § ６ ．

３

＿

＿＿



  

『  １

Ｔ

１

［

  Ｉ

８ ． ［ 校 验 通 过 ］ 存 储 商 品 迈 ｆｅ ｄ

Ｉ







Ｉ  

Ｉ

０ ９ ．

 （ ｊ ＾ Ｉ



４

｜ｉ

： Ｉ

Ｉ  



！

！

！


１



１

１  

Ｕ

ｎ

ｊｇ

＾ ｊ Ｓ ｉ

ｉ

ｆ

ｙ  Ｉ

Ｉ  

＿

＿

＿

＿

＿

ｒ    １

１

１  

   １

１  

１

１

图 ５ － ２ ０ 收 信 息 处 理 时 序 图
５ １

北京邮 电大学工学硕士学位论文



  

处 理 收 货 信 息 时 ， 节 点 首 先 需 要 与 该 商 品 的 发 货 节 点 建 立 通 信 。 收 货 节 点 录  

入收货信息 的 同时也将注册到该商 品 链 中 。

所 如 图 ５ － ２ ０

示

，

收 货 节 点 通 过 验 证  

码 与 发 货 节 点 建 立 联 系 ， 并 将 生 成 的 收 货 信 息 块 发 送 到 发 货 节 点 处 。 发 货 节 点 对  

验 证 码 和 信 息 块 进 行 验 证 ， 验 证 无 误 后 将 信 息 块 写 入 本 地 数 据 库 ， 同 时 向 收 货 节   点 返 回 该 商 品 的 全 部 历 史 信 息 块 ， 并 将 收 货 信 息 块 发 送 到 上 游 节 点 处 。 上 游 节 点

收到 信 息块后 也按照校验 、

存储、

向 上发送 的流程进行处理 ，

直 至 信 息 块 被 同 步  

到 生 产 节 点 处 。 收 货 节 点 收 到 历 史 信 息 块 后 将 对 信 息 块 进 行 校 验 ， 校 验 通 过 后 将

其 存 储 到 本 地 数 据 库 中 。  

在 以 上 四 类 信 息 的 处 理 过 程 中 ， 数 据 录 入 模 块 需 要 完 成 本 地 录 入 的 信 息 块 向

其 他 节 点 的 发 送 ， 还 需 要 完 成 对 接 收 到 的 其 他 节 点 信 息 块 的 校 验 、 存 储 、 转 发 等  

操作。

系 统通过相 应 的

Ｈ ａｎｄｌ ｅｒ

类对不 同类型 的信息进行处理 ，

其 详 情 如 图 ２ ５ －

１  

所 示 。

Ａ Ｂ Ｈ  Ｒ Ｍ Ｈ ｋ ｂ ＾ ｉ ｒ ａ ａ

ｏ ｌ

ｉ

ｋ

ｏｎｄｌ ｆ ｒ

Ａ ｄ ｉ ＊ ＞

＞

＜ｌ

Ｐ ｍｌ Ｍ＊ ｒ

ｄ ｎ ｊ ．

ｒ  

ｊ

二 二二 二 ： ：

二二 二 二 ．

二 二 二 二 二 口  ． ．

：

．

：：







一

－





二＾＾ ：上


！
 ｜

   —  ｙ ？ ｉ ＞ Ａｉ

（

（

＇ ＊
ｖ ｏ ｉ ｄ

Ｈ ｔ ｎ ｐ  －

ａ ｉ ｉ

ｉ

ｔｌ

ｒ ｆ ｋ ｔ

－

ｔ

：

．

Ｕ  Ｋ ＾ ｐ Ｗ Ｍ ｍ Ｕ ｎ ｂ ． ．

＜

？＜

ｖ

＇

ｄ

ｖ

－ ｒ

ｄ ｖ ｊ － ．  

－ｈ

ｖ ｐ ａ ｒ ｂ ｏ Ｊ ａ ｍ Ｍ  ｂ Ｋ （ ； ；

：

ｉ！

ｒ／

ｋ ＾  ｉ ．

ｓ ｌｉ

ｈ －

  ，

ｕ  ｉ ｔ  ｎ ｎｔ ｃ

？ ｆ

ｉ

ｉ 

Ｓ

￣ ＇

了  ＾ …

一

■

－

、 ．、
？

一

ｖＣ ｊ

Ｓ ｉ Ｊ

？

ｓ． ｉ 

：

－ 一  



－



：

ｖ

     ．

／

ｉ

＼

、 、

？
 

   

Ｗ Ｉ

Ｂ ｄ ｏ

＇

．



ｎ Ｈ ｍ Ｈ Ｉ ｒ ． ｉ

ｉ ．

．

ｈ－ ．

   ／

１

｜

＼  

Ｕ ｎ ｏ ＜

ｒ ｙＴ ＾    Ｗ ｘ ａ ｍ ｒ

ｎ － ＜

？ ？ ｉ

ｎｕ ？ｎ ？

－

：ｎ

： ｔｉ

！

Ｌ ？  ＾    ＼  ｕ ＜

Ｐ Ｓ

＞

，

！
Ｚ   ＼   Ｂ  Ｈ ＼ ： ：：

１ ： ： ： ： ： ：

：

：： ： ：

１：

： ：： ： ：： ： ：

： ： ： ： ： ： ： ：

：；：

：：

； ：

：
／ ／ ／

、 ？

＇

、

ｈ ＇

＊

，

ｋ

．

ｖ

＊

？ ｉ

、 、 、

  ＿

？  

． 、 ，

Ｓ

Ｋ ｃ  

、 、

＇

、

、 、 、

＞ ； ＊

ｙ ＜ Ｋ ｔ

．

＞＇ ｔ

：

｜

ｃ ｖ  

  ＼   Ｔ Ｎ

！

ｓ ｈ － ．

 （

？ｎ

Ｋ  ＇ ？ｓ

Ａ

： ＞＜

，

／





Ｂ ｒ  ｈ ＇

．

ｉ；

＜ ＞ｊ

． ｉ

？

？＞

ｒ ： ｌ

ｓ ，

．

 ．  

．

．



；

＼  ５ ４   Ｋ ＼ Ｈ ｏ ｎ   －

＊

？ ＞

ｖ （  ｉ ；：

ｖ？

ｓ ｉ

 ｆ ．ｉ

＾

；

ｐ ｓ ＞ ＃

＾ ｃ

ａ ｒ  Ｉ  ｒ

ｉ
．

ｃ

■

’

一 ？ ？ ？

一 ；

．

．

．

 ＼  Ｉ  



   ｒ  ｉ

ｉ

、

ｄ Ｓ 乂 Ｗ  ＼  Ｐ ？

ｗ ；

ｉ；

ｒｎ ？

，

ｃ？ ｆ

ｈ ｔ ．

？

 ｒ ｖ ； ｆ ｔ ！

， ；

Ａ ｋ Ｍ Ｈ ｑ ｕ ｄ ＜

ｉ

ｎ ｒ ＇

＞

＜

ｉｉ ｉ ｉ

ｅ

ｅ ＾ ＞ ｔ

ｆ

！

ｉｉ

ｌ ｅ ｒ

巳 ＾ ± 二 ＾ 土  ＼  ： ．

！

：

１

！

 １

Ｍ ｅ ｍ ｂｅ

ｓ ｒ

，

，
：

ｋ ｅ  



  Ｕ  －

ｎｕ

ｖｏ ｉｄ

＼

＜

５

＂

＇＜
ｐ＇
－ 

１）

？ ．

－ ．

＞ ＞

ｎ Ｖ ｖ  ＞

ｆ ：

＜

ｌ

－ ｉ

ｔ

＼ 

—

  

－

 Ｕ ． ｉ



＼ Ｊ ｕ ａ Ｋ ＾ ＊ ＜

＞ｓ



Ｉ

？

ｓ Ｃ ？＞

ｔ

ｉ

＞

ｉｔ

ｉ

ｃ ｌ

ｉ

ｕ ＾ Ｍ ｒ ｆ ｔ ｉ ｌ

ｉ

ｅ ｉ ｉ

ｒ

ｉ

－

一

Ｃ ５  ｋ ５ Ｍ  ｓ

ｖｉｃ ？

Ｈｓｈ ｋ

＇ ｕ ？ ？ ｔ

？ ？

 Ｌ ！

ｇ ｏ

Ｓ ｔ ｆ
ｊ

Ｓ ｖ Ｉ Ｔ   ａ ｒ ｒ －

ｒ

ｆ ．

ｅ：

ｃ ｅ ｔ

：

ｒ ？ ｎ ｓ ＞？

％

％

；

＇

ｈ ＼   ｖ ：

；＜

＊

．

ｔ

ｅ  

＾ Ｍ  ｎ ｅ ｂ － ；

ｕ ：

ｅｊ

：

Ｋ ｖ 

ｉ＾



＇

＾ｂｃｒ Ｓ ｖ

％ 

ｃｃ

卜

ｉ  Ｈ ｔ ｎ ｉ ｖ＾ ｎ ｗ 

ｋ  ＾ ？

ｕ ｗ Ｓ ｓ ｉ ｉ

ｆ

＾ Ｔ ｉ

ｉ

ｋ ＾ ｖ ｒ

ｅ  

－ 

ｒ ｒ ｉ ；

＞ ｆ

Ｋ＇ ：

Ｓｐｒ ＼

ｃｆ
＞

ｖ Ｓ ｖ  ＼ ＇

Ｊ，

ｒ ：

ｉ？

；

ｒ ＊ ｔ

： ｃ ＾  

Ｕ － ｔ

＊－ ，

Ｋ  ｔ

ｘｕ ＞ －
ｔ

ｉ

ｓ

．

Ｕ ｌ ｎ ｔ ＾ ｕ ｖ ＾

〇  －

ｒ ｉ

；ｉ

 ｖｏ ｉ ｄ

 ＇ 〇 ？ ｄ  

－ ｌ

＾ ＾ ｎ ｄ

ｉ ！

ｖ？ ｆ ｋ ｖ

ｔ

｜

扣

Ｈ Ｋ  Ｒ ｒ ｇ ＾ Ｋ ｑ ｗ Ｂ ｘ ｈ ｗ ＾ ｕ Ｏ ｂ ＾     ＼ 

ｓ

ｏｄ ＊ ．

＾－

－ ｉ

ｕ

ｆ

ｒｖ

ｆ

ａ

 ｏ ｎ ＞

＜

．

？

ｘ



ｒ ｓ

Ｋ Ｋ － ；

＇ ｔ ｆ ．

ａ ｓ ｓｉ  ｉ

ｒ ：

ｎ－

，

ｒ ｖｓ  １

；

《 Ｉ

以 ２ ．

Ｋ ＾ Ｂ ｄ ｔ

ｖ ． ｉ

？ｉ

．

；

ｖ

Ｗ   ｈ ）

ｎ － ．

＾ｔ ｉ

Ｎ ｒ ｕ Ｋ Ｂ ｄ ｖ ｗ ｓ ＇

＞

ｔ

ｒ

，ｉ

． ｃ ｎｖｒ ＾

＊

ｃ ｓ －

ｔ ＜ ｉｉ

ｉ

ｊ ＜

ｘ

ｉ

 Ｗ Ｕ 、 〇 ｄ

Ｕ ＾ ｈ －

 ；

ｃ

ｋ

ｕＫ

＾ ＇

！



ｖ

Ｎ ＜ 

ｅ ｖ，  Ｉ

？

〇：

；

，

１

ｄ Ｍ ｃ ｋ Ｍ 

ａ ！

：

：

 ｒ ｖ －

，

．

：

 ｊ ！

；

：

；

Ｋ   ｔ ＞ ｐ 

 ｖ  ＇

 ｉ

ｔ

ｒ？

；

  Ｗ 〇   ｋ ｉ

！

＼

．

！

ｖ 

，

ｍ
，

？．

？

？ ？

ｖ ＊
！ （ ；

Ｐ．

ｖ － ｖｉ Ｊ

？

〇 ＼ ＼  

Ｖ  －

？＜．

Ｒ Ｂ ｏ ｕ ｕ ｖ ＾

ｕ  Ｕ ＇ ）

＼

ｕ ＜ ｉ

Ｍ ｄ －

ｎ －

－

ｏ ｐ ｆ

ｌ

ｒ ＞ ｐ ｈ ｒ （

？ ？ ？

；ｆ

＇



Ｂ ｄ  Ｎ ｒ ＾ Ｈ Ｒ ＇ ｊｓ

ｖ

ｆ ｖ％ 

ａ ｒ ｉ

，

＞ ｔｒ

＊ ？ｉ？＜

ｒ〇 ｊ ｔ

Ｂ ｏ ？ ；

ｙ ｃ １ ＼ 


５

Ｒ Ｗ Ｈ  Ｎ Ｔ  ｎ ｄ ＾  ？

？

？？ －

ｖ？ ｎ ｓ

ｂ＇

：ｘｈ

？？

ａ ＇？

？

ｉ

；

 ｒ  － ；

（

．

＜

＼   ？

 ：

？

：

？ ，

；

？ ＊

？
 ！

ｕ  ｎ

＇ ＇
？

＊ ； （

｛

；

图

２ ５ －

１

信 息 录 入 处 理 类 图

其 游 节 传 来 录 中 用 于 处 理 下 Ｎ Ｇ Ｈ ｅ ｗ Ｔｒａ ｎ ｓ

Ｒ ｅ ｎ ｅ ｒ ａ ｔ ｅ

ｅｑ ｕｅ ｓｔ

ａｎ ｄ ｌ ｅｒ

点

的 商 品 记 信

货 节 收 节 传 来 收 息 ，

Ｈ 用 于 发 Ｒ Ｒ ｅ ｇ ｉ ｓ ｔ ｅ ｒ

ｅｑ ｕｅｓｔ

ａｎ ｄ ｌ ｅ ｒ

点处理 货 点

的 货 信 息 ， Ａ ｄ ｄ Ｍ  

Ｒ Ｈ ｅ ｍ ｂ ｅ ｒ

ｅｑｕｅｓｔ

ａｎｄｌ ｅｒ

用 于 处 理 供 应 链 下 游 产 生 收 发 货 记 录 时 向 上 传 递 的 消 息 。  

与 它 们对应 的

Ｈ Ｒ ｅ ｓ ｐ

ａｎ ｄ ｌ ｅｒ

则 用 于 处 理 相 应 的 反 馈 信 息 。

密 加 ５ ５ ．

３ ．

工 具  

５ ２

第五章 商品溯源原型 系统详细 设计与 实现



  

加 密 工 具 主 要 用 于 协 助 数 据 录 入 模 块 进 行 数 据 检 验 ， 具 体 包 括 散 列 值 的 生 成   和 校 验 以 及 签 名 的 生 成 和 校 验 等 。 散 列 值 的 生 成 和 校 验 使 用 Ｓ Ｈ Ａ ２ ５ ６ 算 法 ， 签 名   的 生 成 和 校 验 使 用 非 对 称 加 密 算 法 Ｅ Ｃ Ｄ Ｓ Ａ 。  
在 商 品 信 息 块 中 ， 散 列 值 通 过 对 商 品 流 转 数 据 、 引 用 散 列 值 、 生 产 时 间 等 信 息 进 行 哈 希 运 算 获 得 ， 签 名 则 通 过 对 散 列 值 使 用 节 点 私 钥 加 密 获 得 。 图 ５ － ２ ２ 展   示 了 针 对 商 品 信 息 块 的 校 验 过 程 。  

数ｖ据ｍ 录 入 子ｍ 枚 块  加 ？ 丄 具Ｅ 卞 投 块

功 能 数 据 持 久 化 业 务 数 据 持 久 化  

｜

｜

１ ． ＿ 交待检

商

品

信

＆
，

块

！

＞

■

—

块 校 验 息 商 Ｖ Ｒ １

丨 １

签名

ｐ

Ｉ  

 杏 Ｉ

３ ．

闽

总块创、

点 的 １

／

公

ｉ

Ｉ

ｊ

 Ｉ

＜

Ｉ  

ｒｎ５ ．
ｉ

使

ｍ

公

钥

对

签

名

解 卜  


Ｉ


Ｉ Ｉ

 ｜

Ｔ  ￣

６ ．

对 比解密结果与



丨

Ｉ

块 丄 ，

Ｊ
丨 尚品倍息

散列侦



｜

｜

｜  

  Ｍ 丨

丨

Ｉ

Ｉ

Ｉ  

￣

 ｒ ｌ

７ ．

站 ［

果＇ 致 ：

校验商

＋

倍

息块散列

值

ｊ

 Ｐｎ 拼 Ｉ



８．

接 商 信 总 品

内存



Ｉ

Ｉ

ｉ

 Ｔ  Ｉ

Ｉ

ｉ

Ｉ

拼 接 算   ９ 对 ．

结 果做Ｓ Ａ

Ｉ

Ｉ

运 ｔ ；

ｆ

 ｔｐ 

１

１

Ｉ  

 ． 对 比运 算 结 果 与 商 品 ｂ 总 块 散 列 值

Ｉ

丨  

  — 

Ｉ Ｉ

Ｉ

Ｉ

 结 致 验  Ｉ

＼４

  块 ｍ ｜

１

１

．

［

＼

宋一

校 ］

息 ｉ ｆｔ ２  ． 洵 伯

敗 ］ ｆ ｌ ｌ ｌ

列 ｗ

Ｉ

中 扣 用 散 列 对 应 的 佗 ，ｇ」 Ａ 记 ｍ

Ｉ

Ｉ




 ｎ  

Ｉ

  返 结 果  １

１  

ｚ

３ １

．

１

丨

１

！



 ｉ

Ｉ

１

对 比 结 果   ４ １

．

｜

  ｜

嶙

｜

｜

■

 ｒ  ｉ

Ｌ

ｉ

ｉ  

返 结 果 卩  ｉ ，

５ ｉ

．

冋

Ｉ

Ｉ  



ｒ



ｉ

ｉ

ｉ

 ？

ｉ

 ｉ ｜

图 ５ － ２ ２ 商 品 信 息 块 校 验 时 序 图
加 密 工 具 模 块 提 供 的 商 品 信 息 块 校 验 方 法 将 对 商 品 信 息 块 的 签 名 、 散 列 值 和 引 用 散 列 值 分 别 进 行 检 验 。 签 名 的 检 验 通 过 使 用 生 成 该 信 息 块 的 节 点 的 公 钥 对 签 名 进 行 解 密 随 后 将 解 密 结 果 与 信 息 块 散 列 值 进 行 对 比 完 成 。 散 列 值 的 检 验 通 过  
，
将 信 息 块 中 的 信 息 进 行 拼 接 ， 再 次 生 成 散 列 值 并 比 较 两 次 的 散 列 值 完 成 。 引 用 散   列 值 的 检 验 则 需 要 调 用 数 据 持 久 化 层 中 的 业 务 数 据 查 询 方 法 ， 以 引 用 的 散 列 值 为

５ ３

北京邮 电大学工学硕士学位论文



  

关键字在本地数据库 中进行查找 ，

若 能找 到对 应 的 信 息块记录 ，

则 认 为 该 引 用 散  

值 有 效 列

。

通 信 ４ ５ ５ ．

．

工 具  

通 信 工 具 模 块 主 要 负 责 商 品 信 息 块 的 发 送 和 接 收 。 节 点 间 传 递 商 品 流 转 数 据

的 载体 称 为业务信 息 包 ，

业务信息包 由 商 品 信息块封装产生。

接 收 业 务 信 息 包 时

需 要 对 其 进 行 解 析 ， 并 调 用 相 应 方 法 进 行 处 理 。 该 子 模 块 的 实 现 使 用 了 开 源 通 信

框架

ｏ －

ｔ

ｉ

来进行节点 间 的通信 ，

使 用 了 开 源 队 列 框 架 Ｄ ｉ ｓ ｍｐｔ ｏ ｒ 辅 助 进 行 接 收 数  

据 包 的 处 理 。  

在 系 统 运 行 时 ， 每 个 节 点 同 时 担 任 服 务 器 和 客 户 端 的 角 色 ， 既 向 其 他 节 点 发

送业务信 息 包 ，

也接收并处理其他节点 发来 的业务信 息包 。

业 务 信 息 包 类 Ｂ ｌ ｏ ｃ ｋ  

情 框 类 的 详 Ｐ ａｃ ｋ ｅ ｔ

如 图 所 示 继 承 ５ － ２ ３ ，

自 ｏ － ｔｉ

架中 的基础通信包

发 送 业   Ｐ ａ ｃ ｋ ｅ ｔ 。

务 信 息 包 时 ， 需 要 指 定 接 收 节 点 的 Ｉ Ｐ 地 址 。  

Ｂ ａ ｓ ｅ Ｂ ｏ ｄ ｙ

ｍ －

ｅｓ

ｓａ

ｇｅ

ｌ

ｃｌ

Ｓ  ：

ｒ ｔ ｉ

ｎ

ｇ

Ｎ － ｎ ｏ ｄ ｅ

ａ ｍ ｅ Ｓ  ： ｔ ｒ ｉ ｎ ｇ

Ｔ Ｔ ｍ ｍ  － ｃ ｒ ｅ ａ ｔ

ｍ ｉ

ｅ  ：

ｉ

ｅ Ｓ ｔａ

ｐ

  

 － ｐ Ｓ ｎ ｇ ｉ


：

ｒ ｔ

ｉ

 Ｂ Ｐ ｏ ｃ ｋ ｌ

ａ ｃ ｋ ｅ ｔ  

＾

  Ｈ Ａ Ｄ Ｇ Ｈ Ｔ Ｏ ５
＾

－

Ｅ

Ｅ ＲＬ Ｅ Ｎ

ｍ ｄ  ： ｉ

＝５Ｉ ｒ ｅａ

ｎ ｖ ｌ

｝  

 Ｃ Ｈ Ａ Ｔ  ｏ ＼

－

ＲＳＥ

Ｓ  ：

ｉ ｒ ｉ ｎ ｇ＝

ｆ ｒｅ ａ ｄ

ｎ ｙ ｌ

｝

 Ｖ Ｕ Ｄ ｅ ａ ｓ －

ｒｉ

ｌ

ｎ ｏ ｅ ｓ ｉ

ｉ

Ｉ

 ：

ｌ

ｏｎ

ｇ

＼

 ＼

ｙ － ｙ ｂ ｔ

ｐｅ ：

ｔ ｅ

—

＾  Ｐ ａ＾ ｋ

Ｂ ＾ ＾ ｄ ｉ ｌ

ｅ

  

  Ｂ Ｄ ｅ － ｔ ＼ 

ｂｖｔｅ

ｏ ｎ ｕ ｃ ｏ ｃ ＇ ＊

ｓｔ ｒ

－

ｔ

ｒ ＞＞

ｏ ｌ

ｃ ｋ Ｐ ａ ｃ ｋ ｅ ｔ Ｃ ）  

二

－

－

－

？

     

￣

ａ Ｂ ａ ？ ｃ ｏ ｎ ｓ ｔ ｒ ｕ

ｏ ？－ ｒ

ｌ ｏｃ ｋ Ｐａ ｃ ｋｅｔ

＾

ｙ

ｐ

ｅ

：ｂｙｔ ｅ，ｂ ｏｄｙ

ｂ
：

ｙ ｘｅ

［

］ ）  

；

Ｕ Ｕ Ｂ  Ｂ ｅ ｓ ＾ ？

ｖ ｐｅ

ｙ ｐｅ

：ｂｙ ｔ ｅ

）

Ｐ  ：

ａ

ｃ

ｋｅｔ

ｄ ｕ ｉ ｉ

ｅｒ

ｏ ＾ ｃ

ｎ ｏ ｓ ｔ ｒ ｕ ｃ ｔ

－
＾
ｉ

Ｐ ｏ ｃ ｋ
ｌ

ａ ｃ ｋ ｅ ｔ （ ｔ ｙ ｐ ｅ ：  ｂ ｙ ｔ ｅ ，  ｂ ｏ ｄ ｙ ：  Ｓ ｔ ｒ ｉ ｎ ｇ ）  

Ｂ Ｂ Ｂ Ｐ Ｂ － ｓｅｔ

ｏｃｆ ｙｌ

ｂ ｏｄ ｙ ：

ａｓｅ

ｏ ｄ ｙ ）  ：

ａｃｋ ｅｔ

 ｄ ｕ ｉ ｌ

ｅｒ

－ ｌ ｏ ＾ ｓｎｌ

） Ｓ  ： ｕ ｉ ｎ ａ

Ｂ Ｐ  ｂ ｕ ｄ ＊

ｉｌ

（

ｊ

 ：
）

ｌ ｏ ｃ ｋ ａ ｃ ｋ ｅｔ

—

 Ｔ 〇 ＾ ｇ ｅ ｉ

＞ｐ ｅ

：  ｂ ｙ ｔ ｅ  

＾ ｓｅ ｔｌ

ｙ

ｐ

ｅ

（

ｔ ｝

ｐｅ

ｙ ｂ  ：

ｔ

ｅ

）

；ｖ ｏ

ｉ

ｄ

ｇ Ｂ ｏ ｄ ｂ ｅ ＾ ｅｔ

＞  （ 

｝：

ｖｉ

＾

［

 ］  



Ｂ ｓ ｅ －
＾ ｉ

＊

ｏｄｙ！

ｂｏ

ｄ

ｙ

ｂ ｙ  ：

ｔｅ ｌ

］

）

：  ｖ ｏ ｄ ｉ

Ｂ ｏ ｖ ｓ ｇ Ｓ ？

－

ｙ ｙ ＾

ｃ

ｃｒ

ｄ

ｂｏｄ
ｆ

Ｓ ｎ ｇ ： 

ｔｒ ｉ

 ） ：

ｏｉｄ

  

图 ５ － ２ ３ 商 品 业 务 信 息 包 类 图

 Ｎ Ｔ Ｒ ｉ

ｅｗ ｒａ ｎｓＢｏｄｖ

ｅ ｑ ｕ ｅ ｓ ｔ  

Ｂ Ｂ ｄ  ａ ｓ ｅ ｏ ｖ



＾  —

  

：

 ＼

 １ ＾

Ｔ ａ ｎ ｎ ｏ － ｔｒ
，

ｓＩ

ｆ

 ：

ｒ ａ ｎ ｓ ｉ ｎ ｆ ｏ

 Ｃ － ｍ ｅ ｓ ｓ ａ ｇ ｅ ｌ ｄ ：  Ｓ ｔ ｒ ｉ ｎ ｇ

 ＂ 



—











—  

ｊ

￣￣

￣￣

￣

 ７＾ Ｎ －


ｎ

ｏｄｅ

Ｉ

ａ ｍ ｅ Ｓ  ： ｏ ｉ ｎ ＾

７

７



．

ＴＴ

Ｒ Ｔ ｍ － ｃ ｒ ｅ ａ ｆ


ｎ ｅ ｉ

 ：

ｍ ｉ

ｅ Ｓｔａ

ｐ

Ｉ

Ｓ  ｍ Ｍ ｐ － ｉ

 ：

ｇ ｔ ｉ ｉ ｎ

－

ｍ ｅ

ｂ ｅ

ｏ ｅ ｉ Ｉ ｎ ｆ

 ：

ｅ ｍ ｂ ｅ ｒ

ｊ

子 ＾  二二 ： ：二 ：

：：：： 二 ：： ：

ｎ ｏ Ｔ ｎ ａ ｒ － ｔ

ｓｉ

ｆ

 ：

ｉ ａ ｎ ｓ ｌ ｎ ｆ ｏ

￣  
Ｔ

Ｒ Ｒ  Ｒ Ｎ ｅ ｓ ｐ

Ｂ ｅ ｇ ｉ ｓ ｔ ｅ ｒ

ｏ ｄｙ

 ；

ｅｓｐ

Ｔ ｖ ｅ

－

ｒ ａ ｎ ｓ Ｂ ｏ ｃ ｉ ｙ

Ｈ Ｔ Ｔ ｏ － ｔ ｒ ａ ｎ ｓ ｉ ｎ ｆｏ

 ｓ ｓ  ｔ ：

ｌｉ

ｔ

ｒ ａ ｎ ｓ ］ ｎ ｆ ｏ ＞  －ｔ ｒａ ｎ ｓ ｌ ｎ ｆｏ ： 

ｎ ｒ ａ ｓ ｉ ｉ ｌ

ｆ

ｍ  ｐ － ａ ｃ ｃ ｅ

 ｔ ：

ｉ

ｃ ｎ ａ ｃ － ｐ Ｉ

ｅ

 ｔ ；

ｉ

ｔ  

图 ５ － ２ ４ 商 品 业 务 信 息 包 内 容 类 图

５ ４  

第 五章 商 品溯源原型 系统详细设计与 实现



  

业务信 息包 中 的 主要信息 为业务信息包类型 和 内 容 。

类 据 节 型 根 章

５５３

．

．

中  

描述场景 ，

相应的商 品 信息类型被分为六种 ，

其 对 应 情 况 如 表 ２ ５ － 所 示 ，

其 中 类  

型 代 码 大 于 ０ 为 请 求 信 息 ， 小 于 ０ 为 响 应 信 息 。 内 容 则 根 据 类 型 的 不 同 ， 包 括 商

品 信 息 块 、 节 点 信 息 等 ， 图 ５ － ２ ４ 中 列 出 了 一 部 分 信 息 包 内 容 的 具 体 情 况 。

表 ２ ５ － 业 务 信 息 包 类 型





  

类型代码

业务信 息 包类型


  

注册请求包 ，

录 入 收 货 信 息 时 当 前 节 点  

１  Ｒ Ｅ Ｑ Ｉ Ｓ Ｔ Ｅ ＲＲ Ｅ Ｑ Ｕ Ｅ Ｓ Ｔ ￣

向 上游 节 点 发送





  

注 册 响 应 包 收 到 注 册 请 求 包 后 反 馈 给 ，

－ １  Ｒ Ｅ Ｑ Ｉ Ｓ Ｔ Ｅ Ｒ Ｒ Ｅ Ｓ Ｐ Ｏ Ｎ Ｓ Ｅ ￣

下游节点





  

注册处理请求包 ，

收 到 注 册 请 求 后 发 送  

２ Ａ Ｄ ＤＭ Ｅ Ｍ Ｂ Ｅ ＲＲ Ｅ Ｑ Ｕ Ｅ Ｓ Ｔ

￣

￣

给上游 节 点





  

注册处理响应包 ，

收 到 来 自 下 游 节 点 的  

－ ２  Ａ Ｄ ＤＭ Ｅ Ｍ Ｂ Ｅ ＲＲ Ｅ Ｓ Ｐ Ｏ Ｎ Ｓ Ｅ

￣ 

注 册 请求 后 反馈给 下游节点

：



  

Ｎ Ｅ Ｗ Ｔ ＲＡ Ｎ Ｓ Ｇ Ｅ Ｎ Ｅ Ｒ ＡＴ Ｅ ＲＥ 记 录 请 求 包 ， 录 入 记 录 信 息 时 由 当 前 节

＿

＿

＿

３  

Ｑ Ｕ ＥＳＴ

点 向 上游节点发送





  

Ｎ Ｅ Ｗ ＴＲ Ａ Ｎ Ｓ Ｇ ＥＮ Ｅ ＲＡＴＥ Ｒ Ｅ记 录 响 应 包 ，

收 到 下 游 节 点 发 送 的 记 录  

＿

＿

＿

－ ３  

Ｓ ＰＱＮ Ｓ Ｅ

请求包时 反馈 该类 型 数据 包



｜





  

接 收 业 务 信 息 包 时 ， 通 信 工 具 模 块 需 要 将 收 到 的 业 务 信 息 包 按 照 类 型 分 发 到

相 应 的 Ｈａｎｄｌｅｒ 类 进 行 处 理 。

系统中 使用

了Ｄ ？



ｏ ｉ ｓ ｒ ｕ ｐ ｔ

ｒ

框架提供 的生产－消

费 者 机

制 进 行 处 理 与 之 相 关 的 类 包 括 和 。

Ｄ ｉ ｓ ｒｕ ｐ ｔｏ ｒ Ｐ ｒｏ ｄ ｕ ｃ ｅ ｒ 、

Ｄ Ｃ ｉ ｓ ｒ ｕ ｐ ｔ ｏ ｒ Ｓ ｅ ｒｖ ｅ ｒ

ｏｎｓｕｍｅｒ

其 类 如 所 统 将 收 到 的 信 息 包 传 入   Ｄ Ｃ Ｃ ｉ ｓ ｒ ｕ ｐ ｔ ｏ ｒ

ｅ ｎ ｌ ｉ

ｔ

ｏｎｓ ｕｍｅｒ 。

图

图 ５－２５

系 不 。

业务

类 该 类 将 业 务 信 息 包 分 发 到 类 和 Ｄ ｉ ｓ ｒｕ ｐ ｔ ｏ ｒ Ｐ ｒ ｏ ｄ ｕ ｃ ｅ ｒ

，

Ｄ ｉ ｓ ｒｕ ｐ ｔ ｏ ｒ Ｓ ｅ ｒｖｅ ｒＣ ｏ ｎ ｓ ｕ ｍ ｅ ｒ

Ｄ Ｃ Ｃ 类 ｉ ｓ ｒ ｕ ｐ ｔ ｏ ｒ

ｅ ｎ ｌ ｉ

ｔ

ｏ ｎ ｓ ｕｍ ｅ ｒ

。  

Ｄ ｎ ｐ ｉ ｓ

ｉ

ｌ

ｏ ｒＳｍ

ｅ ｒ ｔ  ｏ ｕ ｓ ｕ ｍ ？ ｒ  

 Ｌ ． ｏ ｇ ｇｅ ｊ





 ， 、







＾

 



 Ｂ ｏ Ｐ  ｃ ｋ

＾ ｖ

．

」





Ｄ Ｋ Ｃ  ｉ ｓ ｒ ｕ ｐ ｔ ｏ

ｅ ｎ  ｌ ｉ

ｒ

ｏ ｎ ｓｕ ｍｅｒ

 



ｏ Ｋ ｏ Ｂ ｗ Ｃ ｍ ｔ ？

ｎｓ ｔｒｉ

ｉ

ｒ －



ａ

ｖｅ

 ｉ

ａ Ｂ Ｋ  ｎ － ｃ ｏ ｎ ｓ ｔ

ｉ

ｏ ？－ ｒ

ａ＜

；

ｔ

ｖ

ｎ ＊ ｔ

ｎｈ



ｌ

ｒｃ ｋ

Ｐａｃ

ｋ

ｅｔ

Ｐ＾ ｋ －

ｋ

ｃ 

ｔ ｉ ）  



Ｂ Ｅ Ｂ ｏ ｕ  ｃ －

ｎｓｔｒ

ｃｔ ｏ －

＇＊

ｒ



ａ ＾－

ｖ ｃ ｎｔｉ

ｂ ｌ

ｏｃ

ｋ

Ｐａｃ

ｋｅｔ



ｏ ｉ

ｉ

ｒ ｂ ＾  Ｂ Ｂ ｅ ｃ



 人  Ｊ  ｅ ＾ ｂ ａ ｖ ｎ  － ｔ

ｃ ｔｉ ｖ ｃ

ｓｆ ｆ

ｖ

ｔ：

ｖ ｒ ｉ ； ｓ

ｉ

、 ）

ｒ

－

Ｓ？ ｊ



ｏ Ｐ Ｕ ｌ

ｃｋ

＾

ｃ

ｋ

－ ｔ

 ： ｝

ｘ Ｐ ｋ ．
ｌ

ｋ

ｓｃ

ｅ ｉ  

Ｕ ｋ ｒ Ｕ ｂ ｘ ｋ Ｐ ｆ ｃ ， ＋ ｓｔ
ｔ

ｉ ｉ） ．

ｄｉ

ｋ， ｔ

＜ ｉ

Ｖ ａ ｔ

ｋ， ｔ

ｋｆｔ ）

Ｐ ｋ

ｅ ｃ ＾ ｉ Ｋ

ｉ

 ｖ ｏ ｉ ｄ  

ｄ Ｋ ｍ 

ｉ ａ ｎｏ ｅ

〇
！

ｅ ＼ ．

ｉ

Ｃ ｍ 〇 Ｕ  ｈ ａ ｎ

＊ ｉ

ｊｎ

＂

ｃ！

ｉ

Ｐ ％ １

？ ｉ

ｓ

ｒｆ ｇ

？ ｉ

ｉ

 ｕ ｕ  ｍ ｏ ｄ ｕ ｒ ｅ ｒ

ｌ ｉａ ｎ ｎ ｏ ｉ ＜  ｎ ｎ

ｖ － ｔ

 ｍ ｏ （

ｈｊ ｒ

ｒ － ＊｜

＼ －

ｅ

３

ｃ Ｃ ｎ ｃ －

ｈ

ｔ

＇

ｌ

ｕｉ Ｊ ｉ

Ｃ ｉ

ｏ Ｕ ｕ ｕ Ｃ ｃ  ｅ ｘ ｉ

ｉ

ｔ

ｔｌ

ｎ ｔ ｉ

ｌ

ｏｎ ｔ

ｘｔ

 ａ ＜ ！ ；

ｉ

ｉ

   ＾  ＇

ｒ ＾  ｊ

ｊ

Ｄ ｐ Ｐ ｎ ｓ ｉ

ｉ

ｌ ｏｒ

ｒ ａ ｄ ｕ ＊  ｅ ｒ  

ｄ ａ ｏ ｒ Ｄ ｏ  －
ｉ

ｓ
ｉ

ｐ ｉ

ｔ



ｐ ｓ ｉ

ｒｉ ｔ

ｌ

ｒ

ｉ

＜ ．

ｏ ｍｒｕｆ ｉ

〇－ ｒ ．
ｌ

ｎ

－－ ｉ

ｒｕ ｐ

ｊ

＇

ｉ

？ｔ

，

ｔ

！

ｘ ｔ

１ｕｒ

ｒ ｉ ｕ 〇 ｒ ｉ

ｕ ＞

ｐ ：

ｒ

｛

Ｄ ＾ ｏ 

ｕ ｐ ｔ

ｔ

ｉ ）

ｂ  － ｐ ｕ

ｕ ｂ ｖ ｎ ｓ ！ ：

ｌ

ａ ｓ ＜？ ｔ

ｃ

ｉ

ｓ 〇 ｄ ｉ

图 ５ － ２ ５ 商 品 业 务 信 息 包 分 发 类 图

北京 邮 电大 学工学硕士学位论文



  

类 负 责 处 理 请 求 类 型 包 Ｄ Ｃ ｉ ｓｒｕｐｔｏ ｒ Ｓ ｅ ｒｖｅ ｒ ｏｎ ｓｕｍ ｅ ｒ

，

Ｄ Ｃ Ｃ ｉ ｓ ｒｕ ｐｔｏ ｒ

ｎ ｅ ｌ ｉ

ｔ

ｏ ｎ ｓ ｕ ｍ ｅ ｒ

负 责 处 理 响 应 类 型 包 。 它 们 分 别 对 业 务 信 息 包 类 型 和 处 理 信 息 包 使 用 的 Ｈ ａｎｄｌ ｅｒ

类 进 行 了 映 射 。 业 务 信 息 包 最 终 将 传 入 对 应 的 Ｈ ａｎｄ ｌ ｅ ｒ 类 中 进 行 处 理 。  

５ ． ６ 数 据 库 设 计  

５ ６ ．

．１

用 户 信 息 表

该 表 用 于 存 储 用 户 的 账 号 信 息 。

表





５－３

用 户 信息表
  

字段


±１１





  

ｄ

ＢＩＧＩＮＴ

是

ｊ





用 户 的唯一标识
  

ｕｓ ｅ ｒ ｎ ａｍ ｅ  ＶＡ Ｒ Ｃ ＨＡ Ｒ（ ２ ５ ５ ）

否



用户 账号 ，

不可重复

  

ｐａｓ ｓ ｗ ｏ ｒ ｄ  ＶＡ ＲＣ ＨＡ Ｒ （ ２ ５ ５ ）

否



加密后的用户 密码
  

 ｐ ｈ ｏ ｎ ｅ ｎｕ ｍ  ＶＡ Ｒ Ｃ ＨＡ Ｒ（ ２ ５ ５ ）

否 用 户 手 机 号 码  

 否  Ｎ ｌ ｅ ｖ ｅ ｌ

ＩＴ

用 户 在 系 统 中 的 权 限 ， 普 通 用 户 、 商 品   管理员 或系统管理员



  

ｕ ｐ ｄａｔｅｔ ｉ ｍ ｅ ＴＩ Ｍ Ｅ Ｓ ＴＡ Ｍ Ｐ 否  最 新 一 次 更 新 记 录 的 时 间  

 ｃ ｒｅ ａｔ ｅｔ ｉ ｍ ｅ ＴＩ ＭＥ Ｓ ＴＡ ＭＰ 否  用 户 创 建 时 间  

ｉ ｎ ｆｏ

  ＶＡＲ Ｃ ＨＡ Ｒ ２ ５ ５



（

）

否

用户 备注信息

丨



  

６ ２ ５ ．

．

节 点 信 息 表

用 于存储系统 中其他节点 的公钥 、

地 址 等 信 息 Ｉ Ｐ

。  

表 ４ ５ － 节 点 信 息 表  

字段

ｍ ．







  

Ｊｄ

Ｂ Ｉ Ｇ ＩＮ Ｔ

是





节点 的唯一标识
  

ｎｏｄ ｅｎａｍ ｅ

ＶＡ ＲＣ ＨＡ Ｒ １ ０ ０

否

（

）





节点名 称 ， 不可重复
  

ｐｕｂ ｌ ｉ ｃｋ ｅｙ

ＶＡＲ Ｃ ＨＡ Ｒ （

１

００ ）

否





节 点 的 公 钥 ， 不 可 重 复  

ｐ ｉ

ＶＡ Ｒ Ｃ Ｈ Ａ Ｒ Ｉ Ｑ Ｏ

（

）

否

节

点

的 地 Ｐ  Ｉ



址

＿





  

ｉ ｎ ｆｏ

ＶＡ Ｒ Ｃ ＨＡ Ｒ Ｉ Ｏ Ｏ

（

）

否节 点 信 息 备注





  

ｕｐ ｄ ａｔｅｔｉ ｍ ｅ

ＴＩ ＭＥ Ｓ ＴＡ ＭＰ

否最近 更 新 时 间





  

   ｃ ｒ ｅ ａ ｔ ｅ ｔ ｉ ｍ ｅ

ＴＩ Ｍ Ｅ Ｓ ＴＡ ＭＰ

否

记 录 创 建 时 间  

６ ５ ．

３ ．

商 品 属 性 信 息 表

用 于 存 储 商 品 属 性 信 息 详 情 。  

５ ６  

第 五章 商 品溯源原型系统详细设计与 实现



  

表 ５－５ 商 品 属 性 信 息 表





  

字段

ｍ







  

ｊｄ

Ｂ Ｉ Ｇ ＩＮＴ

是商 品 属 性 的 唯 一标识





  

ｎａｍ ｅ

ＶＡ Ｒ Ｃ ＨＡ Ｒ （

Ｉ

ＯＯ ）

否商 品 属性 名 称





  

ｉｎｐ ｕｔ

 ｔｙｐ ｅ

否该 商 品 属 性值 的录入方式 ，

选  

＿ —

 ＩＮ Ｔ  

择 型／输入型



  

ｉ ｎ ｐ ｕｔ

ｌ ｉ ｓｔ

一

ＶＡＲＣ ＨＡ Ｒ （

１

００ ）

否





可 选 值 列 表 ， 用 “ ” 隔 开   ；

ｕｐｄ ａｔｅｔｉ ｍ ｅ ＴＩ ＭＥ Ｓ ＴＡ ＭＰ 否  最 近 更 新 时 间  

  否  ｃ ｒｅ ａｔｅ ｔ ｉ ｍ ｅ

ＴＩ ＭＥ Ｓ ＴＡ ＭＰ

记 录 创 建 时 间  

４ ５ ６ ．

．

商 品 类 型 信 息 表

用 于 存 储 商 品 类 型 信 息 。  

表 ５－６ 商 品 类 型 信 息 表





  

字段

ｍ ．

＾

ｍ ．







  

ｊｄ

Ｂ Ｉ Ｇ ＩＮ Ｔ

是





商 品类型 的唯一标识
  

ｎ ａｍ ｅ

ＶＡ Ｒ Ｃ ＨＡ Ｒ Ｉ Ｏ Ｏ

（

）

否 商 品 类 型 名 称 ， 不 可 重 复  





  否 ｕ ｐｄ ａｔ ｅ ｔ ｍ ｉ ｅ  Ｔ Ｉ Ｍ Ｅ Ｓ ＴＡ ＭＰ

最 近 更 新 时 间  

ｃ ｒｅ ａｔ ｅｔｉ ｍ ｅ ＴＩ ＭＥ Ｓ ＴＡ Ｍ Ｐ 否  记 录 创 建 时 间  

６ ５ ，

５ ．

商 品 类 型 － 属 性 联 系 表

用 于 在 商 品 类 型 与 商 品 属 性 之 间 建 立 多 对 多 的 联 系 。  

表 ５－７ 商 品 类 型 属 性联 系 表



＝

  

字段

ｍ ．

＾

ｍ







  

ｊｄ

Ｂ Ｉ Ｇ ＩＮ Ｔ

是





该关联的 唯一标识
  

ｊ ａ ｔｔ ｒｉ ｂ ｕ ｔ ｅ

ｄ

Ｂ Ｉ Ｇ Ｎ Ｉ Ｔ

否





商 品 属 性Ｉ Ｄ
  

ｔ ｙ ｐ ｅ ｄ ｉ ＿

Ｂ Ｉ Ｇ ＩＮ Ｔ

否





商 品 类 型Ｉ Ｄ
  

   ｃ ｒｅ ａｔ ｅ ｔ ｉ ｍ ｅ

ＴＩ ＭＥＳ ＴＡ ＭＰ

否

创 建 时 间  

６ ６ ５ ．

．

商 品 散 列 值 状 态 表  

表 ５－８ 商 品散 列 值状 态 表





  

麟辦称


  

ｉｄ

ＭｏｎｇｏＤＢ 中 主 键 的 默 认 域 名 ， 对 应 的 值 为 商 品 的 Ｉ Ｄ

—



  

ｈａｓ ｈ

该商 品 的最新信 息块 的散列 值



  

块  生 ｃ ｒ ｅ ａｔ ｅ ｔ ｉ ｍ ｅ

成该信息 的时 间

  

５ ７

北京邮 电大学工学硕士学位论文



  

该 数 据 表 存 储 在 Ｍ ｏｎｇｏ ＤＢ 中 ， 随 着 商 品 信 息 块 记 录 表 的 更 新 而 更 新 ， 用 于   保 存 每 件 商 品 对 应 的 最 新 商 品 信 息 块 的 散 列 值 。  

６ ５ ．

７ ．

商 品 信 息 块 记 录 表

该 数据 表存 储 在 ＭｏｎｇｏＤＢ 中 ，

用 于存储商 品信息块记录 ，

其 中 包 括 具 体 的

商 品 流 转 信 息 和 构 成 区 块 链 结 构 的 散 列 值 等 。  

表 ９ ５ － 商 品 信 息 块 记 录 表





  

麵域名 称

ｍ



  

ｄ ｉ

Ｍ ｏｎｇｏＤＢ 中 主 键 的 默 认 域 名 ， 对 应 的 值 为 每 条 商 品 流 转 信 息 的 散 列 值  

＿



ｐｉ ｄ

商 品 Ｄ Ｉ

，

即 该信息对应商 品 的唯一标识



  

ｎｕｍ

信 息 块 编 号 ， 表 示 该 信 息 块 在 节 点 生 成 的 全 部 信 息 块 中 的 编 号  



ｐｎ ｕｍ

信 息块编号 ，

表示该信息块在该商 品信息链中 的排序



  

ｃ ｒ ｅ ａｔ ｅ ｔ ｉ ｍ ｅ

生 成该条流转信 息 的 时 间



  

ｐ ｒｅ ｈ ａｓｈ

本节点最新生成 的一条商 品 流转信 息 的散列值



  

ｐ ｒｅ ｐ ｒｏ ｈ ａｓｈ

该信 息块所记录商 品 的上一信息块的散列值



  

ｉ ｎ ｆｏ

具 体的 商 品流转信 息



  

ｓ ｉ ｇｎ

由 生成该 信 息块 的节点对信 息块进行 的签名 用 于校验信息 ，



  

 ｃ ｒｅ ａｔｏｒ 生 成 该 信 息 块 的 节 点 名 称
  

６ ５ ．

８
．

本 地节 点 信 息 表  

用 于 存 储 本 地 节 点 密 钥 等 信 息 ， 辅 助 生 成 商 品 信 息 块 和 进 行 节 点 间 的 通 信 。  

表

０ ５ － １

本地 节 点 信 息 表





  

麵域名称

ｍ



  

ｄ ｉ

ＭｏｎｇｏＤＢ 中 主 键 的 默认 域 名 ， 对 应 当 前 节 点 的 名 称

＿



  

ｐｕｂ ｌ ｉ ｃｋｅｙ

本节点 的公钥



  

ｐ ｒｉ ｖ ａｔｅ ｋｅｙ

本节点 的私钥



  

ｌ ａｓｔ ｈ  ａｓｈ 本 节 点 最 新 生 成 的 一 条 商 品 信 息 块 的 散 列 值 ＿   

ｕ ｐ ｄ ａｔ ｅ ｔ ｉ ｍ ｅ

本节点最新生成一条商 品信 息块的 时 间



  

５ ． ７ 本 章 小 结  

本 章 主 要 按 照 功 能 模 块 顺 序 介 绍 了 商 品 溯 源 原 型 系 统 的 详 细 设 计 和 编 码 实  

现 ，

结合执行流程和编码结构对原型系统主要功能 的 设计思路 、

执 行 原 理 和 实 现  

过 程 进 行 了 详 细 阐 述 。

５ ８

第六章 商 品溯源原型系统的测试



  

第 六 章 商 品 溯 源 原 型 系 统 的 测 试  

本章介绍 原 型系 统 的开发 、

运行环境 ，

并对系 统 的各功 能模块进行测 试 ，

验  

证 系 统 的 可 用 性 。  

６ ． １ 软 硬 件 环 境

系 统 的 正 常 部 署 和 运 行 需 要 网 络 连 接 支 持 ， 其 具 体 软 硬 件 配 置 如 表 ６－ １ 所 示 。  

表 ６－ １

系 统所 需软硬件环境信息 表



  

开 发 语 言  Ｊ ａｖ ａＳ ｃ ｒ ｉ ｐｔ  
— — —   

框  开 发 架

Ｖｕ ｅ ３ ． ０



  

开 发 语 言Ｊａｖａ８
  

后 分 开 发 框 架    Ｄ 



Ｓ ｐ ｒ ｉ ｎ ｇ  Ｂ ｏｏ ｔ ，

Ｊｐａ ，

ｄｒｕ ｉ ｄ ，

ｏ －

ｔｉ

，

 ｉ ｓ ｒ ｕ ｐ ｔ ｏ ｒ ，

ｊ

ａ

ｖ

ａ－
ｊ

ｗ ｔ

＂ ＂  

＃ ＾  月 艮

暑１ 车 牛

Ｔｏｍ ｃ ａｔ ８

  

数 据 库 软 件ＭｙＳＱＬ ，ＭｏｎｇｏＤＢ



  

Ｃ ＰＵ ２ ． ４ Ｇ ｈｚ
  

硬件环境 内 存 ４ＧＢ
  

运 行 系 统 Ｗ ｗ ｉ ｎ ｄ ｏ

ｓ１

０

  

６ ． ２ 测 试 用 例 设 计  

本 节 将 针 对 系 统 中 一 些 关 键 性 的 功 能 点 给 出 测 试 用 例 及 测 试 结 果 。  

６ ２ ．

．１

用 户 管 理功 能

用 户 管 理 功 能 模 块 包 括 用 户 的 注 册 、 登 录 、 用 户 个 人 信 息 修 改 、 用 户 权 限 修  

改 等 功 能 。 针 对 其 进 行 测 试 的 测 试 用 例 表 如 表 ６－２ 所 示 。  

表 ６－２ 用 户 管 理 功 能 測 试 用 例 表





  

用例名称用 户 管 理功 能测 试 用 例

￣￣

   ￣ ￣  

  ￣ 用 ｆ描述

测试用 管理模块 中 的各项功能

｜

ｆ ＿

  ｍｉ

输入动作

预期 结果 输 出 结果 测试结果

登 录 成 功 跳 转 到

登 录 成 功 跳 转 到 系 统

用 户 输 入 账 号 和 系 统 主 界 面 或 登  

 １

主 界面 ，

登 录 失 败 显 示 通 过  

密 码 ， 点 击 登 录 录 失 败 显 示 登 录  

登 录 失 败 提 示  

失 败提示
Ｉ





  

５ ９  

北京邮 电大学工学硕士学位论文



  

（ 续上表 ）









  

编 号 输入领作 预期结果

输出 结果

测试结果  





注 册 通 过 时 提 示 “ 注 册

用 户 输 入 注 册 信 ２ 提 示 注 册 结 果 成 功 Ｖ 注 册 失 败 时 提 示 通 过  

息 并 点 击 提 交

“注 册 失 败”



  

修 改 成 功 时 刷 新 用 户  

修 改 用 户 信 息 并 提 示 修 改 成 功 或  

３ 个 人 信 息 页 面 ， 修 改 失 通 过  

点 击 提 交 失 败  

败时 提示 修改 失败



  

修 改 成 功 ， 用 户 信 息 页

管 理 员 点 击 用 户  面 显 示 修 改 后 的 信 息 。   ＿
４ 提 修 改 结 果 通 过  
信 息 进 行 修 改 修 改 失 败 显 示 修 改 失

败 原 因 提示



  

新 增 用 户 信 息 合 法 时  

显 示 “ 添 加 成 功 信 息  
５ 新 增 用 户 信 息提 示 新 増 结 果  通 过   ＿＿ 不 合 规 时 显 示 “ 添 加 失  



＾   

删 除 用 户 信 息 成 功 时  

显 示 “ 删 除 成 功 删 除  
６ 删 除 用 户 信 息 显 示 删 除 结 果 通 过   失 败 时 显 示 “ 删 除 失



  

用 户 点 击 注 销 登 ７ 返 回 登 录 页 面 返 回 登 录 页 面 通 过  









  

６ ． ２ ． ２ 节 点 管 理 功 能 针 对 节 点 管 理 功 能 模 块 ， 主 要 测 试 对 节 点 信 息 的 新 增 、 查 询 、 修 改 和 删 除 功
能 。 测 试 用 例 设 计 如 表 ６ － ３ 所 示 。  

 表 ６ ３ － 节 点 管 理 功 能 测 试 用 例 表



  

用例名称节 点 管 理功能测 试 用 例
  

用例描述测 试节 点 管理模块 中 的 各项功 能

  

￥  前 件

用 户 己 经 登 录 系 统 且 具 备 系 管 理 员 权 限  

｜

＾

编 号 输入甸？作

预期 结果

输出 结果



测 试 结 果

页 面 显 示 节 点 信  

 １ 查 询 节 点 信 息 页 面 显 示 节 点 信 息 列 表 通 过

息列表

｜









  

６ ０  

第六章 商品溯源原型 系统 的测试



  

（ 续上表








￥

  

编号

输Ａ＾ 作 预期结果 ｌ

输出 结果



测试结 果  

输 入 信 息 合 规 时 提 示  

点 击 新 增 节 点 按

钮 并 输 入 节 点 名

新 增 成 功 “

’’ ，

节 点 信 息 列  

２ 提 示 新 增 结 果 表 显 示 新 增 的 信 息 。 输 通 过  

称、

地 址 Ｉ Ｐ

、

公 钥  

入 信 息 不 合 规 时 提 示  

和 备 注 信 息

“新增 失 败”



  

输 入 信 息 合 规 时 提 示  

“ 修 改 成 功 Ｖ 节 点 信 息 列  

３ 修 改 节 点 信 息 提 示 修 改 结 果 表 显 示 修 改 后 的 信 息  。 通 过  

输 入 信 息 不 合 规 时 提 示  

“修 改 失败”



  

删 除 成 功 时 显 示 “ 删 除  

４ 删 除 节 点 信 息 提 示 删 除 结 果 成 功 Ｖ 删 除 失 畋 时 显 示 通 过  

“


删

除

失

败

”

｜









  

２ ６ ．

３ ．

商 品 信息 管 理 功 能  

针 对 商 品 信 息 管 理 功 能 的 测 试 分 为 对 商 品 信 息 查 询 功 能 的 测 试 和 对 商 品 信  

息 录 入 功 能 的 测 试 。  

针 对 商 品 信 息 查 询 功 能 的 用 例 如 表 ６－ ４ 所 示 。  

表 ６－４ 商 品 信 息 查 询 功 能 測 试 用 例 表





  

用例名称商 品 信 息 查询 功 能测 试 用 例
  

用 例描述测 试 商 品 信 息 管 理模块 中 的 商 品 信 息 查 询 功 能

  

 前置ｆ件

用 户 已 登 录 系 统  

｜

＾

编号

输作

预期结果

输出 结果

澜 试结 果  





二 维 码 合 规 时 显 示 商 品 流

转 信 息 列 表 ， 该 信 息 列 表 中  

包 括 该 商 品 的 全 部 流 转 信   完 整 显 示 查 询 结   上 传 商 品 二 维 息 （ 包 括 本 地 节 点 生 成 的 信  １ 果 或 给 出 相 关 提 通 过  
码 图 片  息 和 非 本 地 节 点 生 成 的 信 ＿
不  
息 ） ， 二 维 码 不 合 规 时 提 示  

“ 二 维 码 格 式 错 误 请 重 新 ，

提交”



  

６ １

北京邮 电大学工学硕士学位论文



  

（ 续表 ）









  

编 号 输入尚＞作 预期结果

输出 结果

测试结果





输 入 Ｄ Ｉ 合 规 时 显 示 商 品 流  

转信 息 列表 ，

该 信 息 列 表 中  

包 括 该 商 品 的 全 部 流 转 信   完 整 显 示 查 询 结  
息 （ 包 括 本 地 节 点 生 成 的 信   ２ 输 入 商 品 ｒ ｏ果 或 给 出 相 关 提 通 过  
 息 和 非 本 地 节 点 生 成 的 信
＿

按 顺 序 排 息 且 ） ， 时 间

列。

Ｉ

Ｄ 不 合 规 时 提 示 “ 输 入 信 息  





有 误 ”
｜





  

针 对 商 品 信 息 录 入 功 能 的 测 试 用 例 如 表 ６－ ５ 所 示 。  

表 ６－５ 商 品 信 息 录 入功 能 测 试 用 例 表





  

用例名称商 品 信 息 录入 功 能测 试 用 例
  

用 例描述测 试 商 品 信 息 管 理模 块 中 的 商 品 信 息 录入 功 能

  

 前置ｆ件

｜ 用 户 已 － 登 录 系 统 且 具 ， 系 统 管 理 员 或 商 品 管 理 员 权 限

编号

输入／动作

预期结果 输 出 结果 濟试结果

｜
选 择 生 产 信 息 完 整 填 写 信 息 时 显 示 “ 录 入 成  

录 入 功 能 ， 填 返 回 录 入 结 功 ” 和 生 成 的 商 品 二 维 码 ， 信  １ 通 过  
写 商 品 信 息 并 果 提 示 息 填 写 不 完 整 时 显 示 “ 信 息 填  

＾

写 不完整 ， 录入失败”





  

商 品 二 维 码 不 合 规 时 显 示 “ 二  

跳 转 到 商 品 维 码 格 式 错 误 Ｙ 商 品 状 态 不  

提 交 商 品 二 维 信 息 类 型 选 合 规 时 显 示 “ 商 品 状 态 不 合  

２ 通 过  

码 图 片择 界 面 或 给

规 ，

无 法 录 入 Ｙ 二 维 码 和 商 品  

出 失 败 提 示状 态 均 正 确 时 跳 转 到 商 品 信

息类型选择界面



  

完 整 填 写 信 息 时 显 示 “ 录 入 成  

选 择 发 货 信 息 功 信 息 填 写 不 完 整 时 显 示  

录 入 功 能 ， 填 返 回 录 入 结 “ 信 息 填 写 不 完 整 ， 录 入 失 败 Ｖ   ３ 通 过  
写 商 品 信 息 并 果 提 示 商 品 状 态 不 合 规 时 显 示 “ 商  

提 交 品 状 态 不 符 合 要 求 无 法 录   ，



＾   

６ ２  

第六章 商品溯源原型系统的测试



  





（


ｙ上表

）


  

编号

输＿ 作 预期 结果

输出 结果

测 试 结 果





完 整 填 写 信 息 时 显 示 “录 入 成  

功 ’’ ，

上 游 节 点 可 查 询 到 同 步  

选 择 收 货 信 息

信

息 信 ＆ ￣ 。

 息 填 写 不 完

整±  

时

显  

录 入 功 能 填 返 回 录 入 结   ，

４

示“信 息填写不完整 ，

录 入 失 通 过  

写 商 品 信 息 并 果 提 示  

败 商 品 状 态 不 合 规 时 显 示  

提 交  

“ 商 品 状 态 不 符 合 要 求 ， 无 法



  

完 整 填 写 信 息 时 显 示 “ 录 入 成

功 Ｖ 上 游 节 点 可 查 询 到 同 步
选 择 记 录 信 息   信 息 。 信 息 填 写 不 完 整 时 显  
录 入 功 能 ， 填 返 回 录 入 结   ５ 示 “ 信 息 填 写 不 完 整 ， 录 入 失 通 过  
写 商 品 信 息 并 果 提 示   败 Ｖ 商 品 状 态 不 合 规 时 显 示  
提 交 “ 商 品 状 态 不 符 合 要 求 ， 无 法





丨 

录 入’，



  

６ ２ ４ 商 品 属 性 管 理功 能  

．

．

针 对 商 品 属 性 管 理 功 能 的 测 试 从 商 品 属 性 管 理 和 商 品 类 型 管 理 两 方 面 进 行 。  

针 对 商 品 属 性 管 理 功 能 的 测 试 用 例 如 表 ６－ ６ 所 示 。

表 ６－６ 商 品 属 性 管 理 功 能 测 试 用 例 表



  

用例名 称商 品 属 性管 理功 能测 试 用 例
  

用例推述测 试 商 品 属 性管 理 模块 中 的 功 能

  

 前置条件

用 户 经 登 录 系 统 且 具 商 品 管 理 员 或 系 统 管 理 员 权 限

｜

ｐ

，

编号

输Ｍ 作

预期 结果

输 出 结果

测 试 结 果





点 击 增 加 商 品 完 整 填 写 信 息 时 显 示 “ 新  

属 性 ， 并 输 入 增 成 功 Ｖ 当 前 页 面 显 示 新  

１ 属 性 名 称 、 属 显 示 新 增 结 果 增 的 属 性 信 息 。 信 息 填 写 通 过  

性 输 入 类 型 等 不 完 整 时 显 示 “ 信 息 填 写

ｍ，

不完整 ，

新增 失败”





  

点 击 某 商 品 类 显 示 该 商 品 类 型  

２，  型 信 息 中 的 包 含 的 全 部 属 性 显 示 该 商 品 类 型 包 含 的 全 通 过  

部 属 性 的 详 细 信 息 列 表

  “ 详 情 ” 按 钮

的详细信 息

｜

｜





  

６ ３

北京 邮 电大学工学硕士学位论文



  

（







续 表） ＋

  

编 号 输入旬？作 预期 结 果

输出 结果

测 试结 果





填 写 的 信 息 完 整 且 合 规 时

点 击 修 改 商 品 ＿   显 示 “ 修 改 成 功 Ｖ 当 前 页 面

属 性 并 输 入   ，
３＾  修 改 后 的 属 性 显 示 修 改 结 果 显 示 修 改 后 的 属 性 信 息 。   通 过  

信 息 填 写 不 合 规 时 显 示  

输 入 类 型 、 属  

“ 信 息 填 写 不 完 整 修 改 失 ，

性 取 值 等 信 息  



＾   

删 除 的 属 性 不 被 任 何 类 型  

点 击 某 商 品 属 使 用 时 显 示 “ 删 除 成 功 Ｖ 当  

４ 性 信 息 的 删 除 显 示 删 除 结 果前 页 面 中 不 再 显 示 被 删 除 通 过  

按 钮 的 商 品 属 性 信 息 。 否 则 显  





｜ 

示“删 除 失 败”



  

针 对 商 品 类 型 管 理 功 能 的 测 试 用 例 如 表 ６－ ７ 所 示 。

表 ６－７ 商 品 类 型 管 理功 能 测 试 用 例 表





  

用例名称商 品 类型 管理功 能测 试用 例
  

用 例描述测 试 商 品 属 性 管 理模 块 中 的 商 品 类 型 管 理功 能
  

前置＃件

用 户 己 经 登 录 系 统 且 具 备 品 管 理 员 或 系 统 管 理 员 权 限

｜

ｆ

编号

输入劢 作 预期 结果

输 出 结果

测 试结 果  





点 击 增 加 商 品 类 完 整 填 写 信 息 时 显 示 “ 新 增 成  

型 ， 并 输 入 商 品 类 显 示 新 增 结 功 Ｖ 当 前 页 面 显 示 新 增 的 类 型 信    １ 通 过  
型 名 称 、 所 包 含 的 果 息 。 信 息 填 写 不 完 整 或 不 合 规 时

属 性编 号 等 信 息

显 示“新增 失败”





  

填 写 的 信 息 完 整 且 合 规 时 显 示  

点 击 修 改 商 品 类

显 示 修 改 结 “ 修 改 成 功 当 前 页 面 显 示 修 改

２ 型 ， 并 输 入 修 改 后 通 过  

果 后 的 商 品 信 息 类 型 信 息 。 信 息 填

的 产 ＿
＾

写 不 合规时 显示“修改 失 败”





  

删 除 成 功 时 显 示 “ 删 除 成 功 Ｖ 当  

点 击 某 商 品 类 型 显 示 删 除 结 前 页 面 中 不 再 显 示 被 删 除 的 商   ３ 通 过  
信 息 的 删 除 按 钮 果 品 类 型 信 息 。 否 则 显 示 “ 删 除 失  



＾   

６ ４

第六章 商品溯源原型 系统的测试



  

上 表 （

＿ 







）


  

编 号输入／动作预期 结果

输 出 结果

测 试 结 果

在 商 品 类 型 详 情 输 入 的 属 性

Ｄ Ｉ

合法时 ，

页 面 显  

页 点 击 新 增 该 类 显 示 更 新 结 示 新 增 的 属 性 详 细 信 息 并 提 示  

４ 通 过  

型包括 的 属性并

果 修 改 成 功 ？ ？

’’ 。

输 入 的 属 性 Ｄ 丨

不 合  

输入属性

Ｄ
１

法时页 面提示“修 改失败”





  

当 前 类 型 包 含 的 属 性 多 于 一 条  

时 ，

提示？？删 除 成 功Ｖ

被 删 除 的 属  

在 商 品 类 型 详 情  

显 示 删 除 结 性 信 息 被 从 当 前 页 面 移 除 。 当 前  

５ 页 点 击 某 条 属 性 通 过

果 类 型 包 含 的 属 性 信 息 等 于 一 条  

的 删 除 按 钮  

时 提 示 ？ ？ 删 除 失 败 信 息 类 型 必  

，

，





｜ 

须包括具体属 性”



  

６ ３ 测 试 结 果 ．

以 下 为 根据

６２ ．

章节所述的测试用 例对系 统进 行测试时产生 的一些截 图 ，

截

图 包 括 前 端 页 面 内 容 、 后 端 的 日 志 输 出 等 。

 ＝ ■

Ｄ ａ ｓ ｈ ｂ ｏ ａ ｒ ｄ  

用 户 个 人 信息  

联 系 电 话 ：

图

６－ １

系 统 管 理 员 工 作 界 面  

图

６－ １

和图

６－ ２

为不 同权限的用 户 登入 系统时前端页面的 不 同显示情况 。

系  

统 管 理 员 用 户 的 页 面 导 航 栏 中 显 示 商 品 信 息 录 入 、 用 户 信 息 管 理 等 较 多 可 使 用 的

６ ５

北京 邮 电大学工学硕士学位论文



  

功能 ，

普通用 户 的界面中 则仅显示对个人信息的管理和 商 品 信 息 查询界面 。

此 处

对 系 统 的 权 限 控 制 功 能 进 行 了 验 证 。  

 ＝ ３

Ｄ ａ ｓ ｎ ｂ ｏ ａ ｒ ｄ

，

二

，

＿

上  、 用 户 个 人 信 息  



Ｓ Ｓ Ｉ ｓ

？  Ｊ

：

ｕ ｓ ｅ ｒ ｌ

辟 料 金 遲 用 户   ：

１ ５ ５ ６ ６ ２ ２ ７ ６ ５ ４  
个 人 蝴 音 遇 用 户 ， ：

图 ６ － ２ 普 通 用 户 工 作 界 面  

图 ６ ３ －

是用 户 查询商 品流转信息时获取的结果界面截 图 ，

系 统 按 照 录 入 的 时

间 顺 序 显 不 商 品 流 转 丨 目 息 序 列 。  

＂
缝ｆ■ ％ 」
纖續

＾ ； ； Ｔ ｎ ｙ  ？ ＾ ａ ｆ ２ ６  ＾ ６ 

５ ８ Ｃ Ｓ Ｔ ２ ０ ２ ０  

谨 赁 Ｓ ｔ Ｓ

松 Ｓ 细 《 ？ ５ ４ ５ ？ ￡ 公 ２ 改： 灯 沾

的 拥 Ｗ ＾ ２ Ｓ ｉ ８ ｆ ｒ ４ ｓ ｓ

２ ？ ｉ ） ｓ ４ Ｓ

２ １ ５ ？

：

ｎ Ｓ  

｛
？ 洎 ＊ 裘翌 、

？ 生产 活息？ ，

维 倍 详 ＇

＂
思：

；

＇ 南 芸 名称 、 ？ 弗＿姦 品 ｒ ，

商 备 主 ５ Ｓ  ｒ ａ

，

彳

＊

，

：

＂ ＂
ｔｓｓ ｔ ２



 １ ＃／ ．

：

ｔ

商 品 类 型 ，

？

：

． 日 周 ｓ ＇

？ 苈 品 里 位 ｗ  

＇ 记 录 生 成 ｄ Ｕ ａｒ２

记 Ｈ ＇

ｒ


：

ａ ｄ ａ ｉ ｒ，  

＇

１ ６ ： １ ９ ： ５ ３ Ｃ ＳＴ  ２ ０ ２ ０

．

 Ｃ Ｓ Ｔ －

：

ｉ ｉｉ

２６１

５

５ ：

５

５０



Ｔ  ２ Ｃ ２ ０  

Ｉ ５ ＾ Ｉ ？

？Ｊ

ｓ３

＊

Ｓ＊

２

＞

３ ＆ｅｃ！ ４ ｂ５

？

ｆｃ

〇

７ ３

；ｉ

３

ｄ

－
：

４０

？

４

ｐ

＾

ｃ

ｉ ｃ ？ ｆ ｆ． Ｃ ５ ￡ ４ ｃ ８ ｃ ５ ８ Ｓ Ｄ ２ ０ ３ ｆ ５ ｅ ＆ ｉ ｃ ０ ８ ＝ ｊ ３ ｆ ｓ ９ ２ ｓ  

■ ，麵空． ，记ｍ  

详 维 ｍ ４

°

ｅ

：

＊ 商ｓ类

＇ 曰 用 品 ＇

埤 点  ｒ ＊

？

＊

：

Ｅｊ

，

名 罔 ？

〇

称

龙 试 商 品 ＇

＊  

２

＊
＼ Ｔ ｈ ａ  Ｈ ａ ｒ  ２ ６  １ ６ ： ２ ５ ： ５ ０  Ｃ ＳＴ  ２ ０ ２ ０

＾

ａ ｄ ａ ｉ ｒ ／  

３

图 ６ ３ － 商 品 信 息 查 询 界 面 截 图

６ ６  

第六章 商 品溯源原型系统的测 试



  

图 ６ －４ 是 用 户 录 入 商 品 生 产 记 录 时 获 取 的 结 果 界 面 截 图 该 界 面 包 括 录 入 信 ，
息 成 功 提 示 和 针 对 录 入 的 商 品 信 息 生 产 的 商 品 标 识 二 维 码 。 用 户 在 提 交 信 息 后 较   短 时 间 内 能 够 得 到 在 前 端 页 面 呈 现 的 反 馈 结 果 。
—
二 …  

＾ｍｍ 疙  

■ｆ ｔＨＰ  

議

邊 ：

：

Ｉ

图 ４ ６ － 商 品 信 息 录 入 界 面 截 图

在 用 户 录 入 商 品 信 息 时 ， 各 服 务 器 节 点 间 会 进 行 通 信 。 图 ６ ５ － 和 图 ６ － ６ 是 在

用 户 录 入 商 品 记 录 信 息 时 服 务 器 节 点 的 日 志 记 录 。

     ０ ２ ０ ２ ０ －

３ － ２６

１ ７ ： ４ ３ ： １０ ． １ ５ ３

Ｉ Ｎ Ｆ Ｏ１ Ｓ ２ ２ ４

－

－

－

［

ｐｏｏ ｌ －

ｌ － ｔ ｈ ｒ？ ａ ｄ －

ｌ ］

ｂ ． ｎ ． ｓ ． ｈ ． ｓ ． Ｎ ｅ ｗＴ ｒ ａ ｎ ｓ Ｇ ｅ ｎ ｅ ｒ ＊ ｔ ＊ Ｒ ｅ ｑ ｕ ＊ ｓ ｔ Ｈ ａ ｎ ｄ ｌ ？ ｒ：

息 请 求 消 息  

收 到 采  ｇ ｆ ＜ ｎ ｏ ｄ ＊ ｅ ＞ 的 生 成 倍  

    ％ ２ ０ ２ ０ － ０ ３ － ２ ６

１ ７ ： ４ ３ ： １０ ． ２ ６ ３

Ｉ

Ｎ

Ｆ

Ｏ１ ８

２

２

 ４



［ ｐ ｏｏ ｌ － １ － ｔ ｈ ｒ ｅ ａ ｄ －

１ ］

 ｂ ．

ｎ

．

ｓ

．

ｈ ．

ｓ

．

Ｎｅ ｗＴ ｒ ａ ｎ ｓ Ｇ ｅ ｎ ｅ ｒ ａ ｔ ｅ Ｒ ｅ ｑ ｕ ｅ ｓ ｔ Ｈ ａ ｎ ｄ ｌ ｅ ｒ：

ｂ ｓ ｂｏ ｄ ｙ ＞

＋Ｎ ｅ ｗ Ｔ ｒ ａ ｎ ｓＧ ｅ ｎ ｅ ｒ ａ ｔ ｅ Ｂ ｏ ｄ ｙ （ ｔ ｒ ａ ｎ ｓ Ｉ ｎ ｆ ｏ ＝ Ｔ ｒ ａ ｎ ｓ ｌ ｎ ｆｏ （ ｐ ｉ ｄ ＝ ０ｄ ｅ ９ ｃ ｆ ｅ ２

    ８ ｂ ６ ２ － ４ ９ ｂ ａ － ８ ６ ４ ３ － Ｉ ｆ ８ ｂ ｆ ５ ２ ｂ ５ ７ ５ ７ ，

ｕ ｐ ｄ ａ ｔ ｅ Ｔ ｉ ｍｃ ＝ Ｔ ｈ ｕ Ｍ ａ ｒ  ２ ６ １ ７ ： ４ ３ ： ０ ９ Ｃ Ｓ Ｔ ２ ８ ２ ０

，  

ｒ 消 息 类 型 记 录 信 息 ％ 详 细 信 息 商 品 类 型 出 版 物 Ｖ 地 点 商 品 名 称 ｉ ｒ ｖ ｆ 〇 ＝

＂

”

《

？？

＂

＂

＂

？？

＂ ？

”

＂

Ｍ

＂

：

｛

：

：

ＬＣ２

，

出 版 物 记 录 生 成 时 间 ” ２

？ ｝ ，

 －

”

：

Ｔｈｕ

Ｍ ａ ｒ  ２ ６  

 记 录 者  ０ ４ １ ７ ：

３ ：

９

ＣＳ Ｔ

＂

＂

２ ０２０

，

＂

＂

Ｍ

：

＊ ｄ ｍｉ ｎ

｝ ）

  ２ ０ ２ ０ － ０ ３ － ２ ６ １ ７ ： ４ ３ ： １ ０ ． ４ ９ ７

Ｉ

Ｎ

Ｆ Ｏ１

８

２

 ２ ４



 ［

ｐｏｏ ｌ － ｌ － ｔ ｈ ｒ ｅ ａ ｄ －

１ ］

ｂ ． ｎ ． ｓ ． ｈ ． ｓ ． Ｎ ｅ ｗＴ ｒ ａ ｎ ＊ Ｇ ｅ ｎ ｅ ｒ ａ ｔ ＊ Ｒ ｅ ｑ ｕ ｅ ｓ ｔ Ｈ ＊ ｎ ｄ ｌ ＊ ｒ：

发 送 返 回 包 ， 发 送 的 ｉ ｐ 地 址 为  

 ｉ

１ ９ ２ ． １ ６ ８ ． １ ． ７

 ４  Ｏ  ４   ｐ  ２ ０ ２ ６ － ０ ３ － ２ ６

１７ ：

３ ： １０ ． ４９ ８

Ｉ ＮＦ

１８２ ２

－

－

－

［

ｏｏ ｌ

－

ｌ

－

ｔ ｈ ｒｅ

ｄ ａ

－

１

］

ｔ ｔ ｔ ｂ ｃ  ．

ｎ ．  ｓ ．  ｏ ｃ ｋ ｅ



ｂ ａ  ． ｓ ｅ  ．  ｃ ｌ ｉ ｅ ｎ

Ｃ ．  ｌ ｉ ｅ ｎ ｔ Ｓ

ａ

ｒｔ

ｅ

ｒ ：

发送数 培包

一  

？

？

     ２ ０ ２ ８ － ６ ３ － ２ ６

４ １ ７ ：

３ ：

１６

．

５０ １

Ｉ Ｎ Ｆ Ｏ１ ８ ２ ２４ ［

ｔ ｉｏ －

ｇ ｒｏ ｕ ｐ －

５ ］

ｏ ｔ ． ． ｃ ｌ ｉ ｅ ｎ ｔ ． Ｃ ｏ ｎ ｎ ｅ ｃ ｔ ｉ ｏ ｎ Ｃ ｏ ｍ ｐ ｌ ｅ ｔ ｉ ｏ ｎ Ｈ ａ ｎ ｄ ｌ ｅ ｒ  ：  ｃ ｏ ｎ ｎ ｅ ｃ ｔ ｅ ｄ  ｔ ｏ  

１ ９ ２ ． １ ６ ８ ． １ ７ ． ： ６ ７ ８ ９ １

图 ６ ５ － 商 品 信 息 包 传 递 时 上 游 节 点 系 统 日 志 输 出 截 图

下 游 节 点 对 商 品 信 息 进 行 记 录 ， 并 将 记 录 的 商 品 信 息 发 送 到 上 游 节 点 进 行 验   证 。 上 游 节 点 收 到 了 来 自 下 游 节 点 的 商 品 记 录 信 息 包 ， 对 包 中 的 内 容 进 行 校 验 后 向 下 游 节 点 返 回 校 验 结 果 。 下 游 节 点 收 到 来 自 上 游 节 点 的 返 回 包 后 ， 调 取 数 据 库   中 存 储 的 上 游 节 点 公 钥 对 包 内 数 据 进 行 验 证 。 验 证 通 过 后 将 数 据 写 入 本 地 数 据 库 。  

６ ７

北京邮 电大学工学硕士学位论文



  

０   Ｏ ４   ０  ２ ０ ２ ０ －

３ － ２６

１７

４ ３ ：

：

０９

．

８６１

Ｉ ＮＦ １ ８ ２ ２

－

－

－

ｎ ｉｏ － ８ ［

８７ － ｅ ｘ ｅ ｃ － ４ ］

ｃ ｂ  ． 

．

ｎ

ｓ ．  ｏ ｃ ｋ ｅ ｔ

ｂ ． 

ａ ｓ ｅ ｃ  ． 

ｌｉ

ｔ ｅ ｎ

．

Ｃｌ

ｉ ｅ ｎ ｔ Ｓ ｔ ａ ｒｔ

ｅ

ｒ ：

发 数 据 送

包 一  

      ２ ０ ２ ８ － ０ ３ － ２ ６

１７ ： ４ ３ ： ＆９ ． ８ ７ ５

Ｉ ＮＦ Ｏ１Ｓ ２ ２４  ［

ｔ ｉｏ － ｇ ｒｏｕ ｐ － １ ］

ｏ ． ｔ ． ｃ ｌ ｉ ｅ ｎ ｔ ． Ｃ ｏ ｎ ｎ ｅ ｃ ｔ ｉ ｏ ｎ Ｃ ｏ ｍ ｐ ｌ ｅ ｔ ｉ ｏ ｎ Ｈ ａ ｎ ｄ ｌ ｅ ｒ  ：  ｃ ｏ ｎ ｎ ｅ ｃ ｔ ｅ ｄ  ｔ ｏ  

１９２ ．

１ ６８

１ ．

．

６

：

６ ７ ８ ９

０ ０  ４ ８  Ｏ  ４    ２ ０ ２

－

３ － ２６

１７ ：

３：１

． ８４６

ＩＮＦ

１Ｓ２ ２

－

－

－

ｐｏｏ ｌ － ｌ － ｔ ｈ ｒ ｅ ａ ｄ － ２

［

］

ｇ Ｈ ｂ ｈ ｃ ｌ ｎ ｔ ｐ Ｒ ｃ  ． 

ｎ ｓ ． 

．

．

．

ｉｅ

Ｒ ．  ｅ ｓ

ｅ

ｉ ｓ ｔ ｅ ｒ ａ ｎ ｄ ｌ ｅ ｒ：

息 回 应 消 息  

收 到 来 自 于 ＜ ｎ ｏｄ ｅ ｌ ＞ 的 生 成 信  





      ２ ？ ２ ０ － ６ ３ － ２ ６

１７

： ４３

：

８ １

．

８４０

Ｉ Ｎ ＦＯ１８２ ２４ 

ｐｏｏ ｌ － ｌ － ｔ ｈ ｒ ｅ ａ ｄ － ２

［

］

ｃ ． ｂ ． ｎ ． ｓ ． ｈ ． ｃ ｌ ｉｅ ｎ ｔ ． Ｒ ｅ ｓ ｐ Ｒ ｅ ｇ ｉ ｓ ｔ ｅ ｒ Ｈａ ｎ ｄ ｌ ｅ ｒ：

Ｒ ｅ ｓ ｐ Ｎ ｅ ｗ Ｔ ｒ ａ ｎ ｓ Ｂ ｏ ｄ ｙ （ ａ ｃ ｃ ｅ ｐ ｔ ＝ ０ ，  

ｈ ａ ｓ ｈ ＝ ３ ３４ ２ ４ ｄ ｃ ７ ９ ｂ ２ ９ ７ ８ ａ ６ ３ ３ ３ ３ ７ ３ ａ ａ ４ ｂ ｂ ８ ａ ５ ２ ｂ４ ７ ３４ ９ ａ ａ ９ ｄ ｂ ８ ｅｆ ｌ ７ ｄ ８ ６ ｃ ９ ｅ ０ ７ ｂ ９ ９ Ｓ ｌ ？ｅｆ ２ ，

 ｓ ｉ ｇ ｎ ＝ Ｍ Ｅ Ｑ Ｃ Ｉ Ｈ ６ ｈ Ｋ ｑ ｔ ｖ Ｄ ２ Ｇ ？ ｆ Ｄ ／ ｙ Ｇ Ｐ Ｇ ３ Ｋ ｍ ８ Ｎ ｏ ０ ／ ｅ ｂ Ｈ ｋ Ｍ ｑ ｊ Ｘ ｉ ４ ３ ０ Ｕ Ｂ Ｉ ７ ｇ Ａ ｉ Ｂ ｔ ８ Ｆ ｒ ｔ Ｔ Ｎ Ｖ ｌ Ｎ Ｔ ｗ Ｄ ／ ２ Ｅ ｖ ｍ Ｗ ｑ ｇ ７ Ｎ Ｖ Ｄ ？ ｗ ｌ ｐ ｚ ｒ ｌ ＋ ３ Ｇ ｊ Ｘ Ｑ ９ １ ５ Ｂ Ａ ＝ ＝ ，

ｔ ｒ ａ ｎ ｓ Ｉ ｎ ｆ ｏ ＝ Ｔ ｒ ａ ｎ ｓ Ｉ ｎ ｆ ｏ  

  消 息 类 型 记 录 信 息 （

ｐｉｄ ＝ｅｄｅ ３ ｃ ｆ ｅ ２

－

８ ｋ＞ ６ ２

－ ４９ ｂ ａ

－

８ ６４

３

－

ｌ ｆ ８ ｔ？ ｆ Ｓ ２ ｂ Ｓ ７ Ｓ ７ ，

ｕ ｐ ｄ ａ ｔ ｅ Ｔ ｉｍｅ ＝ Ｔ ｈ ｕＭ ａ ｒ２ ６１ ７ ： ４ ３ ： ６ ３Ｃ Ｓ Ｔ２ ０ ２ ０ ，

■

ｉ ｎ ｆ ｏ＝

？

（

＂

＂

：

＂

＂ 详细 信 息

，

品 类型

出 钣 物 地 点 商 品 名 称 ＂ 、

” ：

＂

＂

＂

ＬＣ２

，

出 版 物 ／ 记 录 生 成 时 间 记 录 者 ＂

？

２

｝

  ＂

＂

：

Ｔ ｈ ｕＭａ ｒ２ ６

 １ ７ ： ４ ３ ： ０ ９ Ｃ Ｓ Ｔ

”
２ ０２ｅ

＂

，

＇ ’’

＂

．

ａ ｄ ｍｉ ｎ

｝ ）  

商  

图 ６ － ６ 商 品 信 息 包 传 递 时 下 游 节 点 系 统 日 志 输 出 截 图

６ ４ 本 章 小 结   ．

本 章 首 先 介 绍 了 商 品 溯 源 原 型 系 统 的 开 发 和 运 行 环 境 ， 随 后 结 合 第 四 章 和 第

五 章 中 对 原 型 系 统 的 需 求 分 析 和 具 体 实 现 过 程 ， 针 对 其 中 主 要 的 功 能 模 块 进 行 了  

测试用 例 的设计 ，

并按照测试用 例 对系 统进行 了 相应测试 ，

测 试 结 果 以 测 试 用 例

表 、 系 统 界 面 和 日 志 截 图 的 形 式 进 行 了 展 示 。  

６ ８

第七章 结语



  

第 七 章 结 语  

７ ． １ 论 文 工 作 总 结  

本 文 首 先 对 商 品 供 应 链 管 理 中 可 能 存 在 的 问 题 、 商 品 溯 源 系 统 的 现 状 、 区 块  

链 技 术 以 及 二 者 结 合 的 研 究 现 状 进 行 了 调 研 和 分 析 。 在 此 基 础 上 设 计 了 种 一 基 于  

区 块 链 技 术 的 商 品 溯 源 原 型 系 统 ， 并 对 该 系 统 进 行 了 编 码 实 现 和 测 试 。 主 要 工 作

包 括 ：  
１ ）
２ ）
３
）

对 区 块 链 技 术 进 行 调 研 和 学 习 ， 熟 悉 其 特 点 、 工 作 原 理 和 应 用 方 向 。   对 商 品 供 应 链 管 理 过 程 中 可 能 存 在 的 问 题 进 行 调 研 ， 了 解 商 品 溯 源 系 统 的 现 状 ， 分 析 典 型 的 商 品 溯 源 系 统 中 存 在 的 不 足 。   根 据 对 商 品 溯 源 业 务 场 景 和 现 有 商 品 溯 源 系 统 的 分 析 ， 针 对 商 品 溯 源 场   景 改 进 了 区 块 链 的 结 构 和 数 据 存 储 规 则 ， 设 计 了 一 种 适 用 于 商 品 流 转 信  

息 存 储 的 网 状 区 块 链 。  

４ 分 析 商 品 溯 源 原 型 系 统 的 需 求 ， 完 成 对 基 于 区 块 链 技 术 的 商 品 溯 源 原 型 ） 系 统 的 需 求 分 析 。  

５

在 需求 分析 的基础上逐步进行概要 设计 、

详细设计 ，

选 取 适 当 的 技 术 完  

）

成 对 原 型 系 统 的 编 码 实 现 。  

６ 针 对 原 型 系 统 的 主 要 功 能 模 块 设 计 测 试 用 例 并 完 成 测 试 ， 记 录 测 试 结 果 。   ）

７ ． ２ 问 题 与 展 望

本 文 研 究 和 实 现 的 商 品 溯 源 原 型 系 统 ， 虽 然 已 经 基 本 满 足 了 需 求 分 析 中 提 出  

的 需 求 ， 但 在 原 型 系 统 的 实 现 和 区 块 链 的 设 计 中 仍 存 在 一 些 不 足 之 处 。 具 体 情 况  

如 下 ：
１ ）

系 统 的 前 端 页 面 设 计 美 观 程 度 不 足 。 系 统 的 前 端 页 面 主 要 面 向 ＰＣ 端 用 户 ， 考 虑 到 实 际 场 景 下 用 户 存 在 使 用 手 机 浏 览 器 访 问 系 统 的 情 况 ， 前 端   页 面 需 要 增 加 对 移 动 端 的 适 配 。 此 外 信 息 的 呈 现 、 交 互 界 面 的 显 示 也 可  

以 进 行 完 善 和 美 化 。  

２ 商 品 编 码 方 案 可 以 改 进 。 可 以 使 用 Ｇ Ｓ １ 编 码 等 通 行 的 编 码 方 案 提 升 系 统   ）

扩 性 的

展

。

６ ９  

北京 邮 电大学工学硕士学位论文



  

３ 系 统 的 模 块 划 分 可 以 进 行 改 进 。 目 前 系 统 中 区 块 链 部 分 与 业 务 部 分 存 在 ） 一 定 程 度 的 耦 合 。 在 业 务 产 生 变 化 时 与 区 块 链 结 构 的 适 配 性 可 能 会 降 低 。   后 续 可 以 将 区 块 链 部 分 从 业 务 操 作 中 完 全 剥 离 以 降 低 系 统 的 耦 合 度 。  
此 外 还 可 以 在 系 统 安 全 性 、 性 能 分 析 和 仿 真 等 方 面 进 行 完 善 。 引 入 Ｓｐｒｉ ｎｇ   Ｓ ｅｃｕｒｉ ｔｙ 、 Ｓ ｈｉ ｒｏ 等 框 架 提 升 系 统 安 全 性 ， 选 择 其 他 通 信 解 决 方 案 提 升 系 统 的 响 应 速 度 ， 通 过 大 规 模 部 署 和 实 地测 试 来 确 认 系 统 的 真 实 性 能 等 ， 都 可 以 作 为 系 统 进   一 步 优 化 和 探 索 的 目 标 。  

７ ０

参考文献



  

参 考 文 献  

Ｋ Ｎ      １

［

］

ｓ ｈ ｅｔｒｉ

．

Ｂ’
ｌ ｏ ｃｋｃｈａｉｎ ｓｒｏ ｌ ｅ ｓ

ｉｎｍｅｅ ｔｉｎｇ ｋｅｙ

ｓ ｕｐ ｐ ｌ ｙ

ｃ ｈ ａｉ ｎ  ｍａｎ ａ ｇ ｅ ｍ ｅ ｎ ｔ  

Ｍ ｏ ｂ ｅ ｃ ｔｉ ｖ ｅ ｓ Ｊ ．  Ｉ ｎｔｅ ｒ ｎ ａｔ ｉ ｏ ｎ ａ ｌ  Ｊ ｏ ｕ ｒ ｎ ａｌ  ｏ ｆ  Ｉ ｎ ｆｏ ｒｍ ａｔ ｉ ｏ ｎ 

ｊ

［］

ａｎ ａｇｅｍ ｅｎｔ，２ ０

１

８ ９ ０ ８ ９ ３ ，

：８

－

．

２ 陈艺文． 基于 区 块链 的供应链管理系统设计与 实现 Ｊ ． 现代计算机 （ 专业版 ）

［］

［］

，  

０ ９ ２ ０ １ ９ （

６ ３ ：  ８

－

）

０ ．

３
［］

陈欢 ，

方越锋 ．

探讨我 国 食品 溯源 的 应用 现状及优化建议 Ｊ ． ［］

中 国 集体经济 ，  

２ ０ ６ ０ ０ １

（

 １ ） ：

１１

－

１ １

１ ．  

４

［

］

颜嘉麒．

供应链质 量管理 中 质 量检测 的 一种模型化方法 Ｄ ．

［

］

中 国 科 学 技 术 大  

学

２ ０ ０ １

．  

，

唐 晓 波 黄 媛 媛 协 管 战 略 及 模 型 评 价 情 报 杂 志 ５

ＳＣ Ｍ
＿

同理

［

］

，

Ｊ．
［］

２ ０ ０ ０  ，

５
（

１ ）：

８ ８ －  

９ ０ ．  

Ｈ Ｂ Ｒ Ｗ Ｍ Ｔ ６

［

］

ｕ ｃｋｌ ｅＳ ，

ｈ ａｔｔａ ｃ ｈ ａｒｙ ａ 

，

ｈ ｅ ｉ ｔ 

ｎ ｒ ｎ ｏ ｅ ａ ｔ 

ｌ ．Ｉ

ｔｅ

ｅｔ

ｆ 

，

ｈ ｉ ｎ ｇ ｓ ，  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａｉ ｎ  ａｎ ｄ  ｓ ｈ ａｒｅ ｄ  

＾ Ｃ ｅ ｃ ｏ ｎ ｏ ｍｙ ａｐ ｐ ｌ ｉ ｃ ａｔ ｉ ｏ ｎ ｓ

 ． Ｐ ｒ ｏ ｃ ｅ ｄ ｉ ａ 
］

ｏ ｍ ｐ ｕｔｅｒＳ ｃ ｉ ｅ ｎ ｃ ｅ ，２ ０

１

６ ，９ ８

：４ ６

１

－４６６ ．  

Ｃ Ｍ Ａ Ｍ Ｖ Ｍ Ｂ Ａ ７
［ ］

ａｒｏ

Ｐ ，

ｌ ｉ

Ｓ 

，

ｅｃｃｈｉ ｏ

ｅ ａ ， 

ｔ

 ｌ ．

ｙ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ － ｂ ａｓ ｅ ｄ  ｔ ｒ ａ ｃ ｅ ａ ｂ ｉ ｌ ｉ ｔ

ｎ  ｉ



ｇｒ ｉ － Ｆ ｏ ｏ ｄ  

Ａ Ａ Ｔ Ｖ ｓ ｕ ｐ ｐ ｌ ｙ  ｃ ｈａｉ ｎ  ｍ ａｎ ａｇ ｅ ｍ ｅ ｎ ｔ ： 

ｐｒａ ｃｔｉ ｃ ａ ｌｉ ｍｐ ｌ ｅ ｍ ｅ ｎ ｔａｔｉ ｏ ｎ［

．  ／／  ２ ０ １ ８  Ｉ ｏ  ｅ ｒｔ ｉ ｃ ａ ｌ  ａｎ ｄ  
］

Ｔ Ａ Ｔ Ｏ Ｔ Ｔ Ｃ Ｔ Ｅ Ｅ Ｅ ｏ ｐ ｉ ｃ ａ ｌ  Ｓ ｕ ｍｍ ｉ ｔ  ｏ ｎ 

ｇ ｕ ｕ ｒｉ ｃ

ｌｔ

ｅ ｒ

－


ｕ ｓ ｃ ａｎｙ  （ Ｉ

 ｕ ｓ ｃａｎｙ ）［

］ ，

ｕｓｃ ａｎｙ ：Ｉ

２ ０ ８  ， 

－  

１

：

１

４ ．  

Ｔ Ａ Ｃ Ｐ Ｄ   ［ ８ ］ Ｆ ｅ ｎ ｇ 

ａ ｎ ｉ

．

ｎ  ａ ｇ ｒ ｉ － ｆｏ ｏ ｄ  ｓ ｕｐ ｐ ｌ ｙ  ｃ ｈ ａ ｉ ｎ  ｔ ｒ ａｃ ｅ ａ ｂ ｉ ｌ ｉ ｔ ｙ  ｓ ｙ ｓ ｔ ｅ ｍ  ｆｏ ｒ 

ｈ ｉ ｎａｂａｓｅｄｏ ｎＲ

Ｉ

＆ Ａ Ｃ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  ｔｅ ｃ ｈｎｏ ｌ ｏ ｇｙ  ［

ｒ ｎ ｎ ０ ６ ｎ ２ ．  ／／ 

１

Ｉ ｔｅ

ａｔｉ ｏ ａｌ

］

ｏ ｎ ｆｅ ｒｅ ｎ ｃ ｅ  ｏ ｎ  Ｓ ｅ ｒｖ ｉ ｃ ｅ  Ｓ ｙ ｓ ｔｅ ｍ ｓ  ａｎ ｄ  

Ｍ Ｃ Ｋ Ｅ Ｅ Ｅ Ｓ ｅ ｒｖ ｉ ｃ ｅ 

ａｎａｇ ｅ ｍ ｅ ｎ ｔ  ［

］ ，

ｕｎｍ ｉ ｎ ｇ ： Ｉ

２ ０ ６  ６ ， 

－

１

：

１

．

Ａ Ｈ Ａ Ｃ Ｔ Ｆ ９
［

］

ｅｎ ｇ

ｎ ｉ ａ

．

 ｓ ｕ ｐ ｐ ｌ ｙ  ｃ ｈ ａ ｉ ｎ  ｔｒａ ｃ ｅ ａ ｂ ｉ ｌ ｉ ｔｙ  ｓｙ ｓ ｔ ｅ ｍ  ｆｏ ｒ  ｆｏ ｏ ｄ  ｓ ａ ｆｅ ｔｙ  ｂ ａｓ ｅ ｄ  ｏ ｎ 

ＣＰ ，  

＆ Ａ Ｃ ｂ ｌ ｏ ｃ ｋ ｃ ｈａ ｉ ｎ

 Ｉ ｎ ｔ ｅ ｒ ｎ ｅ ｔ  ｏ ｆ  ｔｈ ｉ ｎ ｇ ｓ  ［

，  ／ ／  ２ ０ １ ７  Ｉ ｎ ｔ ｅ ｒｎ ａｔ ｉ ｏ ｎ ａ ｌ  ｏ ｎ ｆｅ ｒ ｅ ｎ ｃ ｅ  ｏ ｎ  Ｓ ｅ ｒｖ ｉ ｃ ｅ  
］

Ｍ Ｃ Ｄ Ｅ Ｅ Ｅ Ｓ ｙ ｓ ｔｅ ｍ ｓ  ａｎ ｄ  Ｓ ｅ ｒ ｖ ｉ ｃ ｅ 

ａｎａｇ ｅ ｍ ｅｎｔ［

］ ，

ｎ ａ ｌ ｉ ａ

：Ｉ

２ ０ ７  ６ ， 

－

１

：

１

．  

Ｔ Ｋ Ｍ Ａ Ｎ ０ １
［

］

ｏｙ ｏｄａ

，

ｈ Ｔ ａｔ

ｉｏｐｏｕｌｏ ｓＰ

Ｓ ， 

ａ ｓ ａｓ ｅ  Ｉ ，  ｅ ｔ  ａ ｌ  ．



ｏ ｖ ｅ ｌ  Ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ － Ｂ ａ ｓ ｅ ｄ  Ｐ ｒ ｏ ｄ ｕ ｃ ｔ  

Ｏ Ｍ Ｏ Ｍ Ａ ｗｎ ｅｒ ｓ ｈｉ ｐ

ａｎａｇｅ ｍ ｅｎｔＳｙ ｓｔｅ ｍ（ Ｐ

Ｓ ）  ｆｏ ｒ 

Ｃ ｎ ｔ － ｉ

ｏ ｕｎ ｔ ｅ ｒ ｆｅ ｉ ｔ ｓ  ｉ ｎ  ｔｈ ｅ  Ｐ ｏ ｓ ｔ  Ｓ ｕ ｐ ｐ ｌ ｙ  

Ｃ Ｅ Ｅ Ｅ Ａ ｈ ａｉ ｎ Ｊ ．  Ｉ ［］



４ ｃ ｃ ｅ ｓ ｓ ，  ２ ０

１

７

，５

 ：

１

７４６５ －

１

７

７ ７ ．  

ｒｉ Ａ Ｃ Ｃ Ａ Ｂ Ｆ ｇ １
［

１ ］

ｉ

ｏ

Ｓ ｌ ｌ ｉ 

，

ｎｔｏ ｎ ｕ ｃｃ ｉＦ， ｏ ｓｔａ

ｅ ａ ， 

ｔ

 ｌ ．



ｌ ｏ ｃ ｋ ｃ ｈ ａｉ ｎ  Ｉ ｍ ｐ ｌ ｅ ｍ ｅ ｎｔａ ｔ ｉ ｏ ｎ  Ｐ ｒ ｏ ｔ ｏ ｔｙ ｐ ｅ

Ｅ Ｏ Ｔ Ｗ Ｗ Ｃ ｆｏ ｒ  ｔｈ ｅ  ｌ ｅ ｃ ｔｒｏ ｎ ｉ ｃ 

ｐ ｅ ｎ  Ｓ ｏ ｕｒ ｃ ｅ  ｒ ａｃ ｅ ａｂ ｉ ｌ ｉ ｔｙ  ｏ ｆ 

ｏ ｏ ｄａｌ ｏｎ ｇｔｈ ｅ

ｈｏ ｌ ｅＳｕｐｐ ｌ ｙ

ｈ ａ ｎ ｉ

Ｊ ［

］ ，  

Ｓ ｎ ｅ

ｏ ２ ｓ

ｒｓ ，

０ ８ ８ ３ １

，１

：

３ ３ １

．  

Ｎ Ｂ Ａ Ｃ １ ２

［

］

ａｋａｍ ｏ ｔｏＳ ． 

ｏ ｎ ｉ ｔ ｃ

ｉ

：

ｐ ｐ ｏ ｅ ｅ ｒ－ ｔ

－

ｅｅ ｒｅｌ



ｅ ｃ ｔｒｏ ｎ ｉ ｃｃ ａｓｈｓｙ ｓ ｔｅ ｍ

Ｊ
［］

 ．

ｄ ｏ ｎ ｓ ｕ ｌ ｔ ｅ

２ ０ ０ ， 

８ ．  

Ｗ Ｇ Ｅ Ａ  １ ３

［

］

ｏｏｄ


．

ｔｈ ｅ ｒ ｅ ｕ ｍ  ：

ｓ ｅ ｃ

ｕｒｅｄ ｅｃ ｅｎｔｒａｌ

ｉ

ｓｅ ｄｇ ｅ ｎ ｅｒａｌ

ｉ

ｓ ｅｄｔｒａ ｎ ｓ ａｃｔ ｉ

ｏｎｌ

ｅｄ ｇｅｒ

Ｊ
［］

．  

Ｅ ｍ Ｐ Ｙ ｔｈ ｅ ｒ ｅ ｕ

 ｒｏ ｅｃ ｔ ｊ

ｗ Ｐ ｐ ２ ４ ２ ｅ ｌ ｌ ｏ

 ａ ｅ ｒ，  ０ １

５  ３  １
，

１：

－
１

．

７ １  

北京邮 电大学工学硕士学位论文



  

Ｑ Ｈ Ｄ Ａ ［ １ ４ ］  Ｆ ｅ ｎ ｇ 

，

ｅ

Ｚ ， 

ｅ ａｄ ａｌ ｌ ｙ  Ｓ ５  ｅ ｔ  ａ ｌ  ．

 ｓ ｕ ｒｖ ｅ ｙ  ｏ ｎ  ｐ ｒ ｉ ｖ ａｃ ｙ  ｐ ｒ ｏ ｔ ｅ ｃ ｔ ｉ ｏ ｎ  ｉ ｎ  ｂ ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  

Ｎ Ｃ Ａ ｓｙ

ｓｔｅｍ

Ｊ
［］

．  Ｊ ｏ ｕｒ ｎ ａ ｌ  ｏ ｆ 

ｅ ｔｗ ｏ ｒｋ ａｎ ｄ  ｏ ｍ ｐ ｕ ｔｅ ｒ 

ｐｐ ｎ ｏ ａ ｃ ｌ ｉ

ｔｉ

２ ０ ９ ２ ６ ４ ｓ ， 

１

１
，


：

５－５ ８ ．  

Ｍ Ｄ Ｇ Ａ Ｄ Ｔ ［ １ ５ ］  Ｐ ｅ ａｒ ｓ ｏ ｎ  Ｓ ， 

ａｙ

Ｌ ５ 

ｅｏｎｔｉ ｄ ｉ ｓ

ａ ｅ ， 

ｔ

 ｌ ．

ｒｅ

ｉ ｓ ｔｒｉ ｂ ｕ ｔ ｅ ｄ  Ｌ ｅ ｄ ｇ ｅ ｒ  ｅ ｃ ｈｎ ｏ ｌ ｏ ｇ ｉ ｅ ｓ  ｔ ｈ ｅ  

Ｇ ｐ ａｎ ａｃ

ｅ ａ  ｆｏ

ｒ  ｆｏ ｏ ｄ  ｔｒ ａ ｃ

ｅ ａｂ ｉ

ｌ

ｙ ｉ ｔ

？

Ｊ
［］

 ．

Ｆ ４ ｌ ｏ ｂ ａ ｌ 

ｏ ｏ ｄＳ ｅ ｃ ｕｒｉｔｙ， ２ ０

１

９

２
，

０

 ：

１

５ ４ ９ －

１

．  

Ｃ Ｒ Ｂ Ａ Ｄ Ｎ Ｂ Ｏ ［ １ ６ ］  Ｌ ｅ ｍ ａｈ ｉ ｅｕ 

．

ａｉ

ｏ ｋ ｌ

ｃ

ｓ ：

Ｆ  ｅ ｅ ｌ ｅ ｓ ｓ 

ｉ ｓ ｔｒｉ ｂ ｕ ｔｅ ｄ  Ｃ ｒｙ ｐｔｏ ｃ ｕｒｒｅ ｎ ｃ ｙ 

ｅ ｔｗｏ ｒｋ Ｅ ／ ［

Ｌ ．   ］

２ ０ ８ ０ ６ １

．１

．１

．  

［

］

１７ 刘家稷 杨挺 汪文勇 ． 使用双 区块链 的 防伪溯源系统 Ｊ ． 信 息安全学报

［

］

，

，

［］

，  

２ ０ ２ ０ １

８３

，

（

３ ７ ） ：  １

－

９ ．  

Ｈ Ｘ Ｃ Ｘ Ｌ Ｋ Ａ Ｄ Ｎ ［

１

８
］

ｅ

，

ｈｅｎ

，

ｉ

．



ｅｃｅｎｔｒａｌ ｉ ｚ ｅ ｄａｎｄ

Ｔ ｏ ｎ － ｒｅ ｖ ｅｒ ｓ ｉ ｂ ｌ ｅ  ｒａ ｃ ｅ ａｂ ｉ ｌ ｉ ｔｙ  Ｓ ｙ ｓ ｔ ｅ ｍ  ｆｏ ｒ

Ｃ Ｄ Ｋ Ｔ Ｏ Ａ Ｓ ｔｏ ｒ ｉ ｎ ｇ

ｏｍｍ ｏｄｉ ｔｙ

ａｔ ａ Ｊ  ． ［］

ｎ ｓ ｉ ｉ  ｒａｎ ｓ ａ ｃ ｔｉ ｏ ｓ 

ｎ  Ｉ ｎ ｔ ｅ ｒ ｎ ｅｔ 

ｎ ｄ  Ｉ ｎ ｆｏ ｒｍ ａｔｉ ｏ ｎ  Ｓ ｙ ｓ ｔ ｅ ｍ ｓ ，  

０ ９ ２ ６ ９ ４ ２ １

１３

，

（

） ：

１

－６３

．  

Ｂ ｋ Ｒ Ｂ Ｂ Ｔ Ｒ Ｂ Ｗ ｄ Ｃ １ ９

［

］

ｅｃ 

．

ｅｙ ｏ ｎ ｄ

ｏ ｎ ｉ ｔ ｃ ｉ

：

ｈ ｅ

ｉ

ｓ

ｅ

ｏ

ｆ 

ｌ ｏ ｃｋｃ ｈａｉ ｎ

ｏｒｌ

Ｊ ［

， ］

ｏ ｍ ｐ ｕ ２ ２ ｔ ｅ ｒ ，

０１ ８ ５ １

，

（

） ：  

４ ５ ８ ５

－

．  

蔡 晓 晴 邓 売 张 亮 等 块 链 原 及 其 核 技 术 计 算 机 学 报 ２ ０

［

］

，

，

区
． ，

理

心

Ｊ

［

］，

２ ０ ９ １

：

１

－  

，

５ １ ．  

Ｏ ＴＡ Ｄ Ｄ Ｅ Ｂ Ｏ Ｌ ２ １

Ｉ

［

］



ｅｖｅ ｌ ｏｐｅｒ

ｏ ｃ ｕｍｅ ｎｔａｔｉｏｎ ［

／

２ ０ ９ ０ ０ ４ ｐ ｄ ｏ ｏ ａ ｇ  ．

］

［

１

．１

．

ｈ  ．

ｔｔ

］

ｓ ： ／／

ｃｓＪ

ｔ

ｏ ．

ｒ

／ ．

蒲 链 综 算 机 科 何 ２２

［

］

于戈 张岩峰 等 区块

．

，

，

，

技术与应用 前瞻

述 计 Ｊ ． ［］

学 ２０ １ ７

，

，  

４ ４ ４ ７ （

 ） ：

１－

．

张 数 技 机 械 版 社 ２３

［

］

先红 ．

字签名 原理及

术Ｍ ．

［

］

工业 出

２ ００４ ．   ，

Ｑ Ｍ Ａ Ｒ Ｄ ［ ２ ４ ］ Ｓ ｈ ｅ ｎ ｇ  Ｚ ，  Ｚ ｅ ａｄ ａｌ ｌ ｙ Ｓ ， 

ｉ ｔｒｏｋｏ ｔｓ ａ

  ｅｔ  ａｌ ．
，

ＦＩ

 ｔｅ ｃ ｈｎ ｏ ｌ ｏ ｇ ｙ，  ｓ ｙ ｓ ｔ ｅ ｍ ｓ ，  ａｎ ｄ  

Ｎ Ｃ Ａ ｔｉ ａｐｐ

ｌ

ｉ

ｃ ａｔｉ

ｏｎｓ

Ｊ
［］

．  Ｊ ｏ ｕｒ ｎ ａ ｌ  ｏ

ｆ 

ｅｔｗｏ ｒｋａｎ ｄ ｏ ｍｐｕｔｅ ｒ

ｐｐｌ ｉｃａ

ｏ ｎ ４ ２ ０ ｓ ， 

３ １ １ ， 

７ ９ ７ ９ ３
（

）

：

７ －

８ ．

２５

［

］

张丰 ，

施勇 ，

薛质 ．

二维

ＱＲ

码在 电子商务中 应用 的安全性研宄 Ｊ ． ［］

计 算 机  

技 术 与 发 展 ２０ ７ ，

１

３  ３ ３ ５ （

）：

１

１ －１

．

Ｚ Ｅ Ｂ Ｏ Ｌ ｄ ２ ６

［

］

ｘ ｎ ｇ ｉ

 ．
［

／

２ ９ ０ ０ ２ ｈ Ｄ  ．

］

［

０１

７

．

．

 ． ］

ｔｔ

Ｓ ： ／／

ｔ ｈｕｂ

．

ｃ

ｏ

ｍ／ｚ

ｘ ：

ｉ

ｎ

ｉｚ

／

ｚｘ

ｉ

ｎ

ｇ  

ｐ ｎ Ｂ Ｅ Ｂ Ｏ Ｌ ｐ ｍ ２ ７ Ｓ

［

］

ｒｉ

ｇ

ｏｏｔ ［

／

２ ０ ９ ０ ２ ９ ｐ ｐ ｇ  ．

］

［

１

．

６．

ｈ ． 

ｔｔ

］

ｓ ： ／／ｓ

ｒ ｉ ｒｔ

ｏ ． ｉ

／

ｏ ｒ

ｉ ｅ ｃ ｔ ｓ ／ｓ ｒ） ｒ ｉ ｒ

ｂ ｏ ｏ －

ｔ ／ ．

２８

［

］

谭 耀 武 Ｅ Ｂ ＯＬ ｏ ｔ－

．

ｉ

［

／

２ ０ ９ ０ ０ ２ ｈ ｐ ｍ ｗ ｏ ｏ ］

 ． ［

１

＿

７．

． ］

ｔｔ

ｓ ： ／／

ｖ

ｔ－

．

ｉ

．

ｒ ａ ．

Ｄ Ｅ Ｂ Ｏ Ｌ Ｌ ＭＡＸ Ｅ Ｄ ２ ９

［

］

ｉ

ｓ ｒｕ ｐ ｔｏ

ｒ 

［

／

ｐ ｈｕ ｍ ２ ０ ９ ０ ０ ｈ ］ ．  ［

１

．

８． １

．

ｔｔ

］

ｇ ｓ ： ／／

ｉｔ

ｂ． ｃｏ

／

－ ｘｃ ｈ ａｎ ｇｅ ／

ｕｐ ｏ ｉ ｓ ｒ

ｔ

ｒ ．

Ｘ Ｄ 核 心 Ａ 和 应 用 模 式 Ｏ ［ ３ ０ ］ Ｌ ｉ ｕ

 ｉ ＿

ｉ ｓｒｕｐｔｏ ｒ



ＰＩ

ＥＢ／
［

Ｌ  ２ ９  ｕ ． ］

［

０

１

９０ ．

０ ． １

．

］

ｈ ｐ ｔ ｔ

ｓ ／ ／ ：

ｌｉ

ｘ ｉ ． ｎ  

Ｄ ａｍ ｅ ／ｂ ｌ ｏ ｇ ／ ２ ０ １ ８ ０ ６ １ ３ ／

ｕ ｐ ｐ Ｄ ｍ ｈ ｍ ｉ ｓ ｒ

ｔｏ ｒ－ ａ

－
ｉ

ａ ｔｔ ｅ

．

ｔ

ｌ ．  

邵 奇 峰 金 澈 清 张 等 块 链 技 术 架 构 及 进 计 算 机 学 报 ３ １

召

区

．

［

］

，

，

，

：

展Ｊ ． ［］

２０ １ ８

，

，

４ ０ ９ ６ ９ １ （

５ ）  ：

９－

８ ８ ．  

Ｌ Ｑ Ｗ Ｈ Ｐ Ｘ Ｔ Ｂ Ｂ ３ ２

ｉｎ

［

］



，

ａｎ ｇ 

ｅ ｉ
，

Ｆ ｙ ｍ ｅ ａ ， 

ｔ

ｌ ．

ｏ ｏ ｄ  Ｓ ａｆｅ ｔｙ 

ｒａｃ ｅ ａｂ ｉ ｌ ｉ ｔ Ｓ ｙ ｓ ｔｅ



ａ ｓ ｅ ｄｏ ｎ

ｌ ｏ ｃ ｋ ｃ ｈ ａ ｉ ｎ  

Ｅ Ｃ Ｅ Ｅ Ｅ Ａ ａｎ ｄ Ｐ

Ｓ Ｉ

Ｊ ，Ｉ

［］



ｃ ｃ ｅ ｓ ｓ ，  ２ ０ １ ９ ，  ７ ２ ：  ０ ６ ９ ８ － ２ ０ ７ ０ ７ ．  

７ ２  

参考文献





  

Ｍ Ｄ Ｇ Ａ Ｄ ［ ３ ３ ］  Ｐ ｅ ａｒ ｓ ｏ ｎ  Ｓ ９ 

ａｙ 

Ｌ ， 

ｅ ｏ ｎｔｉ ｄ ｉ ｓ

ａ ｅ ， 

ｔ

ｌ  ．

ｒｅ 

ｉ ｓ ｔｒ ｉ ｂ ｕ ｔ ｅ ｄ  Ｌ ｅ ｄ ｇ ｅ ｒ  Ｔｅ ｃ ｈｎ ｏ ｌ ｏ ｇ ｉ ｅ ｓ  ｔｈｅ  

Ｇ Ｆ ｐ ａｎ ａｃ

ｅ ａ  ｆｏ ｒ  ｆｏ ｏ ｄ  ｔｒａ ｃ ｅ ａｂ ｉ ｌ

ｙ ｉ ｔ

？

Ｊ ［］

 ．

ｂ ｏ ｌ

ａｌ

ｏ ｏ ｄＳ ｅｃ ｕｒ ｉ ｔｙ， ２ ０

１

９

２
，

０

：

１

４５ －

１

４９ ．  

３４

［

］

陈西 蒙．

基于 区块链 的供应链交 易 和假货鉴别 的关键技术研究 Ｄ ．

［

］

华 南 理  

工 大 学 ２ ０ ８ １

．  

，

波 溯 实 武 学 李 ３ ５

［

］

基 于 ＳａａＳ 的 商 品
．

源平 台 的研究与

现Ｄ ．

［

］

汉 理工 大

２ ０ ５ １

．

，

物 方 法 华 ３ ６ 朱 国 印 ． 基 于 ＥＰ Ｃ Ｉ Ｓ 的 流 信 息 系 统 开 发

［

］

研究 Ｄ ． 清

［

］

大 学 ２ ０ ４ １

．  

，

３７

［

］

解丹丹．

基于

Ｗｅｂ Ｇ Ｉ Ｓ

的进境动物及其产 品 疫病预警信 息系统研究 Ｄ ．

［

］

浙  

江 大 学 ２ ０ ９ １

．

，

Ｋ Ｂ Ｙ Ｒ ３
［

８

］Ｌ

ｅｎ

ｇ

，

ｉ

Ｌ ，  Ｊ ｉ ｎ ｇ 

ａ ，  ｅ ｔ 

 ｌ ．

ｅ ｓ ｅ ａｒ ｃ ｈ  ｏ ｎ  ａｇｒｉ ｃ ｕ ｌ ｔｕｒ ａ ｌ  ｓ ｕ ｐ ｐ ｌ ｙ  ｃ ｈ ａ ｉ ｎ  ｓ ｙ ｓ ｔ ｅ ｍ  ｗ ｉ ｔｈ  

Ｇ ｄｏ ｕ ｂ

ｌ

ｅ ｃｈ ａｉ

ｎａｒｃ ｈｉｔｅ ｃｔｕｒｅｂ ａｓｅ ｄｏｎｂ

ｌ

ｏ ｃｋｃ ｈ ａｉ ｎ ｔｅ ｃ ｈｎｏ

ｌ

ｏ ｇｙ

Ｊ
［

］

． Ｆｕｔｕｒｅ

ｅ ｎ ｅ ｒ ａｔ ｉ ｏ ｎ  



Ｃ ｏ ｍｐ ｕｔｅ ｒＳ ｙ ｓｔｅｍ ｓ ，２ ０ １

８ ，８ ６ ：６４ １

－６４ ９ ．  

７ ３

北京邮 电大学工学硕士学位论文



  

致 谢  

光 阴 何 太 疾 ， 如 白 驹 过 隙 。 转 眼 之 间 三 年 的 研 宄 生 学 习 生 涯 即 将 结 束 。 在 这  

段时 间里 ，

我在专业知识和人生 阅 历方面都有 了 很大 的进步 。

在 研 究 生 论 文 完 成  

之际 ，

我想对我 的老师 、

同 学和 家人表示感谢 ，

感 谢 他 们 对 我 的 照 顾 和 帮 助 。  

首 先 要 感 谢 我 的 导 师 漆 涛 老 师 和 实 验 室 的 崔 毅 东 老 师 、 雷 友 珣 老 师 和 陈 莉 萍

老 师 三 位 指 导 老 师 。 老 师 的 悉 心 教 导 和 耐 心 指 导 帮 助 我 在 学 业 上 取 得 了 进 步 也 ，

使我面对 问 题时勇 于探索和 思考 。

老师不仅在学 习 上为我们指点迷津 ，

也 对 我 们

的 生 活 非 常 关 心 。 其 次 我 要 对 实 验 室 的 同 学 们 和 我 的 室 友 们 表 示 感 谢 ， 感 谢 大 家

在 学 习 和 生 活 中 互 相 帮 助 ， 共 同 进 步 ， 一 同 经 历 了 难 忘 的 三 年 。  

我还要感谢我 的家人 ，

在我遇到 困 难 的 时候 安抚我 ，

鼓励我 ，

让 我 拥 有 面 对  

困 难 的 勇 气 ， 为 我 提 供 永 远 坚 实 的 后 盾 。  

最 后 ， 感 谢 我 的 母 校 北 京 邮 电 大 学 ， 也 向 各 位 参 与 审 阅 论 文 的 老 师 表 示 我 最  

衷 谢 由

的

意 。  

７ ４  

攻读学位期间 发表的学术论文 目 录



  

攻 读 学 位 期 间 发 表 的 学 术 论 文 目 录  

１ ［］

张皓明 ，

漆涛 ．

基 于 区 块链技 术 的 商 品 溯 源 系 统 的 设 计 与 实 现 ＥＢ／ＯＬ ．

［

］

北 京 ：  

中 国 科 技 论 文 在 线 ２ ２ ０ ０２ ０

０ －

１－

．  

［

］

ｈ ｔｔｐ ： ／／ ｗｗ ｗ ． ｐ ａｐ ｅ ｒ． ｅ ｄ ｕ ． ｃ ｎ／ｒ ｅ ｌ ｅ ａｓ ｅ ｐ ａｐ ｅ ｒ／ ｃ ｏ ｎ ｔ ｅ ｎ ｔ ／ ２ ０ ２ ０ ０ １ － １ ５ ．  

７ ５

