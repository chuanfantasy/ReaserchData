学校代码：10730 分类号：TP301

密级：公开

硕士学位论文
（专业学位）

论文题目（中文）

基于零信任的工业物联网

访问控制技术研究

论文题目（英文） Research on access control technology for

Industrial Internet of Things based on zero trust

作者姓名

杨浩睿

类型领域

电子信息·计算机技术

研究方向

网络空间安全

教育类型

学历教育

指导教师

张瑞生 教授

合作导师

李百成 高级工程师

论文工作时段

2022 年 9 月至 2023 年 3 月

论文答辩日期

2023 年 5 月

校址: 甘肃省兰州市城关区天水南路 222 号

基于零信任的工业物联网访问控制技术研究
中文摘要
随着计算机技术和通信技术的不断发展，物联网在各个行业的生产运转中发 挥着越来越重要的作用，特别是在智能制造方面，工业物联网已成为当今工业界 的一大变革力量。通过将传感器、智能设备和互联网技术结合，工业物联网实现 了工业生产的数字化和智能化，推动了工业的现代化进程，为未来的工业发展带 来更加广阔的前景。工业物联网承载着实时监测、远程控制、生产调度和协同等 重要任务，相较于其他物联网场景，其对数据和控制指令访问的安全性有着更高 的要求，数据泄露或者恶意指令的执行将造成严重的后果。因此，保障工业物联 网的访问控制是当前研究的热点。
传统网络安全模型采用边界安全策略，通过在系统网络边界设置安全设备 以防御外部攻击。但这种模型缺乏持续合法性验证，使得内部网络主体容易受到 内部威胁攻击。同时，传统的访问控制模型通常是预先定义的，无法灵活地控制 不同用户、设备和数据的访问权限，难以适应工业物联网不断变化的访问控制需 求。零信任是下一代安全架构理念，要求通过持续认证和授权来访问网络资源， 并根据信任评估对访问权限进行细粒度访问控制。
为了解决工业物联网内部安全问题，实现对数据和指令的持续性保护，本文 基于零信任思想实现了一种访问控制方案。针对现行访问控制较少关注人为因 素的现状，本文将人为因素纳入信任评估考量指标，并结合环境风险因素，通过 滑动窗口法和时间衰减因子机制进行访问主体的信任评估，随后实现了一种基于 信任属性的动态访问控制模型，并使用安全熵的方法对访问控制模型进行评价。 具体的工作和创新点如下：
1. 本文工作致力于将人为风险因素纳入信任评估的考量指标，以弥补现行零 信任框架较少关注人为因素的缺陷。本文的工作重点关注人的情绪和访问行为， 并通过对比试验优选了实现人脸表情识别和异常流量检测的风险量化模型。
2. 本文提出了一种基于静态属性的正向信任与动态风险属性负向信任相结 合的直接信任评估方法。基于历史评估数据，引入时间衰减因子和滑动窗口机制 对直接信任结果进行修正，实现了更好的信任度量。
3. 本文提出了一种基于信任属性的零信任访问控制模型，并通过 XACML 语 言描述策略，实现了动态的、细粒度的访问控制。此外，本文工作引入安全熵的 概念对访问控制模型的访问控制效果进行了评估。
关键词：零信任，访问控制，人为因素，信任评估，安全熵
I

RESEARCH ON ACCESS CONTROL TECHNOLOGY FOR INDUSTRIAL INTERNET
OF THINGS BASED ON ZERO TRUST
Abstract
With the continuous development of computer technology and communication technology, the Internet of Things (IoT) is playing an increasingly important role in the production and operation of various industries, especially in the ﬁeld of intelligent manufacturing. Industrial IoT has become a major driving force for the current industrial revolution. By combining sensors, smart devices, and Internet technology, industrial IoT realizes the digitization and intelligence of industrial production, promotes the modernization process of industry, and brings broader prospects for future industrial development. Industrial IoT carries out important tasks such as real-time monitoring, remote control, production scheduling, and collaboration. Compared with other IoT scenarios, it has higher requirements for the security of data and control instructions access. Data leakage or malicious instruction execution will cause serious consequences. Therefore, ensuring the access control of industrial IoT is currently a research hotspot.
Traditional network security models adopt boundary security strategies, which set up security devices at the system network boundary to defend against external attacks. However, this model lacks continuous legitimacy veriﬁcation, making internal network entities vulnerable to internal threat attacks. At the same time, traditional access control models are usually predeﬁned and cannot ﬂexibly control the access permissions of different users, devices, and data, making it difﬁcult to adapt to the constantly changing access control requirements of industrial IoT.
"Zero Trust" is the next-generation security architecture concept, which requires continuous authentication and authorization to access network resources, and performs ﬁne-grained access control on access permissions based on trust evaluation.
To solve the internal security issues of industrial IoT and achieve continuous protection of data and instructions, this paper proposes an access control scheme based on the concept of zero trust. In view of the current situation that the existing framework pays less attention to human factors, this paper incorporates human factors into the trust evaluation consideration index, and combines environmental risk factors to evaluate the trust of access subjects through the sliding window method and the time decay factor mechanism. Then, a dynamic access control model based on trust attributes is imple-
II

mented, and the access control model is evaluated using the method of security entropy. The speciﬁc work and innovations of this paper are as follows: 1. This paper
focuses on incorporating human risk factors into the consideration index of trust evaluation to compensate for the shortcomings of the existing zero trust framework that pays less attention to human factors. The work of this paper focuses on human emotions and access behaviors, and selects a risk quantiﬁcation model that implements facial expression recognition and abnormal trafﬁc detection through comparative experiments. 2. This paper proposes a direct trust evaluation method based on the combination of static attribute positive trust and dynamic risk attribute negative trust. Based on historical evaluation data, time decay factors and sliding window mechanisms are introduced to correct the direct trust results, realizing better trust measurement. 3. This paper proposes a zero trust access control model based on trust attributes, and describes policies using the XACML language to achieve dynamic and ﬁne-grained access control. In addition, the concept of security entropy is introduced in this work to evaluate the access control effect of the access control model. Key Words: Zero Trust, Access control, Human factors, Trust evaluation, Security entropy
III

目 录
第一章 绪论...............................................................................................1 1.1 研究目的和意义...............................................................................1 1.2 国内外研究现状...............................................................................5 1.2.1 零信任安全.................................................................................5 1.2.2 访问控制模型.............................................................................6 1.3 本文主要工作...................................................................................8 1.4 本文组织结构...................................................................................8
第二章 相关背景知识和技术基础 ........................................................ 11 2.1 零信任网络安全理念.....................................................................11 2.2 本文用于量化风险的相关技术 ....................................................12 2.2.1 卷积神经网络...........................................................................12 2.2.2 决策树和随机森林...................................................................12 2.3 访问控制技术.................................................................................13 2.3.1 传统的访问控制模型...............................................................14 2.3.2 基于角色的访问控制模型.......................................................14 2.3.3 基于属性的访问控制模型.......................................................15 2.4 动态访问控制方案.........................................................................16 2.5 访问控制效果评价.........................................................................17 2.6 本章小结.........................................................................................18
第三章 一种基于零信任的工业物联网访问控制方案 ........................19 3.1 工业物联网面临的困境.................................................................19 3.2 现有访问控制模型的不足 ............................................................20 3.3 一种基于零信任的访问控制方案 ................................................20 3.3.1 风险识别和量化模型...............................................................20 3.3.2 基于多维度的信任评估模型...................................................21 3.3.3 基于信任评估的零信任访问控制模型 ..................................22 3.3.4 基于安全熵的访问控制模型评价...........................................22 3.4 本章小结.........................................................................................22
第四章 基于机器学习的风险识别和量化研究 ....................................24 4.1 人脸表情识别.................................................................................24 4.1.1 数据集和数据预处理...............................................................24 4.1.2 基于 CNN 的表情识别的方法 ................................................25 4.1.3 实验结果和分析.......................................................................27 4.2 异常流量检测.................................................................................29

4.2.1 数据集和特征选择...................................................................29 4.2.2 基于机器学习的异常流量检测模型.......................................31 4.2.3 实验结果和分析.......................................................................32 4.3 本章小结.........................................................................................33 第五章 基于零信任的访问控制模型 ....................................................35 5.1 基于多维度的信任评估模型 ........................................................35 5.1.1 直接信任评估...........................................................................36 5.1.2 基于时间衰减的综合信任评估...............................................39 5.1.3 仿真实验分析...........................................................................40 5.2 基于信任评估的零信任访问控制模型 ........................................41 5.2.1 基于零信任的访问控制流程...................................................42 5.2.2 基于 XACML 实现动态访问控制 ..........................................43 5.3 基于安全熵的访问控制模型评价 ................................................46 5.3.1 安全熵.......................................................................................47 5.3.2 访问控制评价...........................................................................48 5.3.3 形式化证明...............................................................................49 5.3.4 实验分析和证明.......................................................................50 5.4 本章小结.........................................................................................52 第六章 总结和展望 ................................................................................54 6.1 本文研究工作总结.........................................................................54 6.2 不足和展望.....................................................................................55 参考文献 ................................................................................................... 56

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第一章 绪论
1.1 研究目的和意义
随着无线通信技术的不断进步和国家高质量发展战略的提出，物联网技术与 传统行业结合正成为当今社会各行业的重要发展趋势之一 [1]。物联网实现了不 同的智能设备的互通互联，提升了设备间相互交流协作的效率，为人们的日常生 活、工作、生产等带来诸多便利。当下，物联网技术在制造业、交通运输、医疗 卫生、智能家居、智能电网等领域的应用已经开始发挥重要的作用 [2]。
工业是国家实体经济中不可或缺的组成部分，是实现国家经济发展和现代化 的重要支撑和动力。物联网技术在工业领域的应用为工业发展带来了巨大的发 展机遇，通过工业物联网（Industrial Internet of Things, IIoT）技术，工业系统可 以实现设备的自动化控制和优化管理，完成设备状态的实时监测和设备的远程控 制，一定程度上避免了因为故障造成的生产中断和损失，提高生产过程的可靠性 和稳定性 [3]。同时，通过数据分析和预测技术，工业物联网实现了生产调度的 协同和优化，改良资源配置，从而降低生产成本。这些优点使得工业物联网被广 泛应用在电力、铁路、石油化工、航天航空、制造业等关系国计民生的关键信息 基础设施中。工业物联网的出现推动了工业生产智能化、自动化发展进程，推动 传统的“制造业”向“智能制造业”转型，这不仅实现了积极的经济效益和生产 效益，而且具备着更远大的发展愿景。现代工业物联网的架构如图（1-1）所示：
现代工业物联网的架构通常采用分层架构，包括感知层、现场管理层、网络 层和应用层 [4]。感知层是工业物联网的最底层，由广泛分布于生产现场的传感 器等现场设备和可编程逻辑控制器等控制设备共同组成了现场总线控制网络。感 知层的主要功能是数据采集和自动控制，实现对物理信号的采集，承载较底层的 高速实时控制。现场管理层是本地的调度管理中心，由工业数据库服务器、监控 服务器、文件服务器以及 Web 网络服务器等设备构成的传统工业控制系统组成。 一方面，现场管理层实现了数据记录分析和实时性控制指令的决策。另一方面现 场管理层聚合数据，通过网络层传输信息至应用层，为上层的数据分析和指令决 策提供信息。网络层是连接各种物联设备和工业应用系统的核心层，主要负责数 据的传输和处理，提供稳定、高效、安全的数据传输服务。应用层是工业物联网 的最上层，包括各种应用场景，例如智能电网、智慧工厂等，负责处理工业生产 中各种具体业务需求，通过调用服务层的接口获取数据和分析实现工业生产的管 理、控制和监测。工业物联网各层协同作用，提高了生产过程准确度和精细化程 度，推动了工业生产的智能化、自动化和数字化进程，成为推动工业高质量发展
1

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

图 1-1 工业物联网构成图
的重要力量。 工业物联网在带来积极效益的同时也带来了额外的安全风险 [5]，攻击者对
工业物联网的攻击往往不局限于数据级别，通过攻击工业系统，攻击者可以直接 威胁现实世界中的关键基础设施，造成严重的经济损失，直接影响国家安全和社 会稳定。然而遗憾的是，工业系统似乎没有做好安全准备。在工业物联网概念提 出之前，工业控制系统（Industry control system，ICS）已有较长的应用历史，例 如过程控制系统，并且仍然在工业物联网的运转和功能实现结构中发挥作用 [6]。 大多数 ICS 系统在设计之初主要用于实现自动化 [7]，保证系统的可用性和可靠 性，并且通常采用专用的通信协议，不与企业外部连接，因此较少考虑安全问 题，基于传统 ICS 系统结合物联网技术构建的 IIoT 系统继承了 ICS 内部缺乏安 全设计的缺点 [8]。此外，随着工业系统的复杂化和网络化，工业物联网的应用 在实现了智能工业设备和远程工业管理平台的高效互通互联的同时，也破坏了 传统工业系统由“隔离”和“专用”保障的封闭安全性 [9]。互通互联不但带来 了便捷的交流效率，也使得封闭的物联网系统直接面对外部的新型威胁。边界网 络安全模型 [10] 在过去为工业系统提供了可靠的安全保障，但是高级持续性威 胁（Advanced Persistent Threat，APT）往往可以绕过网络边界，直接攻击缺乏安 全措施的网络内部，基于网络边界的安全措施如防火墙将无法发挥作用，工业物
2

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

联网脆弱的内部将暴露于威胁之下。 近年来，工业系统频繁遭到攻击。2010 年，首个专门针对工业控制系统编
写的病毒震网病毒（Stuxnet）被检测了出来，这款针对工业控制系统的“病毒武 器”直接攻击了伊朗的核设施，深度影响了地缘政治与世界局势 [11]。2014 年， 德国一家钢铁厂的生产系统遭到病毒攻击，整个生产系统在攻击下停止运转，由 于非正常的中止生产，对工厂的设备和生产效益造成了严重破坏。2015 年，乌克 兰的电力系统遭到“BlackEnergy”恶意软件攻击，是世界上首次袭击国家的电力 系统的恶性事件，导致该国数 6 个地区电网运营商失能，数百万人居民停电，给 经济和民生带来了重大影响 [12]。2017 年，全球范围内发生了 WannaCry 勒索软 件攻击事件，影响了 150 多个国家的大约 30 万个企业、政府机构和个人用户，造 成相当数量的机构停转、生产停滞，全球预计损失高达十亿美元 [13]。2019 年， 美国港口设施和航空公司先后遭到 Ryuk 勒索软件和网络攻击，造成港口瘫痪及 航空关键系统关闭。2021 年，美国佛罗里达州水厂发生黑客入侵事件，攻击者试 图提升水中的有害化合物比例对供水给该地区 15000 人的供水系统投毒，险些造 成严重后果。工业系统的生产安全和信息安全作为高价值的攻击目标，具有极其 重要的战略意义。以工业系统为代表关键基础设施已成为地缘政治游戏的新战 场 [14]，针对工业设施的攻击正在以惊人的速度发生，成为一种复杂、持续、极 具破坏性的安全威胁。
工业物联网系统需要建立合适的访问控制模型，确保只有经过授权的可信用 户和设备能够访问系统中的数据和资源，降低潜在的恶意攻击和非授权访问的威 胁。然而，传统的访问控制模型通常基于角色、密级等长期指标静态管理访问权 限 [15]，并且用户一经授权便不在校验，这对于较为简单的或安全性需求不高的 系统和应用来说可能是有效的。工业物联网系统往往包含大量的设备和用户，并 且这些设备和用户可能分布在多个地点，甚至跨越多个组织。在这种情况下，传 统的访问控制模型忽略了工业物联网中不断变化的网络环境和人为因素 [16]，固 定的安全策略和长期有效的访问控制权限是不够灵活和精确的，可能导致严重的 安全问题，传统的访问控制模型并不适用于工业物联网。
人在信息系统中扮演着重要而普遍的角色，但人为因素也是最容易受到攻击 的薄弱环节之一 [17]。当前，攻击者利用钓鱼、社交工程、恶意软件等多种手段 针对人为因素进行攻击，这些攻击手段往往可以绕过传统的技术安全防护措施， 使网络安全形势更加严峻。研究表明，大多数网络安全事故的成因与人为因素有 关，90% 的外部网络攻击的是因为内部用户访问权限的泄露 [18]，攻击者通过恶 意软件、社交工程的方式仿冒、伪装合法身份，入侵内部人员设备，从系统内部 发起攻击。对系统内部人的信任导致的危害后果远远超过广泛传播和感染的蠕

3

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

虫攻击造成的破坏，传统意义上被认为是安全的内部网络实际上充满了威胁。此 外，在工业物联网领域，由于控制指令关乎着生产安全，即使是合法的操作者， 当其处于失常工作状态，也应该被视为潜在的内部攻击者。尽管人为因素是信息 系统安全保护的重要的环节，但是目前缺乏有效的防护手段来防范人为因素对网 络安全的威胁。传统的安全防范技术往往无法对人为因素产生的误操作或故意 攻击进行有效的检测和防范。
工业物联网系统迫切需要采用一种新的安全方案来解决内部威胁和访问控 制的问题。在这方面，零信任思想是一个非常有前途的解决方案。与边界网络安 全方案以实体所处的位置预设信任不同，零信任模型通过实现持续的、严格的身 份验证和授权决策，在不断的验证和授权中建立信任，可以有效地防御内部和外 部威胁 [19]。因此，实现基于零信任思想设计工业物联网的访问控制体系可以提 供对访问实体持续监督和验证，以确保身份的真实性和合法性，实现对数据和指 令的动态的、细粒度访问控制，从而确保工业物联网系统的信息安全和生产安 全。
在当前的零信任模型中，强调对设备、应用程序和网络进行全面的身份验证 和授权，但实际使用中通过验证的用户仍然可能因人为因素产生安全事故 [17]。 比如，一名合法用户因个人情绪波动或个人利益得失，可能会故意或无意地进行 误操作，如意外泄露敏感信息、误删除重要数据等，导致系统安全问题。此外，一 些合法用户可能会出于报复心理，利用其特权访问系统进行攻击，如数据窃取、 恶意指令、拒绝服务等，从而对企业造成严重损失。这些情况都表明，即使在零 信任模型下进行全面身份验证和授权，但人为因素仍然是导致系统事故的因素之 一 [20]。因此，在构建访问控制模型时，本文除了考虑设备、网络环境外，也需 要人工智能和机器学习等技术稳定、高效地识别人为风险因素，将人为风险因素 作为风险评估的指标指导访问控制 [21]，来减少安全风险。
综上，本研究面向工业物联网的应用场景，基于零信任思想，针对传统边界 网络模型无法应对内部威胁的问题，本文提出了一种基于零信任的工业物联网 访问控制模型。相比于其他零信任方案，本文的方案关注人为因素，采用机器学 习技术收集风险因素，结合正向因素计算访问主体可信程度，进一步指导访问控 制。本文的方案实现了动态的、细粒度的访问控制，动态地调整访问策略，符合 工业物联网的安全需求，对保障工业生产系统的数据和指令的安全具有一定的意 义。

4

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

1.2 国内外研究现状
本文提出了一种基于零信任的访问控制方案，涉及零信任安全理念和模型， 基于属性的访问控制技术以及风险因素的识别和量化。因此，本节中将从零信任 和访问控制模型两个方面对国内外相关研究现状进行回顾和分析。
1.2.1 零信任安全
零信任思想强调不预设信任，实施严格的身份验证和授权以保护网络和数据 安全。2010 年，John Kindervag [22] 提出了零信任模型的理念，认为传统的边界 安全已经不再适用，企业需要对所有网络访问点进行身份验证和授权，将安全性 从企业的边界扩展到网络内部，并提出了一种基于数据采集网络的零信任架构， 通过将网络数据提取到管理中心，实现对环境的检查和分析，从而实现了零信任 的概念。
随后 2017 年，Gartner 提出了持续自适应风险与信任评估（Continuous Adaptive Risk and Trust Assessment, CARTA）零信任体系 [23]，CARTA 强调安全评估 应该是一个持续的、自适应的过程，在风险评估的基础上，动态地根据信任度和 风险情况，为不同的用户和设备提供不同程度的访问权限。2018 年，Forrester 发 表了一种推荐的零信任扩展模型，该模型从五个维度扩展了零信任模型：工作负 载、网络、数据、应用程序和用户，在每个维度上，报告提出了具体的技术控制 和实现方式，并提供了案例和建议，扩展了传统零信任模型的范围。2020 年，美 国国家标准技术研究所（NIST）正式发布了《零信任架构》标准，该标准提出了 一种推荐的基于风险管理的安全架构，旨在通过逐步减少信任并增加验证和授权 控制，防止网络攻击和数据泄露。
除了相关行业规范和实践标准的研究，零信任也取得了一定的实践研究成 果。2016 年，DeCusatis [24] 等人提出了一种基于传输的访问控制的零信任方法。 该方法基于数据包请求中嵌入认证令牌的隐写覆盖，以及首包认证实现零信任的 概念，可以在企业计算和云环境中提供更好的安全性，并防止对受保护资源进行 不必要的指纹识别。同年，谷歌在其 GSuite 平台上推出了 BeyondCorp 访问控制 产品，采用基于用户身份、设备健康状况、应用程序安全等多个维度的访问控制 策略，实现了用户对企业应用和数据的更加便捷、安全的访问，随后扩展到了其 他的云产品中。2020 年，Dimitrakos [25] 提出了一种消费者物联网下的零信任感 知持续授权技术的体系结构和原型实现，并介绍了该模型在消费者物联网零信任 体系结构中的应用。同年，Sultana [26] 等人提出了一种基于零信任原则和区块 链技术的安全医疗图像共享系统。该系统将零信任与区块链相结合，全面保护医 疗数据。2021 年，Ramezanpour [27] 提出了一种使用人工智能构建零信任架构想

5

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

法，该架构将人工智能与传统的零信任架构中的 PEP 和 PDP 相结合，提供了一 种 5G/6G 网络非可信环境下的网络保障需要对网络资产进行动态授权、风险评 估和监控的方案。同年，Tian 等人 [28] 提出了一种基于 BLP 和 BIBA 模型的零 信任方法，该方法对用户、终端、通道、文件和应用程序等系统组件进行综合信 任评分，以实现对对象更好的机密性和整体性保护。但没有考虑用户、终端、环 境、对象和其他实体的科学权重分配方法，无法有效避免信任建立时的人为因素 错误，权重分配的完整性和合理性有待进一步研究。
近年来，我国的产学研机构和研究者们也为零信任的发展做出了贡献。2017 年，荣钰 [29] 等人采用微隔离技术，结合软件定义数据中心、虚拟化网络，实现 了零信任框架在云计算环境的应用，解决了云计算系统内部安全问题。2018 年， 靳起朝 [30] 等人为边缘计算的接入安全构建了零信任防护体系，实现了边缘设 备的可信控制。2019 年，腾讯联合中国移动设计院等产学研机构立项《零信任安 全技术参考框架》行业标准，推进国内的零信任研究工作，并于 2021 年在中国 通信标准化协会获批。2020 年，奇安信公司牵头在全国信息安全技术标准化委 员（TC260）申请的《信息安全技术零信任参考体系架构》标准在 WG4 工作组 立项。2021 年，工信部出台《网络安全产业高质量发展三年行动计划 (2021-2023 年)》提出要创新发展以零信任为代表的安全技术，加快开展零信任安全体系研 发。
随着零信任理念、标准和科学研究的发展，零信任安全模型展现出了充分的 优越性，被认为是下一代的安全架构，零信任的重要发展事件如图所示:
1.2.2 访问控制模型
访问控制技术是防范数据泄露和违规操作的重要举措，主要任务是保证资源 不会被非法访问，进而不会被非法使用。
访问控制技术兴起于 20 世纪 70 年代，最初是为了解决系统资源授权访问 的问题。根据访问控制策略的差异，早期的访问控制模型主要由自主访问控制 （Discretionary Access Control, DAC）和强制访问控制（Mandatory Access Control, MAC）构成。随着安全需求的提高和访问控制技术的不断发展，出现了许多新的访 问控制模型和技术，如基于角色的访问控制（Role-Based Access Control, RBAC）、 基于属性的访问控制（Attribute-Based Access Control, ABAC）等。这些访问控制 模型和技术弥补了早期模型的不足，提供了更加细粒度、灵活和强制执行的访问 控制机制，也更加适应了现代信息系统对安全性和管理性的要求。同时，各种标 准和规范文件也相继出现，如 ISO/IEC 27001、NIST SP 800-53 等，为访问控制 技术的规范化和标准化提供了支持。

6

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

图 1-2 零信任发展趋势
经过研究的深入，学术界逐渐意识到，固定的安全策略和长期有效的权限已 经不再足够灵活和精确。因此，越来越多的研究开始关注基于动态信息指导的访 问控制。部分学者开始将信任模型与主流的访问控制模式结合，以达到更好的访 问控制效果。
Chakraborty 等人 [31] 在 RBAC 模型的基础上提出了 TrustBAC 模型，该模型 先计算用户的信任值，再根据信任值决定用户是否能够获得对应角色的权限。相 较于 RBAC 模型，TrustBAC 模型克服了动态性和监管性不足等缺点，能够动态 地进行角色分配。然而，刘武 [32] 等人指出，TrustBAC 模型存在漏洞，即不考 虑各个权限对用户信任值的不同需求，从而为恶意用户积累信任值绕过访问控制 的机会。为此，刘武团队提出了一种基于信任的访问控制模型 TRBAC，从权限 对用户的具体要求出发，综合计算用户的多种信任特征，能在更细的粒度上实现 对访问控制。邓三军 [33] 等人提出了一种基于信任度和属性的物联网访问控制 模型 TARBAC。该模型建立了用户属性集，并通过监测用户信任度值的变化动态 调整用户的访问权限，从而确保了访问控制机制的稳定和安全运行。
尽管上述研究在访问控制模型方面取得了积极的探索成果，通过综合计算多 种特征，评估访问主体的信任并指导访问控制过程，但是上述研究人为风险因素 关注和访问控制细粒度上均存在继续改进的空间，因此，如何进一步细化访问控 制，以及如何提高访问控制的信任评估数据来源，需要进一步研究。
7

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

1.3 本文主要工作
本文针对工业物联网系统无法应对日益严重的内外威胁的现状，结合零信任 安全理念，提出了一种基于信任属性的访问控制方案。本方案包括基于人工智能 的风险因子收集和量化，信任评估模型和访问控制模型三部分，风险因子的收集 和量化为信任评估提供了可靠的依据，指导系统实现了实时的、细粒度的访问控 制。此外，本文通过引入安全熵的概念，提出了对访问控制模型的评价方法，通 过形式化数学证明论证了评价方法的实用性，在可用性和安全性两个维度对访问 模型进行了科学的评价，进一步指导访问控制过程，证明了本文提出的访问控制 方案的安全性，可用性和先进性。
具体研究内容和成果如下： 1. 基于现行零信任框架较少关注人为因素的现状，本文工作关注人为风险因 素，将人为因素纳入信任评估的考量指标，重点关注人的情绪和人的访问行为， 进一步指导信任评估过程。通过对比试验，优选可以实现人脸表情识别和异常流 量检测的风险收集和量化模型。 2. 提出了一种基于静态属性正向信任和动态风险属性负向信任相结合的直 接信任评估方法，并基于历史评估数据通过引入时间衰减因子和滑动窗口机制对 直接信任结果进行修正，通过综合信任值实现更好的信任度量和信任管理。 3. 提出了一种基于信任属性的零信任访问控制模型，并通过 XACML 语言描 述策略，实现了动态的、细粒度的访问控制。此外，通过安全熵的概念对访问控 制模型的访问控制效果进行评估，并通过指导阈值方式优化访问控制过程。

1.4 本文组织结构
本文共包含六个章节，主要内容如图（1-3）所示，各章内容安排如下： 第一章是绪论，该章节首先阐述了工业物联网面临的安全需求和边界网络安 全模型无法抵抗日益严峻的安全威胁的背景，并在此基础上阐述了零信任安全的 研究意义和应用价值，随后针对该领域的国内外研究现状进行了讨论，并介绍了 本文的主要工作和结构安排。 第二章为相关背景知识和技术技术，该章节讲述了零信任的研究、政策和产 品，随后介绍了作为信任评估依据的风险因子收集量化模型的理论基础，最后介 绍访问控制技术以及评价访问控制技术的方法。 第三章为一种基于零信任的访问控制方案设计，该章节提出了一种基于零信 任理念设计的访问控制方案，分为四个主要部分。首先是对访问过程风险因子的 收集和量化，该部分选取人脸表情识别和异常流量检测识别实现。随后方案基于

8

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

系统固有的正向因素和动态的负向因素，结合历史评估记录，实现访问主体的综 合信任评估。进一步的，方案基于信任评估结果实现动态的访问控制。最后，通 过安全熵的概念对系统访问控制效果进行可用性和安全性评价。
第四章为基于机器学习的风险识别和量化研究，该章节分两部分，对应第三 章节的风险因子的收集和量化部分。第一部分基于 Fer2013Plus 数据集设计了一 种使用小卷积核的 CNN，进行了人脸表情识别模型的开发，展示了 loss 和验证 集 acc 随训练 epoch 过程变化的图像，随后分析了该设计 CNN 的混淆矩阵，最后 给出了模型对比，并展示了推理效果。第二部分使用 CICIDS2017 数据集进行异 常流量检测模型构建，根据数据集特点，参考前人的工作进行特征缩减随后进行 样本均衡操作，基于预处理后的数据集使用朴素贝叶斯、逻辑回归、深度神经网 络、K 近邻、支持向量机、随机森林等分类算法进行训练和对比，分析了六种模 型在数据集上的表现，选择 RF 作为推理模型并展示了混淆矩阵和推理效果。该 章节为信任评估提供了可靠的数据来源。
第五章为基于零信任的访问控制模型，该章节分三部分，对应第三章节的信 任评估、访问控制和访问控制评价。第一部分通过正向因素和负向因素计算直接 信任，引入时间衰减因子和滑动窗口实现了综合信任的评估。第二部分基于信任 属性进行零信任访问控制，并使用 XACML 语言描述了访问策略。第三部分使用 安全熵进行访问控制模型安全性和可用性的评价，指导访问控制策略调整。
第六章为总结与展望，对全文的工作内容进行概述，分析其中的不足与缺陷 并提出了对未来研究工作的展望。

9

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

图 1-3 本文主要成果和组织架构
10

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第二章 相关背景知识和技术基础
2.1 零信任网络安全理念
现有的通用零信任网络架构如图（2-1）所示：

图 2-1 通用零信任网络架构图
零信任思想是一种新兴的网络安全理念，零信任理念不预设信任，将访问主 体所处的外部网络和内部网络环境都视为充满威胁 [34]。这种理念以访问主体的 统一认证、授权和持续的校验为基础，以资源保护为重心，可以弥补传统边界安 全模型的不足。根据《零信任网络: 在不可信网络中构建安全系统》[35]，零信任 思想建立在以下五个假定之上：
• 网络无时无刻不处于危险的环境中 • 网络中自始至终存在外部或内部威胁 • 网络的位置不足以决定网络的可信程度 • 所有的设备、用户和网络流量都应当经过认证和授权 • 安全策略必须是动态的，并基于尽可能多的数据源计算而来 零信任正处于快速发展的阶段，关于零信任虽然目前尚没有统一的定义，但 是已经有权威机构给出了建议的实施方式。美国国家标准与技术研究院（NIST） 发布了一份零信任指南 [36]，旨在帮助组织实施零信任安全策略。该指南提供了 一种基于身份、设备、位置和环境等因素进行动态访问控制的方法，以确保只有 经过身份验证的用户、设备和应用程序才能访问敏感资源。NIST 建议采用的零 信任模型不再将安全重点放在网络边界上，而是将安全性纳入整个网络生态系 统，从而更好地保护企业网络。NIST 零信任指南提出了五个核心原则：
11

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

• 验证所有设备和用户的身份 • 基于设备健康状况和安全策略授权访问 • 采用最小特权原则限制用户访问权限 • 监控所有网络活动并及时检测和应对安全事件权 • 采用动态策略实时响应安全事件 这些原则可以帮助组织建立细粒度的访问控制和身份验证机制，减少潜在的 攻击面，并提高网络安全性。同时，NIST 也提供了一些实现零信任模型的最佳 实践，如网络分割、数据加密、安全分析和事件响应等方面。实现零信任的核心 技术包括身份认证，访问控制技术和人工智能技术等。零信任是适合用于防护当 前边界日益模糊的网络，拥有广泛的应用前景。

2.2 本文用于量化风险的相关技术
2.2.1 卷积神经网络
Convolutional Neural Network（卷积神经网络，CNN）是一种前馈神经网络， 主要用于处理具有网格状结构的数据，例如图像、声音、文本等。相较于传统神 经网络，CNN 拥有卷积层、池化层和全连接层等特殊的层次结构 [37]，以便更好 地提取输入数据的特征，从而达到更高的准确率和泛化能力。CNN 通过学习多 个卷积核（Convolutional Kernel）的权重，从而能够有效地提取图像或声音等数 据中的特征，进而实现对这些数据的分类或识别等任务。如图（2-2）所示 CNN 的基本构成包括卷积层、池化层和全连接层。卷积层是 CNN 的核心组成部分， 它在输入数据上滑动卷积核并执行卷积运算，以提取输入数据中的局部特征。每 个卷积层由多个卷积核组成，每个卷积核对应一个特征。池化层用于降低数据的 维度，减少参数数量，提高模型的鲁棒性。常见的池化方式有最大池化和平均池 化。全连接层将所有卷积层和池化层的输出连接到一起，对提取的特征进行分类 或预测。CNN 具有自动学习特征、可共享权重、可扩展性强等优势，并且在图 像、语音、自然语言处理、医学影像、自动驾驶、智能安防、舆情分析等领域得 到了广泛应用，CNN 已经成为现代人工智能技术的重要组成部分，因此，本文 采用了 CNN 实现对人为因素中最为关键的人脸表情进行识别，为实现风险评估， 进一步指导访问控制提供了有力的支持。
2.2.2 决策树和随机森林
决策树是常用的机器学习算法，用于分类和回归问题。其基本思想是通过对 数据进行分裂，构建一个树形结构，对数据进行分类或预测。决策树的构建过程

12

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

卷积层

池化层

卷积层

池化层

图 2-2 卷积神经网络示意图

全连接层

通常分为三个步骤：选择属性、分裂节点和递归构建子树。选择属性的过程是找 到对数据分类或预测最具有判别能力的特征或属性。常用的方法有信息增益、信 息增益比和基尼指数。分裂节点的过程是将数据集根据选择的属性进行分割，让 每个分支中包含的数据属于同一类别或有着相同的预测结果。递归构建子树的 过程是对每个子数据集递归地构建出更小的子树，直到达到某个终止条件，例如 数据集中所有样本都属于同一类别，或者已经没有更多的属性可以用于分割数据 集。
随机森林是一种集成学习算法，由多个决策树组成。每个决策树都基于一个 随机子集的数据和属性来构建，以避免过拟合。随机森林通过聚合多个决策树的 预测结果，以降低预测误差，提高模型的泛化能力。在分类问题中，随机森林采 用投票的方式来决定最终的分类结果；在回归问题中，随机森林采用平均值的方 式来得到预测结果。随机森林由多个决策树组成，可以有效地降低过拟合的风 险，擅长处理高维度数据，训练过程中可以评估特征的重要性，有助于理解数据 中的关键特质。因此，本文使用了随机森林算法实现了对网络异常流量的检测， 为实现风险评估，进一步指导访问控制提供了有力的支持。

2.3 访问控制技术
访问控制本质上是策略 (policy）和机制 (mechanism）的集合，其过程的三个 要素是主体、客体和访问策略。访问控制技术是防范数据泄露和违规操作的重要 举措，可以限制访问主体（主动的实体，如用户、进程、服务等）对访问客体（受 保护的资源集合）的使用权限，使系统限定资源在合法范围内授权使用，主要任 务是保证资源不会被非法访问，进而不会被非法使用。访问控制技术经过多年的 演进, 已经产生了多种类型的访问控制模型, 包括自主访问控制、强制访问控制、 基于角色的访问控制、基于属性的访问控制。本小节将对这些主流访问控制模型 进行介绍，并阐述其原理和应用场景。

13

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

2.3.1 传统的访问控制模型
早在 1985 年，可信计算机系统评估准则 TCSEC [38] 描述了两类基础的访问 控制模型：自主访问控制（DAC）和强制访问控制 (MAC)。
DAC 的核心思想是用户自主授权，允许文件或资源的所有者决定访问文件 或资源的权限以及访问方式。DAC 易于理解和实现，被广泛运用于 UNIX 类操作 系统等多用户环境中。随后，根据不同自由度的需要，出现了自主授权和安全管 理员管理相结合的半自主访问控制 HRU 模型和基于访问控制列表的 ACL 模型。 由于自主管理的原因，以 DAC 为核心设计的访问控制容易出现权限滥用，并且 难以集中管理和审计，同时无法解决间接访问带来的安全问题。因此，DAC 模 型适合于那些需要灵活性和用户自主性的场景，通常用于个人电脑或小型团队的 环境中，其中文件或资源的所有者有完全的控制权，并且管理员不需要集中管理 访问控制。
出于对安全性的更高需求，MAC 取消了访问主体的自主分配权限能力，使 用统一的管理员为主体和客体分配安全属性，并通过比对主体客体间的安全属 性关系来进行访问授权，具有强制安全性。MAC 主要的模型有 Bell-LaPadula 模 型 [39]（BLP）和 Lattice 模型 [40]。BLP 是第一个提供多级安全（分级数据安全 性保障）的安全策略模型，该模型以敏感度为系统资源划分安全级别，并为用户 分配安全级别，总体分为公开、受限、秘密、机密、高密 5 个安全等级。BLP 模 型中数据的访问严格遵循上读下写来保障数据的机密性，即主体不能读取密级高 于自身密级的数据，不能写入密级比自己低的数据。Lattice 模型在 BLP 模型上 读下写基础上发展了安全集束概念，对其进行了多边安全体系下的扩充。主体和 客体访问时不仅要比较密级的关系，还要考虑所在的安全集束，不同集束间的密 级不具有可比性。强制访问控制规定了信息的流动方向，使用预定义的安全信息 保障了访问的安全性，但是该方法也严重依赖预定义的安全信息，功能单一缺乏 灵活性，易用性较差，无法适应变化的组织结构和安全需求。因此，MAC 模型 适合需要高度保密性和安全性的场景，特别是政府、军事等应用场景。随着环境 复杂度的提高和安全性需求的不断更迭，两种传统的访问控制模型已经难以满足 当今的需求。
2.3.2 基于角色的访问控制模型
RBAC 技术由于其可以很好的处理角色和层次化管理，目前被广泛运用于大 型可拓展系统的安全管理。RBAC 技术的核心思想是通过在用户之上抽象出角色 的概念，用户与一个或多个角色产生关联，角色与一个或多个访问权限相关联， 将访问控制的实体和资源组织成角色和权限的组合，从而方便进行权限管理和访

14

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

问控制。在不断的需求更迭下，RBAC 模型取得了一定的发展, 大体上分为 4 种 类型。基本的 RBAC 模型指明了用户、角色、访问权限和会话的关系，用户通过 角色获得权限，一个用户可以获得多个角色，一个角色也可以向多个用户分配。 进一步发展的层次 RBAC 模型规定了角色等级划分，实现了偏序继承，上层角 色可以基础下层角色的访问权。随后出现的约束 RBAC 模型对基础的 RBAC 模 型的元素进行约束检查，只有具有有效值的元素才可被系统接受。最后，层次约 束的 RBAC 模型集成了上述模型的优点，以角色作为访问控制的主体，并将最 小权限原则、职责分离等优秀设计理念融入设计，与传统的 MAC 和 DAC 相比， RBAC 模型更好的安全性和灵活性，具有较好的应用场景。但是 RBAC 模型将管 理权限分散给了角色，可能会存在角色授权的失误或不当，或者出现角色爆炸问 题，从而增加了整个系统的风险。
2.3.3 基于属性的访问控制模型
基于属性的访问控制模型（ABAC）提供了一种基于属性的方法来适应广泛、 多样的访问控制策略，并简化了访问控制管理。

图 2-3 基于属性的访问控制
如图（2-3）所示，ABAC 引擎的访问控制逻辑根据请求用户、资源和环境的 属性以及用这些属性表示的策略，允许或拒绝主体对客体所请求的操作。ABAC 的策略可以表示为基于多种不同属性的复杂的布尔运算，例如用户、资源、操作、 时间、地点等属性来描述访问请求。基于 ABAC 的访问控制框架通常包括策略 决策点（PDP）、策略执行点（PEP）、策略管理点（PAP）和策略信息点（PIP）等 功能来控制访问，执行阶段。当系统收到访问请求后，先由 PEP 请求主客体以及 环境属性，并依据请求结果构建基于属性的访问请求将其发送给 PDP 中。根据 属性，PDP 对请求结果做出判定，再与 PAP 进行交互，查找对应的访问控制策
15

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

略，决定是否允许授权，最终 PEP 执行判定结果。由于属性是动态的，ABAC 模 型可以在运行时根据不同情况下的属性集合来动态地确定是否允许访问，这种方 式为管理员提供了更大的灵活性和控制权，同时也使得访问控制更加细粒度化和 精确化。因此，ABAC 模型能够有效地解决在大规模和复杂的环境中出现的访问 控制问题，例如物联网等领域。由于策略管理和权限判定分离，管理员可以根据 不同的情况来定义不同的策略，而访问控制系统可以根据实时的属性值来决定是 否授权访问。这使得 ABAC 模型成为一种灵活、可扩展和高效的访问控制模型。

2.4 动态访问控制方案
可扩展访问控制标记语言（XACML）和下一代访问控制（NGAC）支持并 实现 ABAC 模型，是两种常见的动态访问控制方案。XACML 通过使用涉及属性 的逻辑公式来定义策略，而 NGAC 则使用涉及关系配置的枚举。
XACML 模型 [41] 使用规则、策略、基于规则和策略的组合算法、属性（主 体、资源或客体、操作和环境条件）、职责和建议等元素。它的参考体系结构包 括策略决策点（PDP）、策略执行点（PEP）、策略管理点（PAP）和策略信息点 （PIP）等功能来控制访问。一种典型的流程是主体向管理受保护资源的 PEP 提出 请求。PEP 为使用 XACML 请求语言制定这种请求。然后，PEP 将 XACML 请求 一直发送到 PDP，PDP 存储用 XACML 策略语言编写的用户唯一访问控制策略。 PDP 用其 XACML 策略评估请求，并确定 XACML 请求是否应该被批准或拒绝。 最后，PDP 在 XACML 反应语言，并将其发送给执行决策的 PEP。XACML 流程 如图（2-4）所示

图 2-4 XACML
NGAC 可以根据用户的属性、上下文环境等因素进行访问控制决策。NGAC 在表示访问请求，表达和管理策略与属性，以及计算和执行决策方面采取了与 XACML 完全不同的方法。NGAC 通过一组标准化的、通用的关系（Relation）和
16

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

功能（Function）来定义访问控制，这些关系和功能在策略的表达和执行中是可 重用的，NGAC 采用了一种基于多级授权的访问流程，保证了访问决策的准确性 和安全性。
NGAC 的流程和 XACML 流程类似：PEP 捕获应用程序的访问请求，包括进 程 id、用户 id、操作以及该操作涉及的数据资源或访问控制数据元素和关系。为 确定是否准许当前要执行的访问操作，PEP 将访问请求提交给 PDP。PDP 通过 PAP 基于存储在 PIP 中的数据元素和关系的当前配置（即策略）来计算决策。通 过 XACML 和 NGAC 可以实现动态访问控制方案的落地。

2.5 访问控制效果评价

熵是信息论中的一个概念，由克劳德·香农于 1948 年提出。它是对系统的

信息量的度量，表示系统的不确定性和随机性，即系统中各个可能状态的概率分

布的混乱程度。熵的概念广泛应用于通信、密码学、数据压缩等领域，是信息科

学中非常重要的概念之一。

对于离散型随机变量 X，其值域集合为 A：ai(i = 1, 2, · · · , q),q 为变量符号集 的个数，事件 ai 发生的概率为 p(ai), 其概率分布空间可表示为：







 X  =  a1

a2 · · · (aq ) 

P(x)

p (a1) p (a2) · · · p aq

该离散随机变量 X 的信息熵即为：

q
H(X) = − ∑ p (ai) log p (ai) i=1

(2-1)

其中，事件的概率 p(ai) ≥ 0, (i = 1, 2, · · · , q) 且事件的概率之和 ∑iq=1 p(ai) = 1 公式 (2-1) 所示的香农熵是纯粹基于概率的函数，不考虑系统的客观价值因素。
在访问控制模型中，熵也可以用于评价模型的安全性和可用性。穷举访问控 制模型的响应结果事件集合 Aai(i = 1, 2, · · · , q)，每种响应结果的信息量同理视为 I(a) = −log(P(a))，则此时的熵可以评价访问控制系统的稳定性，其熵越高，其 混乱程度和不确定性就越大，访问控制系统就越不稳定。相反，如果熵越低，其 混乱程度和不确定性就越小，访问控制系统就越稳定。此外，在访问控制场景中， 各种随机事件的发生对系统的具有不同的影响和结果。比如系统授权了受信任 用户访问目标资源，或者系统拒绝了风险用户访问目标资源，这类事件的发生是 正确的、符合访问控制预期的，这类事件不会对系统可用性和安全性的评价产生

17

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

负面影响。反之，如果系统拒绝了信任用户的访问的事件是典型的可用性缺陷， 需要重点关注，纳入对系统的评价。因此，为了将客观价值和模型评估主观因素 纳入信息度量中，需要对香农熵进行扩展，加权。

2.6 本章小结
本章介绍了本文所提出的基于零信任的工业物联网访问控制系统所涉及的 概念和背景知识。首先对零信任安全理念进行了阐述，随后介绍了基于人工智能 的风险因子提取和量化技术，之后介绍了现有的访问控制技术，最后介绍了访问 控制评价的熵的概念和原理。

18

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第三章 一种基于零信任的工业物联网访问控制方案
工业物联网作为智能化、自动化工业生产中不可或缺的基础设施，承担着实 时监测、远程控制和生产调度等重要任务，对工业系统具有重要意义。相比其他 物联网场景，工业物联网对数据和控制指令的安全性要求更加严格。
本章针对工业物联网转型面临的 IT 和 OT 系统融合带来的安全困境，基于 零信任思想，提出了一种基于机器学习的风险因子识别和量化、对访问主体进行 信任评估，最终实现细粒度访问控制的方案。该访问控制方案基于访问主体、访 问客体和访问行为属性动态计算，能够有效地应对工业物联网场景下的安全问 题，提高了数据和指令的安全性。
3.1 工业物联网面临的困境
工业物联网通过物联网技术和传感器等设备实现生产设备和信息系统等之 间互联互通，移动办公、远程协同等功能提高了工业系统的运转效率，实现了企 业信息技术系统（IT）和工业生产的操作技术系统（OT）的集成和融合 [42]。然 而由于两种系统存在在目的、用途等层面的差异，传统的 IT 安全措施并不适用 于工业物联网系统，而传统的物联网防护系统在应对“无边界”发展趋势带来的 威胁时也越来越显得捉襟见肘。具体体系在以下几个方面：
• 预设信任问题：现行的工业物联网的安全基于边界网络安全模型，通过防 火墙等边界网络设备将系统分为安全的内网和威胁的外网，对进行系统进 行安全保护，并默认内外比外网更加安全。但是这种方式存在缺陷，对内 网预设的信任容易导致系统对内部安全管理的忽视。
• 系统暴露面增多: 企业信息技术系统（IT）和工业生产的操作技术系统（OT） 的集成和融合，让系统间的网络边界变得模糊，工程师不仅可以在现场的工 程师站实现数据获取、执行控制指令，也可以通过暴露于外部环境的 VPN、 堡垒机等手段进行远程访问，一旦攻击者攻破这些途径，就相当于边界防 护设备失效，系统脆弱的内部将直接暴露于威胁之下。
• 边界安全细粒度问题：访问主体在网络边界进行单次的身份认证便可获得 系统的访问控制权限，这种基于边界的校验忽略了工业物联网中不断变化 的网络环境和人为因素，一旦通过认证便不再校验，只会下一次访问主体 通过边界时才重新评估，这样的粗粒度的方式无法及时感知、制止访问主 体的风险意图和风险行为，对于通过边界校验，正在发生的不当操作或风

19

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

险缺乏关注，不够灵活和精确，即使访问主体已经出现不适用访问敏感资 源和指令的情况，访问控制系统仍然不会介入访问控制过程，无法做到细 粒度的资源访问控制，存在安全隐患。

3.2 现有访问控制模型的不足
传统的访问控制模型通常基于角色、密级等长期指标静态管理访问权限，并 且用户一经授权便不再校验，这对于较为简单或安全性需求不高的系统和应用可 能是有效的。然而，随着互联网和物联网技术的快速发展，访问控制面临着越来 越复杂的网络环境和人为因素的挑战。固定的安全策略和长期有效的访问控制 权限已经不再足够灵活和精确，这可能导致严重的安全问题。工业物联网系统通 常包含大量的设备和用户，这些设备和用户可能分布在多个地点，甚至跨越多个 组织，因此需要建立适合其复杂环境的访问控制模型。
近年来，学术界开始关注基于动态信息指导的访问控制，将信任模型与主流 的访问控制模式结合，以达到更好的访问控制效果。因此，将人为风险因素加入 信任评估，进一步指导访问控制的设计中，可以及灵活调整访问权限以适应不同 的场景和需求，将有助于提高访问控制的效率和安全性。

3.3 一种基于零信任的访问控制方案
针对前文所述的工业物联网面临的困境，和现有访问控制方案无法满足安全 需求的现状，基于零信任理念，本文提出了一种基于零信任的工业物联网访问控 制方案。本方案主要由风险识别和量化模型、基于多维度的信任评估模型、基于 信任评估的零信任访问控制模型和基于安全熵的访问控制模型评价四部分组成。 如图（3-1）所示。其中，风险识别和量化模型收集量化访问主体的多元风险因 素，是信任评估进一步实现对访问主体性质判定的重要基础；基于多维度的信任 评估模型使用量化的风险因素结合用户正向信任因素，判断访问主体性质，是访 问控制过程的重要依据；访问控制系统决定用户对数据和指令的访问，访问控制 效果直接关系系统的安全性和可用性，是保障系统资源安全的重要部分；基于安 全熵的访问控制模型评价对访问控制系统进行效果评价，是访问控制系统效果鉴 定和优化的重要环节。
3.3.1 风险识别和量化模型
根据 Gilman 在《零信任网络: 在不可信网络中构建安全系统》一书中提出 的观点，零信任的安全策略必须是动态的并基于尽可能多的数据源计算 [35]。如

20

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

Gilman 所述，对于工业数据和指令的访问场景，固定的访问控制策略和长期有 效的访问权限是粗粒度的、不够精确的，而实现动态的访问控制策略需要考虑系 统中不断变化的网络环境和人为因素，并基于其变化的属性值进行动态的计算和 判断。因此，本模块基于机器学习算法对多种风险因子进行识别和量化，并选出 具有最优效果的算法模型，为访问主体信任评估模型提供数值依据。包括信任评 估风险属性选取和信任评估风险属性的量化，在本节中，我们选择异常表情识别 和异常流量识别两方面进行模型训练和优选。
3.3.2 基于多维度的信任评估模型
零信任安全模型中的信任算法是至关重要的，信任模型不仅可以帮助系统识 别未经授权的恶意访问主体，还可以指导必要的安全策略来保护组织的敏感数据 和资源。信任算法的评估过程是动态，持续的，因此可以实时的识别访问主体的 风险状况和风险行为，根据评估结果进行及时的介入措施，提高系统策略的灵活 性和响应速度，帮助组织更好地应对网络环境的复杂性和变化性。
直接信任值计算
直接信任计算是一种衡量访问主体在访问时刻安全程度的指标，通过多维度 的信任评估模型，结合正向因素（用户身份、设备安全状态、访问环境安全性等） 和负向因素（风险因素等），计算访问主体的直接信任值，以实现更准确、更可 靠的直接信任评估。在此基础上，提出了直接信任评估函数：DT = PF * NF，其 中 PF 是正向因素的评估函数，NF 是负向因素的评估函数，当系统检测到访问请 求存在较高的风险因素时，将会对访问主体的信任值产生较大的负面影响，降低 其访问资源或服务的可信程度。同时，正向因素表达函数 PF 的值也会被放缩矫 正，以更准确地反映访问主体的实际可信程度。基于正向因素和负向因素的信任 评估，可以更准确、更可靠地评估访问主体的直接信任值，以判断其是否有资格 获得所请求的资源或服务。
间接信任值计算
综合信任计算是一种综合考虑历史数据和当前情况的信任评估方法。在信任 评估中，历史数据虽然具有参考价值，但由于时间的推移和环境的变化，之前建 立的信任的参考价值可能会逐渐减弱。因此，在综合信任计算中，引入了基于时 间差的衰减因子，使得较早时期的历史数据在信任评估中具有较小的影响力，而 较近时期的历史数据在信任评估中具有更高的权重，以提高信任评估的准确性和 可靠性。综合信任计算函数的设计采用了滑动窗口法，并且考虑了直接信任评估 衰减系数的影响，综合考虑了历史数据和当前情况，更可靠地评估访问主体的的

21

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

综合信任值。
3.3.3 基于信任评估的零信任访问控制模型
基于信任评估的零信任访问控制模型使用 XACML 语言定义策略规范和参 考体系结构，并基于信任阈值和其他主体属性进行访问控制策略描述。XACML 访问请求包括主体、资源、操作和环境属性，属性以键值对形式定义，其中属性 名表示与主体、资源、操作或环境相关联的属性或特征。在访问请求被转换为 XACML 形式后，策略判定点会在策略库进行策略匹配，并根据信任属性和其他 属性做出访问决策。XACML 支持基于属性的访问控制，通过这种方式，访问控 制模型可以根据请求的实时信任特征决策，并能够动态地适应访问主体的属性 变化，实现了细粒度的访问控制。该模型可以实现动态的、精确的零信任访问控 制，提供了可靠的支持。
3.3.4 基于安全熵的访问控制模型评价
本文工作使用安全熵概念对访问控制模型进行了可用性和安全性度量，通过 熵值的大小来反映不同模型的安全性和可用性。实验结果表明，该评价方法能够 较为准确地反映不同模型的安全性和可用性，并可为实际访问控制系统的评估提 供参考。本文的研究成果可以帮助访问控制系统提高安全性和可用性，提供更加 可靠的访问控制服务。

3.4 本章小结
本章首先对工业物联网面临的困境和现有访问控制的不足进行了总结，随后 提出了一种基于零信任的访问控制方案，方案同时也是本工作第四章第五章整体 工作的架构。本方案首先构建了基于人工智能的风险识别和量化模型，实现了对 异常人脸表情和异常流量的识别。随后提出了一种基于正向信任因素和负向风 险因素的直接信任计算算法，随后基于历史评估数据，使用滑动窗口和时间衰减 因子实现了综合信任的评估。然后基于 XACML 技术，实现了基于信任评估的零 信任访问控制模型。最后提出了使用安全熵概念进行访问控制模型评价。本方案 针对工业物联网面临的难以防范内部安全的困境，基于现有访问控制模型较少关 注人为因素的现状，提出了一种合理的访问控制方案，并在接下来的工作中对方 案进行了阐述和实验证明。

22

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

图 3-1 本文所提的基于属性的零信任访问控制体系框架图
23

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第四章 基于机器学习的风险识别和量化研究
在工业物联网领域，访问控制技术是保障数据和指令安全的关键，而访问控 制则是建立在对访问主体、环境和客体属性的信任评估的基础上。信任评估的核 心在于对风险因素的收集和分析，如第三章相关内容部分所述，零信任的安全策 略必须是动态的并基于尽可能多的数据源计算 [35]。因此，信任评估过程需要参 考多元化的属性，包括一些静态、长期、易于直接获取的评估属性，以及一些关 键的动态数据，如网络环境和人为因素。然而，这些动态数据通常是复杂的或离 散的，难以直接使用或难以衡量程度，因此无法直接用于评估参考。需要通过一 些转换和处理来使其变得可靠、直观、可用。因此，为信任评估提供准确、稳定 的数据支持是风险识别和量化模块需要解决的问题。本章节中，本文将通过机器 学习的方法，识别人脸异常表情和网络异常流量，为信任评估提供可靠的依据。
4.1 人脸表情识别
信任评估是基于系统风险因素的收集和分析展开的。研究表明，人为因素是 工业物联网安全的薄弱环节。人脸异常表情作为一种人为风险因素，反映了用户 与系统使用场景不符合的生理、心理或意图方面的异常。例如，在需要高度集中 注意力的任务中，用户处于悲伤状态，或在需要保持冷静的情境下表现出极度愤 怒的表情。无论出于什么诱因，这些异常都应该被视为一种风险，表明该用户不 适合访问敏感数据和操作控制指令。这种异常行为不仅可能导致用户由于情绪 而导致工业物联网中的控制操作出现偏差，还可能是用户恶意意图的表现，揭示 出内部威胁的潜在可能性。同时，攻击者也可能利用这种异常行为，加剧工业物 联网系统面临的外部威胁风险。
作为指导信任评估的依据，人脸表情识别可以帮助访问控制系统更准确地评 估访问风险，本节将通过深度学习的方法从异常表情中提取出关键特征，进而建 立模型对异常表情进行识别和分类，为系统的信任评估提供有力支持。
4.1.1 数据集和数据预处理
Fer2013Plus 数据集微软对面部表情识别经典数据集 Fer2013（Facial Expression Recognition）的扩展版，包含来自互联网上不同来源的 35,885 张标注人脸图 像，其中每张图像都代表了人的一种面部表情。与原版相比，FER+ 对原来的情 绪类别进行了重新分类和注释，将原来的“中性”类别进一步细分为“无表情”

24

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

和“不满”，总共涵盖了 8 个情绪类别，分别对应标签 0-7，具体对应为 0:anger （生气）、1:contempt（蔑视）、2:disgust（憎恶）、3:fear（害怕）、4:happiness（高
兴）、5:neutral（正常）、6：sadness（伤心）、7：surprise（惊讶）每张图像都经过 标准化和预处理，并调整为 48Œ48 像素的灰度图像。
原始数据集直接以图像形式保存，并以经根据用途 lable 分成文件夹保存，数 据存储结构，如图 (4-1) 所示:

图 4-1 Fer2013Plus 数据集介绍
由于 Fer2013Plus 数据集继承了 Fer2013 数据集的图片，在获得更精准的标 注的同时，也继承了 Fer2013 的标签分布不平衡的缺点，部分类型图像数目较少， 需要进行数据增强，使得在模型训练过程中可以更充分地学习情绪表达的细节和 变化。因此，本节在进行图像识别前，定义了数据增强算子，随机裁剪图像，并 按照指定的大小和长宽比进行缩放和平移，并以指定的概率对图像进行水平翻转 操作。
4.1.2 基于 CNN 的表情识别的方法 本文卷积神经网络结构搭建主要参考了《Network in network》[43] 中小卷积
核的思想。对于 Fer2013Plus 数据集的低尺度、单通道图像，小卷积核可以提供 更好的局部特征提取能力，通过堆叠多个小卷积核卷积层的方式来逐步提高维度 和模型的非线性表示能力，从而提高模型的性能。
本文设计模型为一个深度为 7 的卷积神经网络，模型由 3 个卷积层、3 个池 化层、1 个全连接层组成，具体模型如图（4-2），模型结构如表（4-1）所示。在 模型设计方面，第一层卷积层使用 1x1 卷积核的主要作用是增加非线性变换的能 力，从而提高模型的表达能力。虽然 1x1 小卷积核的感受野小，但是它能够实现 通道数的变换，即通过改变卷积层中的通道数来增加网络的深度和宽度，从而提 高模型的性能。此外，1x1 卷积核还能够降低模型的计算成本，因为它的参数数
25

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

量比较少，所以在模型设计中可以起到一定的压缩模型的作用。

图 4-2 基于 CNN 的人脸识别模型图

对于填充过程, 本节模型在卷积层使用 same 填充，在池化层使用 vaild 填充。 卷积层通常用于提取图像的低级特征，所以对于卷积层，使用 same 填充输出特 征图的大小将与输入特征图相同，保留原始特征图中的信息。对于池化层，使用 valid 填充，输出特征图的大小将会缩小，这可以通过池化操作来压缩图像并减 小模型的计算成本。

表 4-1 基于 CNN 的人脸识别模型细节

名称 核数目 核尺寸 步长 填充 激活函数

输入层 0 卷积层 32 池化层 0 卷积层 64 池化层 0 卷积层 128 池化层 0 全连接层 0 输出层 0

0

0

0

0

1 × 1 1 same ReLU

2×2

2

vaild

0

3 × 3 1 same ReLU

2×2

2

vaild

0

3 × 3 1 same ReLU

2×2

2

vaild

0

0

0

0

ReLU

0

0

0

Softmax

输出
(48 × 48 × 1) (48 × 48 × 32) (24 × 24 × 32) (24 × 24 × 64) (12 × 12 × 64) (12 × 12 × 128) (6 × 6 × 128)
(1 × 1024) (1 × 8)

在模型设计的激活函数方面，本节模型在隐藏层选用 ReLU，在输出层选用 Softmax。隐藏层使用 ReLU 激活函数可以有效地解决梯度消失的问题，提高模 型的收敛速度和准确性。而输出层使用 Softmax 激活函数将输出映射为概率分 布，便于计算每个类别的概率，从而得出最终的分类结果。同时，softmax 函数

26

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

也能够保证所有表情概率输出的总和为 1，从而保证每个表情类别的概率之和为 1，便于理解和解释分类结果。
4.1.3 实验结果和分析
本章模型在训练过程中的 loss 与验证集 acc 变化如（图4-3）所示。随着训练 轮数 epoch 的提升，代表理想模型和训练模型差距的 loss 越来越小，并逐渐趋于 稳定，而模型的测试集准确率在动态变化中逐渐增长并趋于稳定。当 epoch 达到 30 时，验证集准确度稳定在 70% 左右，此时继续提升训练的 epoch 对推理效果 的提升不显著。因此，本文取测试集上效果最佳的模型准确度达 69.82% 的模型 参数作为 checkpoints 以供后续推理使用。

图 4-3 训练过程 loss 和验证集 acc 变化情况
该模型下验证集的混淆矩阵如图（4-4）所示。从混淆矩阵可以看出，本节 所设计模型可以基本满足情绪识别的需要，模型对高兴和惊讶的表情识别效果较 好，而对害怕、伤心表情的识别较弱。
经过对训练集测试集的回顾，本文发现，害怕的数据样本中常常出现非面部 特征如部分手指或者手掌，甚至出现大面积遮挡面部的情况，因此，针对害怕表 情样本的学习可能学到了手指的特征，这可能是测试时可能出现泛化性能差的原 因。另一方面，与其他类别数据不同的是，伤心表情的数据集常常以侧脸的形式 出现，这可能是导致惊讶分类效果差的重要原因。
此外，Fer2013Plus 数据集存在图像分辨率低、卡通图象和写实图像混杂、存
27

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

在水印的问题，也可能是制约模型学习能力的重要原因。

图 4-4 混淆矩阵

本节通过采用 CNN 结构进行模型构建，针对小尺度图像，设置小卷积核进 行卷积，取得了较为可观的准确率。本节 CNN 模型与其他模型的对比结果如表 (4-2) 所示:

表 4-2 对比效果

模型

准确率

LeNet VGGNet [44] AlexNet [45]
本节 CNN

64.70% 72.49% 68.85% 69.82%

其中，VGGNet 和 AlexNet 在设计时通常是针对较大的图像尺寸进行优化的。 对于小尺寸的图像，如果直接将其输入到这些模型中，可能会出现特征映射尺 寸过小、参数量过大从而出现过拟合现象。文 [44] [45] 分别基于小尺寸图像对 VGG 和 AlexNet 进行了改进，在 Fer2013 数据集上分别取得了 72.49% 和 68.85% 的效果。因此，与经典的 CNN 网络相比，本模型取得了较为理想的识别率，可 作为人脸异常表情识别的推理模型。

28

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

(a)

(b)

(c)

图 4-5 推理效果

加载本节小卷积核 CNN 的模型，进行图片和视频的推理，推理效果如图 （4-5）所示输入的人脸表情图片被正确的标注并进行表情分类，综上，通过对比
实验和推理，证明了节提出的 CNN 结构和人脸情绪识别模型具备准确识别用户 情绪的能力。

4.2 异常流量检测
在工业物联网中，异常流量通常表明网络中存在异常的数据流动，可能是由 于网络攻击、设备故障或其他未知因素引起的。异常流量是攻击将要发起或正在 进行中的表征，对于工业物联网系统来说，及时发现和识别异常流量对于保障系 统的稳定运行至关重要。在信任评估中，异常流量检测应该成为关注的另一个重 点。
因此，本节中将采用多种机器学习算法来学习特征，进行对比试验。本节将 对不同的模型进行实验比较，并分析模型的性能和优缺点。通过这些实验，旨在 提供一种有效的异常流量检测方法来支撑信任评估，进一步保护工业物联网系统 的安全和稳定运行。
4.2.1 数据集和特征选择
CICIDS2017 数据集是由加拿大麦吉尔大学网络安全研究实验室（Canadian Institute for Cybersecurity）收集的工业物联网网络流量数据集。该数据集包含了

29

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

不同类型的网络攻击，例如 DDoS 攻击、恶意扫描、僵尸网络攻击、流量窃取攻 击、Web 应用程序攻击等，以及一些常规流量。原始数据集如图（4-6）所示包含 八个时段的流量记录，共计包含了 280 万个连接的流量记录，以及 78 个不同特 征值，这些特征包括了网络连接方向、连接持续时间、传输层协议、流量大小等 等。该数据集可以作为异常流量检测系统的训练和测试数据集。

图 4-6 原始数据集

为了挑选最具有区分性和预测能力的特征，本节参考 Reis [46] 对 CICIDS2017 数据集排列重要性的工作，进行了特征选择，将原始数据集的特征值缩减至 11 个，如表（4-3）所示。

表 4-3 CICIDS2017 数据集特征选择

特征名称

含义

Bwd Packet Length Min Subﬂow Fwd Bytes
Total Length of Fwd Packets Fwd Packet Length Mean Bwd Packet Length Std Flow Duration Flow IAT Std Init Win bytes forward Bwd Packets/s PSH Flag Count Average Packet Size

数据包在反向上的最小值 子流在正向中的平均字节数
正向数据包的总大小 数据包在正向上的平均大小
数据包反向标准偏差大小 数据流持续时间
两个流之间的标准差 在正向的初始窗口中发送的字节数
每秒中后向包的数量 带有 PSH 的包数量 数据包的平均大小

经过数据集筛选后，仍然存在严重的样本不均衡问题，即正常流量在数据集 中的占比很大，而其他一些异常流量则占比很小, 这将导致模型难以学习小样本 特征。因此，本工作对数据集进行了平衡样本处理，采用了随机下采样方法来减 少样本不均衡程度，如图（4-7）所示。
虽然本工作进行了平衡样本处理，但仍然存在少数标签数量与大部分标签相 差 103 个量级的问题。继续下采样可能会导致其他样本不足以学习，从而导致模 型性能下降。因此，本文采取了舍弃处理，即直接舍弃数量过少的标签，以保持

30

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

原始数据

下采样均衡
图 4-7 数据集样本均衡

数据集的平衡性和可用性。这样的处理能够确保数据集包含足够数量的每个标 签，从而为模型提供充分的训练样本。经过以上数据预处理过程，得到了一个高 质量的、平衡的数据集，为异常流量检测任务提供了有力支撑。
4.2.2 基于机器学习的异常流量检测模型
传统的网络异常流量检测方法通常基于规则和签名的技术，例如基于端口、 基于协议、基于流量量等等。这些方法在一定程度上可以识别常见的攻击类型， 但是误报率较高，也很难处理大规模网络环境下的流量数据。因此，需要使用更 加灵活和准确的方法，来对网络流量进行分析和检测。机器学习作为一种重要的 数据分析方法，近年来在异常流量检测领域得到了广泛的应用。与传统方法相 比，机器学习具有许多优势。其中最重要的是，机器学习可以通过学习数据的特 征自动检测异常流量，而传统方法则需要手动确定特征并设置相应的规则。朴素 贝叶斯（NB）、逻辑回归（LR）、K 近邻算法（KNN）、支持向量机 (SVM)、随 机森林（RF）、深度神经网络（DNN）等机器学习算法是分类任务中广泛应用 的算法。NB 是一种基于贝叶斯定理的分类方法，它通过计算各个特征之间的条 件概率来预测新数据的类别。LR 是一种线性分类方法，适用于线性可分的问题。 KNN 是一种基于邻近度的分类方法，它通过计算样本间的距离来判断新样本的 类别。SVM 是一种通过将数据集映射到高维空间，并找到一个最优的超平面来 进行分类的方法。RF 则是通过对数据集进行随机采样并在采样后的数据集上建 立多个决策树来进行分类。DNN 基于神经网络，通过学习数据的特征自动提取 和学习更加抽象的特征表示，进一步进行分类。

31

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

虽然这些算法在分类任务中都有广泛应用，但它们各自也存在着一些优缺 点。例如，NB 简单易懂，但假设特征之间相互独立，可能不符合实际情况；LR 对于非线性数据分类效果不佳，而且对于噪声和异常值比较敏感；KNN 计算量 大，但适用于非线性分类问题；SVM 在高维空间下表现较好，但对参数的选择 比较敏感；随机森林可以避免过拟合，但可能会因为数据集不平衡而导致某些类 别的预测准确率降低；DNN 的训练需要大量的数据和计算资源，小规模数据集 或计算资源受限的场景来说 DNN 效果可能不佳。因此，针对异常流量检测的模 型需要通过实验确定。

4.2.3 实验结果和分析
本节选取了朴素贝叶斯 (NB)、逻辑回归（LR）、K 近邻算法（KNN）、支持 向量机 (SVM)、随机森林（RF）5 种传统的机器学习分类算法和一个包含 3 个隐 藏层的 DNN 网络在 CICIDS2017 上进行训练，算法表现如表（4-4）所示

模型
NB LR DNN SVM KNN RF

表 4-4 模型对比

准确率

加权召回率

71.03 %

71%

83.58 %

84%

84.91 %

82%

86.53 %

86%

97.85 %

98%

98.52 %

99%

从实验结果可知，RF 和 KNN 的准确率相对较高，分别达到了 98.52% 和 97.85%，这两个模型通常在处理高维度数据和复杂数据结构时表现较好。由于异 常流量检测中存在很多变量和关联关系，因此这些模型能够更好地捕捉到异常流 量的模式和规律，从而提高了模型的准确率。随后 DNN、SVM 和 LR 的表现较 好并且准确率相近，分别为 89.84%、86.53% 和 83.58%, 这三个个模型都有着较 强的分类能力和泛化能力。SVM 通过寻找数据空间中的最优超平面来进行分类， 而 DNN 则可以通过多层次的非线性变换学习到更复杂的特征表示。LR 的表现 略差可能因为特征之间存在非线性关系或者存在大量的异常值导致分类没有达 到较好的效果。NB 模型的表现不佳仅有 71.03% ，可能是筛选过的数据集特征 间的关系并非独立分布，特征间具有相关关系，导致分类效果不佳。
在异常流量识别任务下，模型的准确度并不是唯一的评估指标。由于异常流 量数据往往表征着即将发起或正在进行中的危险，比正常流量数据更加重要，因 此模型的召回率是需要考虑的目标。如果召回率很低，那么模型对异常流量的检

32

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

出率效果差将会错过很多异常流量数据，导致漏检率很高。此外，对于异常流量 种类识别的全面性也应该是模型选择的重要指标。在实际应用中，低频出现的异 常流量种类可能并不代表造成的危害小，因此模型需要具备识别多种异常流量 的全面性，以尽可能地减少漏检率和误检率，提高异常流量检测的可靠性和准确 性。
RF 和 KNN 的准确率相近，分别达到了 98.52% 和 97.85%。在召回率方面， RF 算法的召回率达到了 99%，KNN 算法的召回率是 98%，因此，RF 模型是更 适合异常流量检测的模型。RF 模型的混淆矩阵如图（4-8）所示：

图 4-8 混淆矩阵
保存 RF 模型参数，推理效果如图（4-9）所示:
图 4-9 推理效果
4.3 本章小结
在人脸表情识别任务中，本工作使用 Fer2013PLUS 数据集，通过设计一种 小卷积核的 CNN，得到了较好的实验结果。同时，在异常流量检测任务中，本
33

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

工作选择了 7 种机器学习算法进行对比，从中选出了最佳算法，并进行了进一步 的实验验证。此外，本工作还将这两种风险识别模型应用到了在线推理中，实现 了实时、可靠的数据支持。本章的工作提供了一种有效的数据来源和方法，为实 现信任评估，提高网络安全性和保障信息安全提供了重要的支持。

34

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第五章 基于零信任的访问控制模型
在工业物联网领域中，确保数据和指令不会被非法访问，进而不会被非法使 用至关重要，访问控制技术是实现此目标的关键技术之一。相比传统的基于网络 边界进行访问控制的安全模型，零信任的访问控制更加注重对访问请求的精细控 制和验证。在每个访问请求到达时，对请求者的身份、访问环境以及请求的目标 进行全面的评估和授权，并在访问过程中通过对用户和设备的访问情况进行实时 监测和分析，通过持续的访问监控和风险评估，缩短信任的空窗期，降低信息泄 露和攻击的风险。
信任评估则是实现这一目标的重要手段，在零信任架构中，信任评估基于多 方面因素综合评估确定了访问请求的可信程度。通过这样的评估，系统可以更好 地了解请求的来源、目的以及可能的风险，用于指导实现对访问的动态控制和管 理。在上一章中，本文探讨了基于机器学习的人为因素风险识别和量化方法，这 为建立信任评估提供了高效可靠的风险动态数据。
本章将从信任评估出发，基于访问主体属性、访问客体属性、结合动态的风 险属性，并通过综合计算这些因素的特征和权重，引入一种基于多维度的直接信 任评估模型。随后，本章根据信任的特点，引入基于时间衰减因子和滑动窗口进 行综合信任的计算，完成对访问主体发起的访问行为可靠性的评估。进一步地， 基于信任评估结果，结合 XACML 方式和阈值的形式，实现了 IIoT 数据和指令 的动态访问控制。最后，本工作使用一种基于安全熵的访问控制系统评价方法， 用于评价访问控制效果，以进一步提高访问控制模型的安全性和可靠性。
5.1 基于多维度的信任评估模型
信任和风险是一组对立统一的重要决策因素。信任是指对实体的一种积极 预设估计，认为它是可信的，或者至少是部分可信的。而风险则是一种潜在的负 面效应或损失的概率估计，是对信任预设的一种反向评估。两者相互依存、相互 促进、相互转化。按照零信任理念，预设对实体的信任，就会增加风险的发生概 率，因为实体可能会滥用其访问权限，或者被黑客攻击利用。相应地，如果缩短 了信任的空窗期，加强了对实体的访问控制和监控，就可以减少潜在的风险。
在进行信任评估决策时，需要全面考虑访问主体、访问客体、环境因素等多 个因素，以获取实体可信程度的正面指标。例如，可以考虑访问主体的身份验证、 授权历史、行为记录等因素。同时，信任决策还需要关注系统的风险因素，例如

35

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

动态的风险数据和历史行为记录等，以评估系统的负面指标。在全面考虑信任和 风险因素的基础上，才能更好地进行信任评估决策，进一步指导访问控制。
本节的组织结构如图（5-1）所示，首先，评估模型基于访问主体属性、访问 客体属性、访问行为和风险属性等维度的信息，结合主客观权重向量，计算访问 主体的直接信任值。随后，根据信任发展的特点，评估模型引入了滑动窗口对历 史评估信息进行上下文感知，考虑到不同间隔的历史信任评估数据对当前综合信 任的影响，引入了时间衰减因子对影响程度进行了矫正，最终实现了访问主体综 合信任的评估。

图 5-1 信任评估流程
5.1.1 直接信任评估 直接信任评估是衡量访问主体恰在访问时刻安全程度的指标，通过用户的身
份、设备的安全状态、访问环境的安全性等正向因素，结合风险因子等负向因素， 从而更全面地评估用户的可信程度。本节将探讨基于多维度的信任评估模型，结 合主客观权重向量，计算访问主体的直接信任值，以实现更准确、更可靠的直接 信任评估 DT(Direct trust)，该部分包括评估依据选取、正向因素计算和负向因素 计算。评估依据属性选取：在零信任访问控制结构下，访问主体由用户，客体以 及环境三者共同构成，基于这个理念，访问主体的正向信任值包括用户属性值， 客体属性值，环境属性值，同时还需要考虑风险情况对信任值进行调整。
在此基础上，本节模型的信任度量依据如图（5-2）所示。 用户属性：用户是访问的发起者，用户属性在短时间内属于静态状态，其主 要包含账号、密码、用户职务等级、奖惩状况等。客体属性：客体属于被访问对 象，是访问请求的资源，客体属性属于静态状态，主要包括唯一标识符，资源属 性、资源重要程度等。环境属性：环境指用户发起访问请求的终端，环境属性属 于动态状态，主要包括 IP 地址，访问时间，设备类型，高危漏洞检查，操作系统
36

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

正向因素

图 5-2 信任评估依据

负向因素

版本检查等。风险因子：风险因子是系统的负面指标，由于人为因素的是安全的 薄弱环节，因此主要考虑用户异常情绪和用户网络异常流量。
基于正向因素和负向因素的直接信任值计算
正向信任因素的表达函数趋势上应该具有如下特征： • 函数应为连续光滑曲线，整体呈现上升走势 • 函数在正向信任因素值积累较少时候增长慢，在有一定的基础后增长加快，
最后随着因素积累的饱和增长变慢。 Sigmoid 函数符合正向信任因素表达的趋势，图像如图（5-3）所示。因此， 本节使用 Sigmoid 函数进行多维度指标下的正向因素信任值 PF（Positive Factor, PF）计算：

(a)正向信任因素表达

(b)负向信任因素表达

图 5-3 信任表达函数

37

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

1 PF(m) = 1 + ea−∑wi×xi

(5-1)

其中，a 是平移常数，用于将 sigmoid 函数沿 x 轴正向平移，以符合正向信 任因素表达函数的特征。m 是正向因素的集合，xi 是具体的影响因子，wi 是影响 因子的权值。
相应的，负向信任因素的表达函数趋势上应该具有如下特征： • 函数应为连续曲线，整体呈现下降走势 • 函数应为分段曲线，在风险较低时候不影响信任评估，在风险较高时主导
信任评估 • 函数值域处于 [0, 1]，在不影响信任评估时趋于 1，在主导信任评估时趋于 0 因此，本节设计分段函数对负向指标 NF（Negative Factor）:



1 NF(n) =  1
bx

, ,

1 bx

>

1

1 bx

<

1

(5-2)

其中，n 是负向因素的集合，b 是缩放常数，用于反比例函数的斜率调整。 综合，以上正向因素评估函数 PF 和负向因素评估的函数 NF，本节提出直 接信任评估函数：

DT = PF × NF

(5-3)

当风险因子较小时，负向因素表达函数值 NF 取 1，直接信任 DT 由正向因 素表达函数 PF 决定。当风险因子较大时，负向因素表达函数值 NF 值域 (0, 1], 取 值和风险因子呈反比例，并且随着风险因子的增大取值趋于 0，对正向因素表达 函数 PF 值进行放缩矫正。
当访问主体发起访问请求和访问续存期间，信任评估模型基于访问的正向因 素和负向因素进行直接信任评估，从而确定其是否有资格获得所请求的资源或服 务，是当下系统对访问请求合理性认可程度的体现。
需要注意的是，在实际部署中，应注意到不同应用场景的特点和需求的异构 性。因此，对于不同场景的信任评估，需要从关注点出发，综合考虑各种因素的 重要性，以获取各因素主客观权重，并进行计算。在计算权重时，可以使用专家

38

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

评价法、熵权法等多种方法获取。随着应用场景的不断变化和需求发展，信任评 估模型的权重也需要不断优化和改进。需要及时收集和分析反馈数据，并对评估 模型进行优化和调整，以提高评估的准确性和可靠性。
5.1.2 基于时间衰减的综合信任评估
信任评估的研究和实践证明 [47]，信任是在交互过程中不断学习和积累经验 建立的。在实际应用中，历史信任对于当前信任的计算具有参考价值，但是由于 时间的推移和环境的变化，之前建立的信任的参考价值可能会逐渐减弱，在进行 信任评估时，既需要参考历史数据，又需要对历史数据进行时间衰减修正，以保 证评估的精度和实用性。

图 5-4 滑动窗口

因此，本节使用滑动窗口法5-4，关注信任评估的上下文信息，同时引入基 于时间差的衰减因子，可以使得较早时期的历史数据在信任评估中具有较小的影 响力，而较近时期的历史数据在信任评估中具有更高的权重，进而提高信任评估 的准确性和可靠性。
设计综合信任 CT（Comprehensive trust）计算函数如下：

l
CT = ∑ ω (ti) × DTi i=1





ω (ti) =

η (ti ) ∑li=1 η(ti)



η (ti)

=

1 α ti

,

ti

⩾0

其中，α 是预设的常数，取值范围 (1, 1.05] 由系统决定。l 是滑动窗口的长

度，ω(ti) 是距离当前时间 ti 的直接信任评估衰减系数。

39

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

5.1.3 仿真实验分析
由于不同 IIoT 系统间结构不同，功能差异大，侧重点不同，因此不存在通用 的访问控制解决方案，为了对上述信任计算设计的合理性进行验证，本节采用模 拟数据的方式分别分析直接信任的计算过程和综合信任计算过程的合理性。
由于正向因素往往是静态状态，如访问主体的用户的职务等级、访问客体的 密级等相对静止的属性，在发起新的访问请求和访问续存期间相对稳定，正向因 素的指标主要由可能变化的环境因素影响。因此，访问时累加和常常在一个数值 附近波动。本节选取公式5-1，在平移常数 a=5 情况下的图像（如图5-5（a））进 行模拟实验，构建了 3 组分别处于 sigmoid 不同定义域下小幅度波动的正向因素 访问记录权值累加和（∑ wi × xi），数据如图5-5（b）所示，进行 sigmoid 表达后 直接信任值表现如图5-5（c）所示：

(a) a=5 的 sigmoid 图像 (b)正向累加和数据
图 5-5 正向信任表达实验

(c)正向信任表达

从图像可以看出，当 sigmoid 平移常数合适时，对于正向累加和处于 sigmoid 中部的数值，sigmoid 函数可以保留数据的变化特征。对于累加和高和低的用户， sigmoid 可以平滑曲线。因此，式（5-1）可以作为正向因素表达的函数，正确的 映射不同正向因素累加和信任值的关系。
根据直接信任值的计算公式 (5-3)，当检测到风险因子时，若风险因子较小， DT 仍由正向因子表达函数 PF 决定，当风险因子较大时，负向因子表达函数 NF 对 DT 进行修正。因此，本节选取前文 user3 的正向信任表达数据，分别使用四 种变化的负向评估函数 NF 曲线如图5-6（b）所示，进行直接信任 DT 的曲线合 成，合成结果如图5-6（c）所示：
通过图像可以看出，当负向表达函数 NF 的值较低时 (如蓝色曲线 risk1)，直 接信任 DT 的变化与正向表达函数 PF 相同。然而，当负向表达函数 NF 的值增 加时，合成的 DT 和 NF 值呈现负相关（如红色曲线 risk4），即 NF 值的上升会导 致 DT 值的降低，而 NF 值的降低则会导致 DT 值的上升。这种变化趋势符合信 任和风险的发展规律，因此本节所提出的直接信任 DT 计算函数（5-3）可以用于 对访问主体信任的评估。

40

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

(a) b=1 的 min(1,1/bx) 图像 (b)四种 NF 变化曲线
图 5-6 直接信任合成实验

(c)DT 合成曲线

需要注意的是，在实际部署中，应该根据信任评估场景的特点来设置 sigmoid 平移常数 a 和反比例函数的缩放常数 b，以确保评估结果的准确性和可靠性。
为检验滑动窗口和时间衰减因子的效果，本节取 α = 1.05，每一次访问视为 同等的单位时间间隔 t，滑动窗口大小为 3，基于前文 risk2 和 risk4 曲线合成的 曲线 DT2 和 DT4 图5-7（a）进行综合信任值计算，CT2 和 CT4 计算结果如图5-7 （b）所示：

(a)曲线 DT2 和 DT4

(b)滑动窗口和衰减计算

图 5-7 综合信任评估

从图像可以看出，滑动窗口和信任衰减因子的引入，使得访问主体信任的趋 势得以保留，同时呈现更加平滑的变化。这表明这种方法可以更有效地减少偶然 波动的噪声干扰，使得信任度的变化更加稳定和可靠，更好地应对信任度变化的 动态性。这个实验结果也表明这种方法可以应用于需要对访问主体进行信任度 分析的场合，例如物联网设备访问控制系统，实现信任度的监控和管理。

5.2 基于信任评估的零信任访问控制模型
传统的访问控制模型通常基于角色、密级等长期指标静态管理访问权限，并 且用户一经授权便不在校验，忽略了工业物联网中不断变化的网络环境和人为因

41

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

素，在这个前提下建立的固定的安全策略和长期有效的访问控制权限是有局限性 的。在前一节的研究中，本文探究了如何科学地计算访问主体的综合信任值。基 于持续的信任评估结果，系统可以动态的感知访问主体的可信程度，进而根据策 略实施动态的访问控制。
本节中将以计算出来的综合信任值为基础，进一步探讨如何利用基于信任的 访问控制方法来实现零信任安全目标。本工作将首先介绍基于零信任的访问控 制流程，随后展示如何基于 XACML 实现动态访问控制。
5.2.1 基于零信任的访问控制流程
在本节中，本工作将介绍基于零信任的访问控制流程。在本文所提到的零信 任访问控制模型中，权限的获取的依据是访问主体的综合信任值，而综合信任值 是由信任评估模型根据历史评估及当前属性计算得来。当访问请求发起时和访 问请求续存期间，通过对访问主体持续的监控和评估，建立或保持信任以获取和 维持访问的权限，实现动态的访问控制和权限分配。零信任的访问控制模型如图 （5-8）所示：

图 5-8 零信任访问控制模型
其中，各元素的定义和功能描述如下：（1）访问主体：访问主体是用户、终 端设备和网络环节的集合，是访问控制请求的发起者。（2）客体资源：客体资源 是系统数据和指令资源的集合，是访问请求的作用目标。（3）策略信息点（PIP）： 策略信息点是提供属性的系统实体。（4）策略执行点（PEP）：策略执行点发起决 策请求和执行授权决策进行访问控制。（5）策略判定点 (PDP)：策略判定点评估 适用策略并做出授权决策。（6）策略管理点 (PAP)：策略管理点创建策略或策略 集。（7）信任评估模型：信任评估模型根据策略信息点提供的属性计算主体综合 信任。
访问流程图描述如下：（0）初始阶段：系统在策略管理点基于信任阈值和 其他主体属性预设访问控制策略。（1）开始阶段：用户通过身份认证，接入访
42

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

问控制系统，将访问目标的客体资源识别号和欲执行的访问行为发送至策略执 行点。（2）持续属性感知阶段：策略执行点向策略信息点转发访问主体访问行 为，策略信息点开始持续感知量化风险，获取主体信任属性，并送至信任评估模 块。（3）持续信任评估阶段：信任评估模型根据策略信息点提供的信任属性和风 险属性计算并记录直接信任值，通过滑动窗口机制和时间衰减因子机制结合历 史评估记录，持续计算主体的综合信任，并推送至策略执行点。（4）持续访问判 定阶段：策略执行点将基于信任属性的主体访问请求发送至策略判定点，策略判 定点结合策略管理点信息，进行持续的策略匹配和策略判定，并将访问决策（允 许、拒绝、维持、断开）返回策略执行点。（5）访问控制阶段：策略执行点根据 访问判定阶段做出的访问决策，对访问主体发起的访问予以允许、拒绝、维持、 断开操作。
5.2.2 基于 XACML 实现动态访问控制
根据访问控制流程可知，访问控制的关键是在实现信任评估后基于信任属性 进行策略匹配，XACML 为基于属性的访问控制实现定义了一种策略规范语言和 参考体系结构，本节基于 XACML 语言，提供了一种基于信任阈值和其他主体属 性的访问控制策略描述。XACML 访问请求由主体（Subject，通常指发出请求的 用户）属性、资源（Resource，请求访问的对象）属性、操作（Action，对资源执 行的操作）属性和环境（Environment）属性组成，XACML 属性以键值对的形式 定义，其中属性值可以是任意类型例如整数型和字符串型数据。属性名表示与主 体、资源、操作或环境相关联的属性或特征。
对于一个访问请求，零信任访问控制模型的策略判定点将请求转换为 XACMAL 的形式，并在策略库进行策略匹配，从而根据信任属性和其他属性做出访 问决策。在本节中，我们以一个用例为例，介绍基于 XACML 的策略、访问以及 响应。
用例：
假设有检修工 Alice，他职责是在工程师站访问所检修的的 A 组传感器设备 的运作日志，并进行检修。对于检修工的访问控制策略是仅当综合信任值达到 0.8 时允许访问。
可给出访问控制策略如下：
1 <?xml version="1.0" encoding="UTF−8"?> 2 <Policy xmlns=" urn:oasis:names:tc:xacml:3 .0 :core:schema:wd−17" PolicyId="
groupA−sensor−logs−policy" Version="1.0" RuleCombiningAlgId="

43

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

urn:oasis:names:tc:xacml:3.0:rule−combining−algorithm:deny− overrides ">

3

<Description>A组传感器日志访问控制策略</Description>

4

<Target>

5

<AnyOf>

6

<All>

7

<Match MatchId="urn:oasis:names">...</Match>

8

</All>

9

</AnyOf>

10

</Target>

11 <Rule RuleId="groupA−sensor−logs−access" Effect="Permit">

12

<Description>当综合信任大于0.8时允许访问</Description>

13

<Target>

14

<AnyOf>

15

<All>

16

<Match MatchId="urn:oasis:names">...</Match>

17

</All>

18

</AnyOf>

19

</Target>

20 </Rule>

21 </Policy>

其中第一部分描述了访问的客体的匹配规则（见代码第 7 行）。它使用正则 表达式匹配对客体的 ID 为"GroupASensorLogs" 的请求，进一步匹配条件来限制 对指定资源的访问。详细内容如下：

1 <Match MatchId=" urn:oasis:names:tc:xacml:1 .0 :function:string −regexp−match"

>

2 <AttributeValue

3

DataType="http: // www.w3.org/2001/XMLSchema#string">

4

GroupASensorLogs</AttributeValue>

5 <AttributeDesignator

6

Category=" urn:oasis:names:tc:xacml:3 .0 :attribute − category:resource "

7

AttributeId=" urn:oasis:names:tc:xacml:1 .0 :resource:resource −id"

8

DataType="http: // www.w3.org/2001/XMLSchema#string"

9

MustBePresent="true"/>

10 </Match>

44

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第二部分描述了主体的访问条件（见代码第 17 行）。这部分将基于信任属性 用于指导访问，通过 integer-greater-than-or-equal() 函数进行信任属性和阈值的比 较，确定综合信任“comprehensiveTrust”属性是否大于或等于 0.8。如果是，允 许对前文定义资源的访问，详细内容如下：

1 <Match MatchId=" urn:oasis:names:tc:xacml:1 .0 :function:integer − greater −than −or−equal">
2 <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">

3

0.8</AttributeValue>

4 <AttributeDesignator

5

Category=" urn:oasis:names:tc:xacml:3 .0 :attribute − category:environment "

6

AttributeId="comprehensiveTrust"

7

DataType="http: // www.w3.org/2001/XMLSchema#double"

8

MustBePresent="true"/>

9 </Match>

该策略描述了客体资源 GroupASensorLogs 的访问策略，当主体 comprehensiveTrust 值大于等于 0.8 允许访问，该策略加载至策略管理点即可作为策略判定 点可匹配的策略。
根据用例 ALice 的情况，策略判定点生成的 XACML 访问请求如下：

1 <?xml version="1.0" encoding="UTF−8"?>

2 <Request xmlns=" urn:oasis:names:tc:xacml:3 .0 :core:schema:wd−17"

3 CombinedDecision="false"

4 ReturnPolicyIdList="false">

5 <Attributes Category="urn:oasis:names:tc:xacml:3 .0 :attribute −

category:resource ">

6 <Attribute AttributeId="urn:oasis:names:tc:xacml:1.0 :resource:resource −

id"

7

DataType="http: // www.w3.org/2001/XMLSchema#string">

8

<AttributeValue>GroupASensorLogs</AttributeValue>

9 </Attribute>

10 </Attributes>

11 <Attributes Category="urn:oasis:names:tc:xacml:3 .0 :attribute −

category:environment ">

12 <Attribute AttributeId="comprehensiveTrust"

13

DataType="http: // www.w3.org/2001/XMLSchema#double">

45

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

14

<AttributeValue>0.9</AttributeValue>

15 </Attribute>

16 </Attributes>

17 </Request>

该访问请求即代表具有 0.9 综合信任度的主体对 GroupASensorLogs 发起请求，根 据前文所定义的访问控制策略 groupA-sensor-logs-policy，该请求将被允许。
简化的零信任访问控制流程如图（5-9）所示:

图 5-9 零信任访问控制数据流图
XACML 支持基于属性的访问控制，通过这种方式，访问控制模型可以根据 请求的实时信任特征决策，并能够动态的适应访问主体的属性变化，实现了细粒 度的访问控制。因此，XACML 机制为实现动态的、精确的零信任访问控制提供 了可靠的支持。
5.3 基于安全熵的访问控制模型评价
根据前一节所建立的信任评估模型，访问控制模型实现了对访问主体信任 度的量化评估，实时计算访问主体的信任度，为访问控制过程的权限调整提供信 任依据。进一步的，一个成熟的访问控制模型应该包括完善的访问控制策略和模
46

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

型，并对访问控制策略的安全性和可用性进行科学度量。因此，本节方案基于车 天伟 [48] 提出的安全熵概念，进一步细化访问权限，对访问控制模型进行可用性 和安全性度量。
具体组织上，本小节首先从香农熵的定义出发，基于不同事件的客观价值和 主观因素，引入加权熵的概念。随后结合访问控制场景，从访问控制结果出发， 提出了安全熵的概念。最后，结合 IIoT 场景中访问权限的多样性，进一步细化访 问权限，建立扩展的安全熵用于评价访问控制模型的可用性和安全性，随后进行 了形式化的和非形式化的证明。

5.3.1 安全熵

前文相关工作提到，香农熵是纯粹基于概率的函数，不考虑系统的客观价值

因素。在访问控制场景中，各种随机事件的发生对系统的具有不同的影响和结果，

为了将客观价值和模型评估主观因素纳入信息度量中，需要对香农熵进行扩展。

为了体现每一个事件 ai, 对系统的具有不同的影响，加权熵指定一组非负实

数 wi ≥ 0(i = 1, 2, · · · , q)，作为这组事件的权重。即随机变量 X 的权重概率分布

[X, ωi] 为

 



 X  =  a1 a2 · · · aq 

ω

ω1 ω2 · · · ωq

则可给出随机事件 X 的加权熵公式：

q
H(X) = − ∑ ωi p (ai) log p (ai) i=1

(5-4)

在访问控制系统中，访问主体发起访问控制请求，信任评估模型会根据主体 属性进行信任评估，访问控制系统根据信任评估结果匹配访问控制策略进行请求 响应，响应结果分为授权和拒绝且响应结果具有确定性，即系统不会同时给出授 权访问和拒绝访问两种结果。根据信任评估结果，访问主体分为信任主体和风险 主体，进一步的，根据主体类别和响应结果，访问控制事件的结果有四种：授权 信任主体访问，拒绝信任主体访问，授权风险主体访问，拒绝风险主体访问。显 而易见，访问响应结果是直观体现访问控制模型效果的指标，表 5-1 显示了不同 响应结果与访问控制模型评价的关系：拒绝信任主体访问的可能导致用户体验不 佳、导致系统服务中断，从而影响到资源的合理使用，是访问控制系统可用性差 的体现。授权风险主体访问可能导致未经授权的用户或恶意用户访问敏感资源 和控制指令，造成数据泄露、恶意操作的后果，是系统安全性差的体现。此外，

47

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

表 5-1 访问响应结果与系统性能的关系

信任评估结果 模型响应结果

响应事件

响应影响

信任主体 信任主体 风险主体 风险主体

授权 拒绝 授权 拒绝

a1 : 授权信任主体访问 a2 : 拒绝信任主体访问 a3 : 授权风险主体访问 a4 : 拒绝风险主体访问

符合预期 系统可用性差 系统安全性差
符合预期

授权信任主体访问与拒绝风险主体访问是符合访问控制预期的响应。

为了更好地度量访问控制系统的性能，车天伟 [48] 基于上述四种访问结果，

提出了安全熵的概念用于衡量访问性能: 对于一组访问请求，B：bi(i = 1, 2, · · · , q), 访问控制模型结果有：a1 : 授权信任主体访问，a2 : 拒绝信任主体访问，a3 : 授权 风险主体访问，a4 : 拒绝风险主体访问，使用 p(ai), (i = 1, 2, 3, 4) 表示事件 ai 的 发生概率，则有概率分布 [X, p(X = ai)]：





 X  =  a1

P(x)

p(a1)

a2 p(a2)

a3 p(a3)


a4  p(a4)

其中，事件的概率 p(ai) ≥ 0, (i = 1, 2, 3, 4) 且事件的概率之和 ∑4i=1 p(ai) = 1 根据（5-4）所述加权熵的概念，为了将客观价值和模型评估主观因素纳入

信息度量中，需要对每一种访问事件赋予权值，权重的大小体现响应该事件对系

统的性能影响的大小，设权重的分布为：

 



 X  =  a1 a2 a3 a4 

ω

ω1 ω2 ω3 ω4

则 X 的安全熵可表示为：
4
H(X) = − ∑ ωi p (ai) log p (ai) i=1

(5-5)

5.3.2 访问控制评价
根据访问控制目的，结合表 5-1 易知，响应 a2 和 a3 会对系统的安全性可用 性造成影响，而响应 a1 和 a4 符合访问控制预期。因此，若令 ω2, ω3 ≫ ω1, ω4 ， 此时式（5-5）所得安全熵的意义表示针对一组访问请求为 A : ai(i = 1, 2, · · · , q) ，

48

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

表 5-2 熵的权重和评价目标的关系

良性事件权重 不良事件权重

评价目标

ω1 = ω4 = 0 ω1 = ω4 = 0 ω1 = ω4 = 0

ω2 + ω3 = 1 ω2 = 0, ω3 = 1 ω3 = 0, ω2 = 1

安全性和可用性 安全性 可用性

该访问控制系统响应结果出现不良事件的平均不确定性。访问控制系统熵值越 小表示产生不良事件的不确定性越小，反之熵值越大表示产生不良事件的不确定 性越大。针对同一组访问请求，不同的系统的熵值越小，系统的访问控制性能更 好。
进一步地，若令 ω2 ≥ 0, ω3 ≥ 0,ω2 + ω3 = 1, 且 ω1 = ω4 = 0, 则此时式（5-5）所 得安全熵可作为系统安全性和可用性的判定依据。若令 ω2 = 1, ω1 = ω3 = ω4 = 0, 则此时式（5-5）所得安全熵可作为系统安全性的判定依据。若令 ω3 = 1, ω1 = ω2 = ω4 = 0, 则此时式（5-5）所得安全熵可作为系统可用性的判定依据。

5.3.3 形式化证明 定理 1: 访问控制模型具有完全的安全性和可用性，当且仅当

4
H(X) = − ∑ ωi p (ai) log p (ai) = 0 i=1
其中：ω2 + ω3 = 1, ω2 > 0, ω3 > 0

(5-6)

证明: 根据题设 ω2 + ω3 = 1且ω2 > 0, ω3 > 0, 可知 ω1 = ω4 = 0, 代入式子 （5-6）可得 H(X) = −(ω2 p (a2) log p (a2) + ω3 p (a3) log p (a3)) = 0.
已知，ω2 > 0且ω3 > 0，则仅当

p (a2) log (p (a2)) = p (a3) log (p (a3)) = 0

使得 H(X) = 0 成立. 有 y = x log x 的图像如图5-10 所示：当 x → 0+ 或者 x = 1 时，x log x = 0. 因此， 当 p(a2) → 0+且p(a3) → 0+ 或者 p(a2) = 1且p(a3) = 1 时，代入可使 H(X) = 0 成 立. 由于 ∑4i=1 p(ai) = 1, 且p(ai) > 0, 所以 p(a2) = 1且p(a3) = 1 不能同时成立，因 此当 H(X) = 0，则必有 p(a2) → 0+且p(a3) → 0+，即系统以极低的概率发生“拒 绝信任主体访问”和“授权风险主体访问”事件，可称系统具有完全的安全性和

49

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

可用性, 得证. 同理可得： 定理 2: 访问控制模型具有完全的安全性，当且仅当
4
H(X) = − ∑ ωi p (ai) log p (ai) = 0 i=1 其中：ω3 = 1, ω1 = ω2 = ω4 = 0
定理 3: 访问控制模型具有完全的可用性，当且仅当
4
H(X) = − ∑ ωi p (ai) log p (ai) = 0 i=1 其中：ω2 = 1, ω1 = ω3 = ω4 = 0

(5-7) (5-8)

图 5-10 xlogx 图像
5.3.4 实验分析和证明 为了对上述评价方式的效用进行分析，本节采用限定条件下的随机生成，来
模拟不同表现不同性能的访问控制模型，并通过调整权重，生成安全熵进行模 型评价，通过统计分析方法论证评价指标的可行性。实验环境为 Intel Core i712700H，python3.7。根据表（ 5-2）描述的事件分布，按照常理，系统运转过程 中遇到的访问请求概率分布较为均匀，不可能全是违规或全是合法的，而且大部 分时间访问系统会给出符合预期的运作结果。
因此，本节在 p(a1) + p(a4) ≥ 70%, p(a2) + p(a3) ≤ 30%, ∑4i=1 p(ai) = 1 的条 件下随机生成 15 个访问控制系统，并根据 p(a1) + p(a4) 的和排序 15 个模型。由 于事件 a1, a4 符合访问控制预期，令其之和为 z 轴，以影响可用性的指标 a2 作为 x 轴和影响安全性的指标 a3 作为 y 轴，则 15 个访问控制系统的性能表现在三维
50

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

空间和二维空间中的分布如图 5-11所示。根据定理（5-6），在二维坐标系中，原 点的位置的访问控制模型，p(a2) → 0+且p(a3) → 0+，具有完全的安全性和可用 性。因此，在整个二维空间中，越接近原点的访问控制模型，理论上具有更好的 宏观安全性和可用性；同理，以 x 轴（a2）为参考系，越接近原点的模型理论上 具有越好的可用性，以 y 轴（a3）为参考系，越接近原点的模型理论上具有越好 的安全性。

(a)

(b)

图 5-11 15 个随机的访问控制系统

在实际的访问控制场景下，不同的 IIoT 系统对于安全性和可用性的需求不 同，本节中仅以讨论 ω2 = ω3 = 0.5（安全性和可用性同等重要），ω2 = 1（可用 性绝对重要），ω3 = 1（安全性绝对重要），三种情况。根据预设权值，通过加权 安全熵公式计算不同场景需求下的熵值，

(a) ω2 = ω3 = 0.5

(b) ω2 = 1

(c) ω3 = 1

图 5-12 三种预设需求下的 15 个访问控制系统性能表现

以（a）场景为例，该场景认为系统的安全性和可用性同等重要，从图 5-11可 见访问控制系统 1-3 号距离原点较近（发生风险响应的概率较低），而 13-15 号 距离原点较远（发生风险响应的概率较高），从安全熵计算结果可知，1-3 具有较 低的安全熵，代表着系统出现风险响应的不确定性小，13-15 具有较高的安全熵， 代表着系统出现风险响应的不确定性大，安全熵的计算结果符合访问响应结果。

51

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

以（b）场景为例，该场景认为系统的可用性绝对重要而不关心系统的安全 性，从图 5-11可见虽然访问控制系统 1-3 号都距原点较近，但是系统 1，3 在 a2 轴上具有较小的值（发生可用性风险响应的概率较低），而系统 2 在 a2 轴上具有 较大的值（发生可用性风险响应的概率较高），从安全熵计算结果可知，系统 1， 3 具有较低的安全熵，出现可用性风险响应的不确定性小，而系统 2 具有较高的 安全熵，出现可用性风险响应的不确定性大。值得一提的是，访问控制系统 2 和 15 具有相近的 a2 值（发生可用性风险响应的概率相近），尽管访问控制系统 15 具有更高的安全性响应风险，在系统可用性绝对重要的评价指标下，访问控制系 统 2 和 15 的安全熵接近，出现可用性风险响应的不确定性相同。
以（c）场景为例，该场景认为系统的安全性绝对重要而不关心系统的可用 性，从图 5-11可见虽然访问控制系统 1-3 号都距原点较近，但是系统 2 在 a3 轴 上具有较小的值（发生安全性风险响应的概率较低），而系统 1，3 在 a3 轴上具 有较大的值（发生安全性风险响应的概率较高），从安全熵计算结果可知，系统 2 具有较低的安全熵，出现安全性风险响应的不确定性小，而系统 1，3 具有较高 的安全熵，出现安全性风险响应的不确定性大。值得一提的是，访问控制系统 1 和 11 具有相近的 a3 值（发生安全性风险响应的概率相近），尽管访问控制系统 11 具有更高的可用性响应风险，在系统安全性绝对重要的评价指标下，访问控 制系统 1 和 11 的安全熵接近，出现安全性风险响应的不确定性相同。
根据不同的系统安全性和可用性需求场景，多系统的评价结果可能出现差 异，总体而言，可以理解为系统访问属性对于 y = kx, (k = ω3/ω2) 的投影（当 ω2 = 0时, x = 0），并通过投影变换后的坐标距离进行评价。值得一提的是，当对 访问控制模型进行评价时，访问控制模型应当是稳定的，这不仅仅要求输入的访 问请求是完备的并且是概率分布均匀的，同时要求访问控制模型的结果具有确定 性。
实验结果表明，本文建议的基于安全熵的评价方式能够较为准确的反映不同 模型的安全性和可用性，并可为实际访问控制系统的评估提供参考。

5.4 本章小结
本章针对传统的访问控制模型基于静态的指标，如角色、密级等进行访问权 限的长期静态管理，进而导致安全风险的问题，本工作提出了基于零信任的访问 控制模型。本模型关注工业物联网系统不断变化的网络环境和人为因素，并提出 了一种动态评估用户信任属性指导访问控制的方法。通过使用本工作的基于零信 任的访问控制模型，系统可以实时监测用户信任的变化，并及时调整访问权限。 与传统访问控制模型相比，本工作模型具有更短的信任周期，同时可以更快地响

52

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

应环境和访问主体属性的变化，实现了细粒度的访问控制，确保在复杂的工业物 联网环境中实现更可靠和安全的访问控制。

53

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

第六章 总结和展望
6.1 本文研究工作总结
随着工业物联网的快速发展，工业控制系统面临着越来越严重的安全威胁， 攻击者可以通过攻击工业物联网直接威胁现实世界中的关键基础设施，造成严重 的后果。然而，工业物联网系统由于曾经长期处于协议专用、物理隔离的环境的 历史原因缺乏安全设计，同时原有的边界网络安全模型无法应对日益严重的高级 威胁，迫切需要新安全机制来保护数据和指令的安全。因此，本文引入零信任思 想和基于属性的访问控制相结合的安全机制来保护工业物联网系统的数据和指 令安全。基于属性的访问控制方案可以动态感知未经授权访问主体或处于失常 工作状态的主体，关注工业物联网系统不断变化的网络环境和人为因素，根据访 问主体的信任属性进行访问决策。而零信任思想则强调通过贯彻整个访问控制 过程的评估和验证确保访问主体的身份和安全状态，这两种方法的结合可以提供 多重层次的安全保障，实现细粒度的访问控制，防止了资源的滥用和信息泄露。
本文所提方案主要包括基于机器学习的风险因子识别和基于信任评估的零 信任访问控制模型两个部分。
1. 本文所提基于机器学习的风险因子识别关注访问主体的动态风险。通过 机器学习技术，本文提出了基于风险因子识别和量化的安全机制，从人脸异常表 情识别和网络异常流量检测两方面动态感知访问主体的风险状态，从而更好地保 护工业物联网系统的安全。具体而言，在人脸异常表情识别方面，本文提出了一 种基于小卷积核的 CNN 方法，通过对访问主体的面部表情进行实时监测和分析， 判断其是否存在不适宜访问系统的异常情况。在网络异常流量检测方面，本文通 过对比实验，采用了一种基于随机森林的方法，通过对网络流量进行实时监测和 分析，识别出存在威胁的异常流量和攻击类型。该部分内容为访问主体的信任评 估提供了实时、可靠的风险数据，是访问决策的重要依据。
2. 本文在风险因子识别的基础上，实现了一种基于信任属性的零信任访问控 制模型。该模型通过对访问主体的正向信任属性和风险属性的函数化表达，实现 了对访问主体的直接信任评估，随后根据历史评估数据通过滑动窗口和基于时间 的衰减因子综合计算访问主体信任，通过 XACML 机制实现了动态访问策略的 部署和访问决策过程。最后通过安全熵对访问控制效果进行评价，从而确保访问 控制的效果。可以有效地保护工业物联网系统的数据和指令安全。

54

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

6.2 不足和展望
本文观点提到，访问控制过程应该关注工业物联网系统不断变化的网络环 境和人为因素，此外，零信任理念中也提到信任应基于尽可能多的数据源计算而 来，本文中选择了人脸异常表情识别和网络异常流量检测的任务作为指导信任计 算的风险因素，处于异常情绪和伴随异常流量的的访问主体往往存在风险，具有 一定的合理性。但是人为因素和环境因素远不止文中所研究的两种，因此，应该 引入更多科学的风险指标参与信任的计算，指导进行更为科学的访问控制。

55

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

参考文献
[1] HaddadPajouh H, Dehghantanha A, Parizi R M, et al. A survey on internet of things security: Requirements, challenges, and solutions[J]. Internet of Things, 2021, 14:100129.
[2] 钱志鸿, 王义君. 物联网技术与应用研究 [J]. 电子学报, 2012, 40(5):7. [3] Khan W Z, Rehman M, Zangoti H M, et al. Industrial internet of things: Recent advances,
enabling technologies and open challenges[J]. Computers & Electrical Engineering, 2020, 81:106522. [4] Lin S W, Miller B, Durand J, et al. The industrial internet of things volume g1: reference architecture[J]. Industrial Internet Consortium, 2017, 10. [5] Prinsloo J, Sinha S, von Solms B. A review of industry 4.0 manufacturing process security risks[J]. Applied Sciences, 2019, 9(23):5105. [6] 刘威, 李冬, 孙波. 工业控制系统安全分析 [J]. 信息网络安全, 2012, (8):3. [7] Qassim Q S, Jamil N, Daud M, et al. A review of security assessment methodologies in industrial control systems[J]. Information and Computer Security, 2019, 27(1):47–61. [8] Zahran B, Hussaini A, Ali-Gombe A. Iiot-aras: Iiot/ics automated risk assessment system for prediction and prevention[J]. 2021. [9] Profentzas C, Gunes M, Nikolakopoulos Y, et al. Performance of secure boot in embedded systems[C]. 2019. [10] Zhang L, Qian X, Ruo H U. Study of system boundary security management model based on periphery (jieke) theory[C]. 2004. [11] Farwell J P, Rohozinski R. Stuxnet and the future of cyber war[J]. Survival, 2011, 53(1):23– 40. [12] Kumar R, Kela R, Singh S, et al. Apt attacks on industrial control systems: A tale of three incidents[J]. International Journal of Critical Infrastructure Protection, 2022, 37:100521. [13] Zahra S R, Chishti M A. Ransomware and internet of things: A new security nightmare[C]. 2019. 551–555. [14] 牛建英. 战略矿产资源供应安全研究 [D]. 中国地质大学 (北京), 2007. [15] 沈海波, 洪帆. 访问控制模型研究综述 [J]. 计算机应用研究, 2005, 22(6):9–11. [16] 张刘天. 零信任关键技术研究 [D]. 南京邮电大学, 2022. [17] Parsons K, Calic D, Pattinson M, et al. The human aspects of information security questionnaire (hais-q): Two further validation studies[J]. Computers & Security, 2017, 66. [18] Hadlington L, Popavac M, Janicke H, et al. Exploring the role of work identity and work locus of control in information security awareness[J]. Computers & Security, 2019, (81-):81. [19] He Y, Huang D, Chen L, et al. A survey on zero trust architecture: Challenges and future trends[J]. Wireless Communications and Mobile Computing, 2022, 2022.
56

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

[20] Xuemei L, Yan L, Lixing D. Study on information security of industry management[C]. 2009. 522–524.
[21] Henshel D, Cains M, Hoffman B, et al. Trust as a human factor in holistic cyber security risk assessment[J]. Procedia Manufacturing, 2015, 3:1117–1124.
[22] Kindervag J, et al. Build security into your network’s dna: The zero trust network architecture[J]. Forrester Research Inc, 2010, 27.
[23] CeArley D, Burke B, Searle S, et al. Top 10 strategic technology trends for 2018[J]. The Top, 2016, 10:1–246.
[24] DeCusatis C, Liengtiraphan P, Sager A, et al. Implementing zero trust cloud networks with transport access control and ﬁrst packet authentication[C]. 2016. 5–10.
[25] Dimitrakos T, Dilshener T, Kravtsov A, et al. Trust aware continuous authorization for zero trust in consumer internet of things[C]. 2020. 1801–1812.
[26] Sultana M, Hossain A, Laila F, et al. Towards developing a secure medical image sharing system based on zero trust principles and blockchain technology[J]. BMC Medical Informatics and Decision Making, 2020, 20(1):1–10.
[27] Ramezanpour K, Jagannath J. Intelligent zero trust architecture for 5g/6g networks: Principles, challenges, and the role of machine learning in the context of o-ran[J]. Computer Networks, 2022. 109358.
[28] Xiaopeng T, Haohao S. A zero trust method based on blp and biba model[C]. 2021. 96–100. [29] 荣钰, 催应杰, 任亮, et al. 零信任安全模型在云计算环境中的应用研究 [J]. 第 32 次全国
计算机安全学术交流会论文集, 2017. [30] 靳起朝, 任超. 基于零信任架构的边缘计算接入安全体系研究 [J]. 网络安全技术与应用,
2018, 12. [31] Chakraborty S, Ray I. Trustbac—integrating trust relationships into the rbac model for access
control in open systems[C]. 2006. [32] 刘武, 段海新, 张洪, et al. Trbac: 基于信任的访问控制模型 [J]. 计算机研究与发展, 2011,
48(8):7. [33] 邓三军, 袁凌云, 孙丽梅. 基于信任度的物联网访问控制模型研究 [J]. 计算机工程与设
计, 2022, 43(11):7.
[34] Rose S, Borchert O, Mitchell S, et al. Zero trust architecture[J]. 2020. [35] Gilman E, Barth D. 零信任网络: 在不可信网络中构建安全系统 [J]. 2019. [36] 徐莉, 陈倩. 美国《国防部零信任参考架构》解读 [J]. 信息安全与通信保密, 2022, 20(1):7.
[37] LeCun Y, Boser B, Denker J S, et al. Backpropagation applied to handwritten zip code recognition[J]. Neural computation, 1989, 1(4):541–551.
[38] Latham D C. Department of defense trusted computer system evaluation criteria[J]. Department of Defense, 1986, 198.
[39] 刘波, 陈曙晖, 邓劲生. Bell-lapadula 模型研究综述 [J]. 计算机应用研究, 2013, 30(003):656–660.

57

兰州大学硕士学位论文

基于零信任的工业物联网访问控制技术研究

[40] Pejas´ J. Multilevel lattice-based authorization in distributed supervisory and control systems[C]. 2002. 371–382.
[41] Milutinovic S. The need for the use of xacml access control policy in a distributed ehr and some performance considerations[J]. Medical and Care Compunetics, 2008, 5(137):346.
[42] Zorrilla M, Yebenes J. A reference framework for the implementation of data governance systems for industry 4.0[J]. Computer Standards & Interfaces, 2022, 81:103595.
[43] Lin M, Chen Q, Yan S. Network in network[Z], 2013. [44] 崔子越, 皮家甜, 陈勇, et al. 结合改进 vggnet 和 focal loss 的人脸表情识别 [J]. 计算机工
程与应用, 2021, 57(19):171–178. [45] 石翠萍, 谭聪, 左江, et al. 基于改进 alexnet 卷积神经网络的人脸表情识别 [J]. 电讯技术,
2020, (009):060.
[46] Reis B, Maia E, Praa I. Selection and performance analysis of cicids2017 features importance[M]. Foundations and Practice of Security, 2020.
[47] 石志国, 贺也平, 张宏. 一种对等计算安全性的时间自衰减信任管理算法 [J]. 计算机研 究与发展, 2007, 44(1):1–10.
[48] 车天伟, 马建峰, 王超, et al. 基于安全熵的多级访问控制模型量化分析方法 [J]. 华东师 范大学学报：自然科学版, 2015, (1):7.

58

